(function(_0x175149,_0x1f23ca){const _0xe8ef3e={_0x24a677:0x2cf,_0x1f586a:0x2d0,_0x35bc2f:0x2ce,_0x50eeb5:0x1a9,_0x3d70e8:0x1b6,_0xb9c248:0x1a5,_0x12259b:0x1ab,_0x5912c8:0x1aa,_0x5d1b8e:0x1b5,_0x2aa270:0x2d8,_0x1da777:0x2e0,_0x16dd78:0x2d6,_0x52d628:0x2d9,_0x1b4de8:0x1ad,_0x1ed950:0x1b2,_0x4584fe:0x1b3,_0x38c16b:0x2e1,_0x3f2620:0x2e3,_0x4bd30c:0x2dd,_0x413f75:0x1a4,_0x3faa69:0x1af,_0x2a0993:0x19b,_0x3a81d2:0x1b3,_0x3f766e:0x1bc,_0x306f14:0x1a1,_0x1b49bd:0x19c,_0x5d9b5f:0x19d,_0x5a1724:0x1ac,_0x582295:0x1a8,_0x1133c8:0x1b4,_0x2e0552:0x1ae,_0x17a421:0x2d5},_0x5c1d89={_0x2910f1:0x6},_0x1478f6=_0x175149();function _0x5a7690(_0x524221,_0x501f9b,_0x4e2063,_0x3cf1b1){return _0x483a(_0x501f9b-0x12b,_0x4e2063);}function _0x10ad6a(_0x1aff5c,_0x530992,_0x55d089,_0x323662){return _0x483a(_0x1aff5c- -_0x5c1d89._0x2910f1,_0x55d089);}while(!![]){try{const _0x480ca4=parseInt(_0x5a7690(_0xe8ef3e._0x24a677,0x2d8,_0xe8ef3e._0x1f586a,_0xe8ef3e._0x35bc2f))/(0x1b*-0x91+-0x115*0xb+0x1b33)*(-parseInt(_0x10ad6a(0x1ae,_0xe8ef3e._0x50eeb5,_0xe8ef3e._0x3d70e8,_0xe8ef3e._0xb9c248))/(0x407+-0x3ad*-0x1+0xa*-0xc5))+-parseInt(_0x10ad6a(_0xe8ef3e._0x12259b,_0xe8ef3e._0x5912c8,0x1a6,_0xe8ef3e._0x5d1b8e))/(0x1*-0x1889+-0x22*-0x106+-0x2*0x520)*(parseInt(_0x5a7690(_0xe8ef3e._0x2aa270,_0xe8ef3e._0x1da777,_0xe8ef3e._0x16dd78,_0xe8ef3e._0x52d628))/(0x45*-0x5+-0x7ee+-0x3d*-0x27))+parseInt(_0x10ad6a(0x1b9,_0xe8ef3e._0x1b4de8,_0xe8ef3e._0x1ed950,_0xe8ef3e._0x4584fe))/(0x9*-0x28f+-0x13*-0x23+-0x6d1*-0x3)*(-parseInt(_0x5a7690(_0xe8ef3e._0x38c16b,_0xe8ef3e._0x3f2620,_0xe8ef3e._0x4bd30c,_0xe8ef3e._0x2aa270))/(0x16bd*-0x1+0x146b*0x1+0x18*0x19))+-parseInt(_0x10ad6a(_0xe8ef3e._0x413f75,0x1a6,_0xe8ef3e._0x3faa69,_0xe8ef3e._0x2a0993))/(-0x177f+-0x24*0x4d+0x225a*0x1)*(parseInt(_0x10ad6a(_0xe8ef3e._0x3a81d2,_0xe8ef3e._0x4584fe,_0xe8ef3e._0x3f766e,0x1aa))/(0x1*-0x5de+-0x14df+0x1ac5))+-parseInt(_0x10ad6a(_0xe8ef3e._0x306f14,_0xe8ef3e._0x1b49bd,_0xe8ef3e._0x5d9b5f,_0xe8ef3e._0x5a1724))/(-0x2*0x196+0x37*0x16+-0x185)*(parseInt(_0x10ad6a(0x1b1,0x1a6,0x1ab,_0xe8ef3e._0x582295))/(-0x11b1+0x83d+-0xf3*-0xa))+parseInt(_0x10ad6a(0x1a8,_0xe8ef3e._0x1133c8,0x1a9,_0xe8ef3e._0x2e0552))/(-0x146*-0xc+-0x12e6+0x3a9)+parseInt(_0x5a7690(_0xe8ef3e._0x17a421,0x2d7,0x2d8,_0xe8ef3e._0x4bd30c))/(0x1d29*0x1+0x244e+-0x416b);if(_0x480ca4===_0x1f23ca)break;else _0x1478f6['push'](_0x1478f6['shift']());}catch(_0x3feda8){_0x1478f6['push'](_0x1478f6['shift']());}}}(_0x4411,0x1d5f0+0x1*-0x90c76+0xcd958));const _0x5c6288=(function(){const _0x27a074={_0x35e6ca:0x542,_0x557a6e:0x54e,_0x561673:0x547,_0x5c8d49:0x54c,_0x514fc2:0x546,_0x38624e:0x547,_0x5ed018:0x551,_0x4b60ff:0x10,_0x44c9a0:0xf,_0x3c2536:0xa,_0x13c2ce:0x7},_0x2b8cf6={_0x235440:0x1b3},_0x4379ff={};_0x4379ff['AZeiK']='MycMD';const _0x5d4524=_0x4379ff;let _0x12f9b6=!![];return function(_0x25d3c5,_0x33bfde){const _0x40f5f7={_0x827dc:0xe7,_0x58dc0d:0xef,_0x17f5ee:0xe5,_0x18ef5a:0x1cc,_0x2c8cce:0x1c0},_0x35c775={_0x35bf7d:0xec,_0x294bed:0x159,_0x5268bf:0xe6},_0x4ddadb={_0x19f6dd:0x395},_0x424d06={};_0x424d06[_0x528732(_0x27a074._0x35e6ca,_0x27a074._0x557a6e,_0x27a074._0x561673,_0x27a074._0x5c8d49)]=function(_0x141403,_0x5fe0f1){return _0x141403!==_0x5fe0f1;},_0x424d06[_0x528732(_0x27a074._0x514fc2,_0x27a074._0x38624e,_0x27a074._0x5ed018,0x558)]=_0x5d4524[_0xed1756(_0x27a074._0x4b60ff,_0x27a074._0x44c9a0,_0x27a074._0x3c2536,_0x27a074._0x13c2ce)];function _0x528732(_0xccd37d,_0x4f5983,_0x1cffb3,_0x3a1330){return _0x483a(_0x1cffb3-_0x4ddadb._0x19f6dd,_0x4f5983);}const _0x27a020=_0x424d06;function _0xed1756(_0x855a33,_0x459c38,_0x26fcee,_0x4892e4){return _0x483a(_0x4892e4- -_0x2b8cf6._0x235440,_0x459c38);}const _0x131a28=_0x12f9b6?function(){const _0x1d3fef={_0x3fc6d0:0x58,_0x476550:0x38c,_0x279382:0x47};function _0x700137(_0x3e3721,_0x554212,_0x31fe42,_0x15bcc9){return _0xed1756(_0x3e3721-_0x35c775._0x35bf7d,_0x31fe42,_0x31fe42-_0x35c775._0x294bed,_0x3e3721- -_0x35c775._0x5268bf);}function _0x25ad18(_0x335ae2,_0x2be8c4,_0x79566b,_0xed9244){return _0x528732(_0x335ae2-_0x1d3fef._0x3fc6d0,_0xed9244,_0x79566b- -_0x1d3fef._0x476550,_0xed9244-_0x1d3fef._0x279382);}if(_0x33bfde){if(_0x27a020[_0x700137(-_0x40f5f7._0x827dc,-0xdb,-_0x40f5f7._0x58dc0d,-_0x40f5f7._0x17f5ee)](_0x27a020[_0x25ad18(_0x40f5f7._0x18ef5a,_0x40f5f7._0x2c8cce,0x1c5,_0x40f5f7._0x18ef5a)],_0x27a020['bBQnY'])){let codeActionTypes=[_0x56ee74.EAuthSessionGuardType.EmailCode,_0xd16022.EAuthSessionGuardType.DeviceCode];let codeAction=_0x519949.validActions.find(action=>codeActionTypes.includes(action.type));}else{const _0x56032a=_0x33bfde['apply'](_0x25d3c5,arguments);return _0x33bfde=null,_0x56032a;}}}:function(){};return _0x12f9b6=![],_0x131a28;};}()),_0x5bba9f=_0x5c6288(this,function(){const _0x16c5e2={_0x329688:0xb2,_0x26fd32:0xa0,_0x75c3e0:0xb3,_0x305e89:0x511,_0x34ce94:0x518,_0x51ee0b:0x50f,_0x35b82d:0x516,_0x49186b:0x51a,_0x799864:0x51b,_0x7bec81:0x51e,_0x1ae732:0xac,_0x869cd4:0x503,_0x472040:0xc7,_0x4220d3:0xb3,_0x26725b:0xbf,_0x1d770a:0x525,_0x2f4873:0x51a},_0xff7d6e={_0x3cba72:0x35d},_0x28e286={_0x3f6329:0x26a},_0x3c94f5={};function _0x47bff8(_0x463ecc,_0x16556d,_0x325b79,_0x3ed2af){return _0x483a(_0x3ed2af- -_0x28e286._0x3f6329,_0x463ecc);}function _0x4f6ad9(_0x32b4f0,_0x44dcd7,_0x403c04,_0x1e4af0){return _0x483a(_0x1e4af0-_0xff7d6e._0x3cba72,_0x44dcd7);}_0x3c94f5[_0x47bff8(-_0x16c5e2._0x329688,-_0x16c5e2._0x26fd32,-_0x16c5e2._0x75c3e0,-0xad)]=_0x4f6ad9(_0x16c5e2._0x305e89,_0x16c5e2._0x34ce94,_0x16c5e2._0x51ee0b,_0x16c5e2._0x34ce94)+'+$';const _0x5b0a71=_0x3c94f5;return _0x5bba9f[_0x4f6ad9(_0x16c5e2._0x35b82d,0x520,_0x16c5e2._0x49186b,_0x16c5e2._0x799864)]()['search'](_0x4f6ad9(0x523,_0x16c5e2._0x7bec81,0x51a,_0x16c5e2._0x34ce94)+'+$')[_0x47bff8(-0xa9,-0xb2,-0xaf,-_0x16c5e2._0x1ae732)]()[_0x4f6ad9(_0x16c5e2._0x869cd4,0x517,0x510,0x50c)+'r'](_0x5bba9f)[_0x47bff8(-_0x16c5e2._0x472040,-_0x16c5e2._0x4220d3,-0xbc,-_0x16c5e2._0x26725b)](_0x5b0a71[_0x4f6ad9(_0x16c5e2._0x1d770a,_0x16c5e2._0x51ee0b,_0x16c5e2._0x35b82d,_0x16c5e2._0x2f4873)]);});_0x5bba9f();const SteamCommunity=require(_0x5e8531(-0x1c6,-0x1be,-0x1c2,-0x1c4)+_0x5e8531(-0x1c9,-0x1bf,-0x1be,-0x1bc));function _0x5e8531(_0x5db411,_0x552967,_0x5c227e,_0x71d7d5){const _0x152983={_0x46121a:0x367};return _0x483a(_0x552967- -_0x152983._0x46121a,_0x5db411);}const SteamTotp=require('steam-totp'),moment=require(_0x5e8531(-0x1aa,-0x1b7,-0x1c4,-0x1ae)),SteamUser=require(_0x5e2516(0x2a3,0x2b0,0x2a9,0x2aa)),SteamStore=require(_0x5e8531(-0x1b6,-0x1b4,-0x1bf,-0x1a9));const xbsteam=require('./steam');const fs=require('fs');function _0x4411(){const _0x372aee=['BML0Eq','C3rLyw1JB21TDq','ntuZBeTOBwv0','C2vHCMnO','mZu4ntmYodHvuMjXELy','m3HiveTvBq','mZu0mJmZufbYEurx','y29UC3rYDwn0BW','Bw9Tzw50','mJa0mJa3oxjqrKrRzG','AhDhz0e','C3rLyw1ZDg9Yzq','nduXmZC4BuD0EhD5','nevMAgDezq','C3rLyw0TDxnLCG','mtbiqKrbve4','odm0EgjwAMDg','ntm1ntjwBwrZCMC','qvPLAuS','kcGOlISPkYKRkq','yKjrBLK','uMjQzu0','Dg9tDhjPBMC','nZm5mgD5DgHZra','ntaYnZi4m25iCMfTEa'];_0x4411=function(){return _0x372aee;};return _0x4411();}const xbot=require('./xbot');const SteamSession=require('steam-session');global.sc=new SteamCommunity();global.user=undefined;global.xbsteam=new xbsteam();global.SteamTotp=SteamTotp;function _0x5e2516(_0x27ecd8,_0x8fce57,_0x2e9bd7,_0x22562c){const _0x1f292e={_0x4c3cc7:0xfa};return _0x483a(_0x8fce57-_0x1f292e._0x4c3cc7,_0x27ecd8);}global.sc.wait=async function(timeout=2500){return await new Promise(async(resolve,reject)=>{await new Promise(resolve=>setTimeout(resolve,timeout));resolve();});};global.simpleObjectToMultipartForm=function(obj){let multipartForm={};for(let i in obj){multipartForm[i]={content:obj[i]};}return multipartForm;};console.clear();global.session=new SteamSession.LoginSession(SteamSession.EAuthTokenPlatformType.SteamClient);if(process.env.XBOT_USERNAME===undefined){console.log('Не установлен параметр XBOT_USERNAME');return;}if(process.env.XBOT_PASSWORD===undefined){console.log('Не установлен параметр XBOT_PASSWORD');return;}if(process.env.XBOT_SHARED_SECRET===undefined){console.log('Не установлен параметр XBOT_SHARED_SECRET');return;}if(process.env.XBOT_IDENTITY_SECRET===undefined){console.log('Не установлен параметр XBOT_IDENTITY_SECRET');return;}if(process.env.XBOT_API_KEY===undefined){console.log('Не установлен параметр XBOT_API_KEY');return;}global.data={username:process.env.XBOT_USERNAME,password:process.env.XBOT_PASSWORD,sharedSecret:process.env.XBOT_SHARED_SECRET,identitySecret:process.env.XBOT_IDENTITY_SECRET,apiKey:process.env.XBOT_API_KEY,tickDelay:process.env.XBOT_TICK_DELAY??1000,ticks:{sendInventory:process.env.XBOT_TICKS_SEND_INVENTORY??60,sendOrders:process.env.XBOT_TICKS_SEND_ORDERS??60,ping:process.env.XBOT_TICKS_PING??30,checkConfirmations:process.env.XBOT_TICKS_SEND_CONFIRMATION??30},useragent:process.env.XBOT_USERAGENT??'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36',version:'2',startTime:moment.now()};if(process.env.XBOT_URL){process.env['NODE_TLS_REJECT_UNAUTHORIZED']=0;global.xbot_apiurl=process.env.XBOT_URL;}else{global.xbot_apiurl='https://xbot.gg/api/v1/smb/worker/';}global.sc.userAgent=data.userAgent;var loading_lastInc=0;var loading=function(){var h=['|','/','-','\\'];loading_lastInc=loading_lastInc>3?0:loading_lastInc;return h[loading_lastInc++];};global.header=function(tick){console.clear();console.log('['+loading()+'] Account: '+data.username+' | Auth code: '+getSteamGuardCode()+' | Uptime: '+moment.duration(moment.now()-data.startTime).humanize()+' | ver. '+global.data.version);};function _0x483a(_0x2217f4,_0x19b620){const _0x51316b=_0x4411();return _0x483a=function(_0x1b4089,_0x109b76){_0x1b4089=_0x1b4089-(0x22cd*-0x1+0x25*0xf1+-0x53*-0x5);let _0x24bb90=_0x51316b[_0x1b4089];if(_0x483a['WnZLNC']===undefined){var _0x1694f6=function(_0x46695f){const _0x100379='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x1f597d='',_0x42164b='',_0x390f05=_0x1f597d+_0x1694f6;for(let _0x13e714=-0x1889+-0x92*-0x1+-0xf*-0x199,_0x4e285a,_0x5ac8c3,_0x3ff78d=0xd62*-0x2+0x1901+0x1c3;_0x5ac8c3=_0x46695f['charAt'](_0x3ff78d++);~_0x5ac8c3&&(_0x4e285a=_0x13e714%(0x2e*0x3f+0x1*-0x9ec+-0x162)?_0x4e285a*(0x223f+-0x180e+0x9f1*-0x1)+_0x5ac8c3:_0x5ac8c3,_0x13e714++%(0x170d+0x2425+-0x3b2e))?_0x1f597d+=_0x390f05['charCodeAt'](_0x3ff78d+(-0x1d8+-0x1547+0x1729))-(0x1944+0xd0d+0x2647*-0x1)!==0x5*-0x543+0xb07+0xf48?String['fromCharCode'](-0x13*-0xa9+0x27+-0xbb3&_0x4e285a>>(-(0x2537+0x2028+-0x455d)*_0x13e714&-0x1bf5+0x2*0x5ad+-0x63*-0x2b)):_0x13e714:0x15*-0x43+-0x866+0x1*0xde5){_0x5ac8c3=_0x100379['indexOf'](_0x5ac8c3);}for(let _0x2d13d2=-0x2542+-0x20ab+0x45ed,_0x555cbf=_0x1f597d['length'];_0x2d13d2<_0x555cbf;_0x2d13d2++){_0x42164b+='%'+('00'+_0x1f597d['charCodeAt'](_0x2d13d2)['toString'](0x7*-0x44f+0x1de3+0x56))['slice'](-(-0x2081+0x27*-0x65+0x2fe6));}return decodeURIComponent(_0x42164b);};_0x483a['wKYVXV']=_0x1694f6,_0x2217f4=arguments,_0x483a['WnZLNC']=!![];}const _0x20552f=_0x51316b[0xf2d+-0x71f*0x2+-0x1*0xef],_0x18f228=_0x1b4089+_0x20552f,_0x536363=_0x2217f4[_0x18f228];if(!_0x536363){const _0xb324=function(_0x28a262){this['jhTiXL']=_0x28a262,this['rjZWCc']=[0x11*-0x133+-0x16c9*-0x1+-0x1*0x265,0x1*-0x2681+-0xe47+0x34c8,-0x1*-0xe2e+0x253e+-0x336c],this['WfppFr']=function(){return'newState';},this['PKWWMz']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['hnfttX']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0xb324['prototype']['FOHOHR']=function(){const _0x43aa75=new RegExp(this['PKWWMz']+this['hnfttX']),_0x3dce82=_0x43aa75['test'](this['WfppFr']['toString']())?--this['rjZWCc'][-0x1b8e+0x14ea+0xbd*0x9]:--this['rjZWCc'][0x4*-0x75+-0x23f3+0x1fd*0x13];return this['PbKabm'](_0x3dce82);},_0xb324['prototype']['PbKabm']=function(_0x593c8e){if(!Boolean(~_0x593c8e))return _0x593c8e;return this['HmiBwX'](this['jhTiXL']);},_0xb324['prototype']['HmiBwX']=function(_0x2b4ce9){for(let _0x349f26=0x1983+-0xb*-0x29+-0x1*0x1b46,_0x4d6c1f=this['rjZWCc']['length'];_0x349f26<_0x4d6c1f;_0x349f26++){this['rjZWCc']['push'](Math['round'](Math['random']())),_0x4d6c1f=this['rjZWCc']['length'];}return _0x2b4ce9(this['rjZWCc'][0x22b0+-0x77f+-0x1b31]);},new _0xb324(_0x483a)['FOHOHR'](),_0x24bb90=_0x483a['wKYVXV'](_0x24bb90),_0x2217f4[_0x18f228]=_0x24bb90;}else _0x24bb90=_0x536363;return _0x24bb90;},_0x483a(_0x2217f4,_0x19b620);}const debug=true;const getSteamGuardCode=function(){return SteamTotp.getAuthCode(data.sharedSecret);};const cookiesFile=global.data.username+'.auth.json';cookies=[];try{let data=fs.readFileSync(cookiesFile,'utf-8');let json=JSON.parse(data);cookies=json;}catch(err){console.error('Ошибка чтения или парсинга файла:',err);}global.sc.wait();global.sc.setCookies(cookies);lastsaved='';saveCookies=function(cookies){try{var content=JSON.stringify(cookies);fs.writeFileSync(cookiesFile,content);lastsaved=cookies;}catch(err){console.error(err);}};global.log=function log(data){if(debug)console.log(data);};gCookies=null;const login=function(){return new Promise(async(resolve,reject)=>{global.session.on('authenticated',async()=>{console.log('Успешно авторизован в Steam');let cookies=await session.getWebCookies();saveCookies(cookies);global.sc.setCookies(cookies);saveCookies(cookies);loggedIn=true;if(global.xbot===undefined){global.xbot=new xbot();}resolve(session);});global.session.on('timeout',()=>{console.log('This login attempt has timed out.');reject(false);});global.session.on('error',err=>{console.log(`ERROR: This login attempt has failed! ${err.message}`);reject(err);});try{let username=global.data.username;let password=global.data.password;let startResult=await global.session.startWithCredentials({accountName:username,password:password,steamGuardCode:SteamTotp.getAuthCode(data.sharedSecret),agent:global.data.userAgent});if(startResult.actionRequired){let codeActionTypes=[SteamSession.EAuthSessionGuardType.EmailCode,SteamSession.EAuthSessionGuardType.DeviceCode];let codeAction=startResult.validActions.find(action=>codeActionTypes.includes(action.type));}}catch(ex){reject(ex);}});};global.xbot=new xbot();async function init(){let tickCounter=0;let loggedIn=await global.xbsteam.amILoggedIn();let toWait=1;while(true){if(global.pause429===true){global.xbot.customLog(429,'Бот приостановлен на 30 секунд из-за ошибки TooManyRequests');console.log('Бот приостановлен на 30 секунд из-за ошибки TooManyRequests');await new Promise(resolve=>setTimeout(resolve,1000*30*1));global.pause429=false;}try{global.header(tickCounter);if(tickCounter%300===0&&loggedIn===true){loggedIn=await global.xbsteam.amILoggedIn();console.log('Проверка авторизации Steam: '+(loggedIn?'авторизован':'не авторизован'));}if(!loggedIn){console.log('Попытка авторизации');global.sc.wait();global.sc.wait();toWait=0;await login().then(function(data){loggedIn=true;}).catch(function(err){toWait=1000*60*10;;console.log(err.eresult);if(err.eresult==84){console.log('Лимит попыток авторизации исчерпан, авторизация отлкадывается на 10 минут');toWait=1000*60*10;return;}console.log(err.eresult);loggedIn=false;});await new Promise(resolve=>setTimeout(resolve,toWait));}else{await global.xbot.loop(tickCounter);}}catch(ex){console.log(ex);}tickCounter++;}}init();