function _0x40b3(_0x3b2199,_0x222607){const _0x5a29e6=_0x2e95();return _0x40b3=function(_0x30ac49,_0x7536f9){_0x30ac49=_0x30ac49-(-0x2314+-0x114+0x24b8);let _0x56642f=_0x5a29e6[_0x30ac49];if(_0x40b3['nOikZF']===undefined){var _0x4b33a2=function(_0x13f6e5){const _0x287cc0='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x2bca9d='',_0x1908d0='',_0x36aa59=_0x2bca9d+_0x4b33a2;for(let _0x1c4d7a=-0xe8+-0x1be*-0x8+0x342*-0x4,_0x4cd605,_0x2875b7,_0xef205e=0x1*0x1417+-0x2*0xed8+-0x999*-0x1;_0x2875b7=_0x13f6e5['charAt'](_0xef205e++);~_0x2875b7&&(_0x4cd605=_0x1c4d7a%(-0x1db8+-0x7*-0x105+0x1699)?_0x4cd605*(0x25*-0x68+0x60f*0x4+-0x1*0x8f4)+_0x2875b7:_0x2875b7,_0x1c4d7a++%(-0x5e*-0x1d+-0x1bf7+0x105*0x11))?_0x2bca9d+=_0x36aa59['charCodeAt'](_0xef205e+(0x9f*0x9+-0x1*0x969+0x34*0x13))-(-0x20df+-0x24a7+0x4590)!==-0x76a+-0x1*-0x24f5+-0x1d8b?String['fromCharCode'](0x6*0x275+-0x1237+0x478&_0x4cd605>>(-(0x20fd+0x237a+-0x4475*0x1)*_0x1c4d7a&-0x21c1+0xf2f+0x1298)):_0x1c4d7a:0x3f*0x99+0x6c7*-0x1+-0x3dc*0x8){_0x2875b7=_0x287cc0['indexOf'](_0x2875b7);}for(let _0x21bae3=0x1*0x827+-0x17a0+0xf79,_0x256fb9=_0x2bca9d['length'];_0x21bae3<_0x256fb9;_0x21bae3++){_0x1908d0+='%'+('00'+_0x2bca9d['charCodeAt'](_0x21bae3)['toString'](0x1d1c+0x8dd*-0x1+-0x142f))['slice'](-(-0x3d*-0x7+-0x179d+0xa*0x232));}return decodeURIComponent(_0x1908d0);};_0x40b3['BSasOF']=_0x4b33a2,_0x3b2199=arguments,_0x40b3['nOikZF']=!![];}const _0x429412=_0x5a29e6[-0x22*0xf9+0xcc+0x2046],_0x4f8d18=_0x30ac49+_0x429412,_0x309373=_0x3b2199[_0x4f8d18];if(!_0x309373){const _0x2c3bbd=function(_0x35f433){this['WXllcL']=_0x35f433,this['aCtKnU']=[-0x4b1*0x5+0x27c*-0xe+-0x1*-0x3a3e,-0x1017+-0x226c+0xc1*0x43,0x1*0x5ac+0x580+-0x16*0x82],this['UkNGzG']=function(){return'newState';},this['qzkTLj']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['DUsJtE']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x2c3bbd['prototype']['yIQqqM']=function(){const _0x13ec81=new RegExp(this['qzkTLj']+this['DUsJtE']),_0x58654f=_0x13ec81['test'](this['UkNGzG']['toString']())?--this['aCtKnU'][-0x3*0x4dd+0x61*-0x3+-0x1*-0xfbb]:--this['aCtKnU'][0x1*-0x262f+-0x44*0x1d+-0x11*-0x2b3];return this['IfLnSE'](_0x58654f);},_0x2c3bbd['prototype']['IfLnSE']=function(_0xcd3c51){if(!Boolean(~_0xcd3c51))return _0xcd3c51;return this['HxUver'](this['WXllcL']);},_0x2c3bbd['prototype']['HxUver']=function(_0x377809){for(let _0x420124=-0x1*0x437+0xa81*0x2+0x3*-0x599,_0x2266ee=this['aCtKnU']['length'];_0x420124<_0x2266ee;_0x420124++){this['aCtKnU']['push'](Math['round'](Math['random']())),_0x2266ee=this['aCtKnU']['length'];}return _0x377809(this['aCtKnU'][-0x1dd6+-0x964*-0x3+0x1aa]);},new _0x2c3bbd(_0x40b3)['yIQqqM'](),_0x56642f=_0x40b3['BSasOF'](_0x56642f),_0x3b2199[_0x4f8d18]=_0x56642f;}else _0x56642f=_0x309373;return _0x56642f;},_0x40b3(_0x3b2199,_0x222607);}(function(_0x2d345e,_0x5215ad){const _0x19e994={_0x2f1c43:0x3e,_0x1d5a1d:0x39,_0x17ebaf:0x33,_0x297153:0x3b,_0x1932b4:0x1e,_0x303d3a:0x2d,_0x1b3e74:0x22,_0x378f47:0x30,_0x3869ad:0x3a,_0x38a915:0x34,_0x418fbc:0x32,_0x435fb1:0x24,_0x164c81:0x2f,_0x455e28:0x354,_0x411df1:0x35e,_0x5cdca3:0x352,_0x5e5790:0x359,_0x1d22c6:0x34b,_0x5401df:0x343,_0x2f4286:0x344,_0x99585e:0x37,_0x51fa84:0x44,_0x25f7ea:0x36,_0xf21ac4:0x358,_0x1631f7:0x34f,_0x40f34f:0x343,_0x51303e:0x2e,_0x25bb02:0x49,_0xa30d35:0x36,_0x58a590:0x45,_0x560974:0x4d,_0x46686d:0x3e,_0x266b06:0x3a,_0x285550:0x47},_0x4ba111={_0xfaf5b6:0x3e7},_0x2373e4={_0x1ef727:0xd6};function _0x5d88af(_0x5f1a44,_0x4c8d75,_0x510a7f,_0xcc609c){return _0x40b3(_0x510a7f- -_0x2373e4._0x1ef727,_0x4c8d75);}const _0x53a693=_0x2d345e();function _0x47b745(_0xb7f986,_0x4eb770,_0xa9d627,_0x27560e){return _0x40b3(_0xa9d627- -_0x4ba111._0xfaf5b6,_0x27560e);}while(!![]){try{const _0x4463aa=parseInt(_0x5d88af(-_0x19e994._0x2f1c43,-0x39,-_0x19e994._0x1d5a1d,-_0x19e994._0x17ebaf))/(0x1*-0xe4e+-0x1856+-0x2f9*-0xd)*(parseInt(_0x5d88af(-_0x19e994._0x297153,-_0x19e994._0x1932b4,-_0x19e994._0x303d3a,-0x2d))/(-0x1dad+0x938+0x1477))+parseInt(_0x5d88af(-_0x19e994._0x1b3e74,-0x2c,-0x31,-_0x19e994._0x378f47))/(0x1*-0xd08+0xa78*0x2+-0x7e5)+-parseInt(_0x5d88af(-_0x19e994._0x3869ad,-0x2e,-_0x19e994._0x38a915,-0x28))/(0x16d5*-0x1+-0x19e6+0x30bf)*(parseInt(_0x5d88af(-_0x19e994._0x418fbc,-_0x19e994._0x435fb1,-0x32,-_0x19e994._0x164c81))/(0xaf4+0x21ce+-0x2cbd))+parseInt(_0x47b745(-_0x19e994._0x455e28,-_0x19e994._0x411df1,-_0x19e994._0x5cdca3,-_0x19e994._0x5e5790))/(0x26f7+-0x1*0xcff+-0x19f2)*(parseInt(_0x47b745(-_0x19e994._0x1d22c6,-_0x19e994._0x5401df,-_0x19e994._0x2f4286,-_0x19e994._0x5cdca3))/(-0x2*-0x277+-0xd*-0x2f5+0x92*-0x4c))+-parseInt(_0x5d88af(-0x50,-_0x19e994._0x99585e,-_0x19e994._0x51fa84,-_0x19e994._0x25f7ea))/(-0x199+-0xead+-0x1*-0x104e)*(-parseInt(_0x47b745(-0x34b,-_0x19e994._0xf21ac4,-_0x19e994._0x1631f7,-_0x19e994._0x40f34f))/(-0x2ab*0x2+0x64d+-0xee))+-parseInt(_0x5d88af(-_0x19e994._0x51303e,-_0x19e994._0x3869ad,-0x3a,-_0x19e994._0x25bb02))/(-0xb83*-0x1+-0x1c42+0x10c9)*(-parseInt(_0x5d88af(-0x4c,-_0x19e994._0xa30d35,-_0x19e994._0x58a590,-_0x19e994._0x560974))/(0x1f*-0xc9+0x1575+-0x1*-0x2ed))+-parseInt(_0x5d88af(-_0x19e994._0x46686d,-_0x19e994._0x266b06,-0x3f,-_0x19e994._0x285550))/(0xd47+-0x3*0x8f9+-0x248*-0x6);if(_0x4463aa===_0x5215ad)break;else _0x53a693['push'](_0x53a693['shift']());}catch(_0x5b454b){_0x53a693['push'](_0x53a693['shift']());}}}(_0x2e95,0x18594b*0x1+0xe4600+-0x603*0x429));const _0x227ca5=(function(){const _0x4d9fc3={_0x4f9281:0x268,_0x43b1b9:0x24f,_0x1b6405:0x259,_0x45780f:0x268,_0xe8a8ff:0x274,_0x5b6882:0x281},_0xa21676={_0x5724c8:0x296,_0x5c0d9a:0x282,_0x2728dc:0x288,_0xc48847:0x293,_0xaa2101:0x274,_0x54e1bc:0x26a,_0x5d2467:0x276,_0x1f3dc5:0x271,_0x15abd5:0x270,_0x1c98d4:0x213,_0x53b0cb:0x218,_0x4b7b46:0x217,_0x1e4027:0x299,_0x31bb4e:0x284,_0x3e3644:0x298},_0x35cf46={_0x4083dc:0x234,_0x5b1cae:0x229,_0x1b1ab3:0x238,_0x47ffd8:0x231,_0x1f3573:0x23a,_0x125531:0x236,_0x2c3761:0x278,_0x21a3ab:0x283,_0x73d4ba:0x284,_0x301e53:0x280,_0x2bfab4:0x28b,_0x5d8e18:0x292,_0x450ed6:0x29b,_0x530c4c:0x299,_0x4b3424:0x280},_0x4c88d8={_0x324bf7:0x199,_0x3ab3d3:0x9b},_0x47bcac={_0x44ecfe:0x273},_0x56c06a={_0x535bae:0x304},_0x3933e7={};function _0x36f0c7(_0x1f9290,_0x297b77,_0x26aaca,_0x4698bf){return _0x40b3(_0x26aaca- -_0x56c06a._0x535bae,_0x297b77);}_0x3933e7[_0x36f0c7(-_0x4d9fc3._0x4f9281,-_0x4d9fc3._0x43b1b9,-_0x4d9fc3._0x1b6405,-_0x4d9fc3._0x45780f)]='nHJBh',_0x3933e7[_0x36f0c7(-0x271,-0x27e,-_0x4d9fc3._0xe8a8ff,-_0x4d9fc3._0x5b6882)]='WKcRH';const _0x5ef7db=_0x3933e7;function _0x3583a4(_0x193d27,_0x16511f,_0x48a405,_0x388704){return _0x40b3(_0x48a405-_0x47bcac._0x44ecfe,_0x388704);}let _0x4b3d2b=!![];return function(_0x4f5fb3,_0x302820){const _0x1e9797={_0x7d1a49:0x7d,_0x1d48fa:0x73,_0x6259bf:0x58f},_0x5af4c6={};_0x5af4c6[_0x405065(-_0xa21676._0x5724c8,-_0xa21676._0x5c0d9a,-_0xa21676._0x2728dc,-_0xa21676._0xc48847)]=function(_0x2fdaf0,_0xccfec7){return _0x2fdaf0!==_0xccfec7;},_0x5af4c6[_0x405065(-_0xa21676._0xaa2101,-_0xa21676._0x54e1bc,-_0xa21676._0x5d2467,-_0xa21676._0xaa2101)]=_0x5ef7db[_0x405065(-0x27c,-0x27c,-_0xa21676._0x1f3dc5,-_0xa21676._0x15abd5)],_0x5af4c6[_0x19b5b2(-_0xa21676._0x1c98d4,-0x207,-_0xa21676._0x53b0cb,-_0xa21676._0x4b7b46)]=_0x5ef7db[_0x405065(-_0xa21676._0x1e4027,-_0xa21676._0x31bb4e,-0x28c,-_0xa21676._0x3e3644)];const _0x581b61=_0x5af4c6;function _0x19b5b2(_0x5f4702,_0x60adbe,_0x1b3e72,_0x58e38a){return _0x36f0c7(_0x5f4702-_0x4c88d8._0x324bf7,_0x60adbe,_0x5f4702-0x47,_0x58e38a-_0x4c88d8._0x3ab3d3);}function _0x405065(_0x4612aa,_0x1ccf61,_0x10ed1e,_0x522854){return _0x3583a4(_0x4612aa-_0x1e9797._0x7d1a49,_0x1ccf61-_0x1e9797._0x1d48fa,_0x10ed1e- -_0x1e9797._0x6259bf,_0x1ccf61);}const _0x2820e2=_0x4b3d2b?function(){const _0x5af69b={_0x54271c:0x44f,_0x4ca2a2:0x83,_0x537436:0xd5},_0x357fe2={_0x19b115:0x2e,_0x19ee2e:0x504,_0x428ee6:0x1bc};function _0x2722d5(_0x170c10,_0x2e926a,_0x499734,_0x5adb63){return _0x405065(_0x170c10-_0x357fe2._0x19b115,_0x5adb63,_0x2e926a-_0x357fe2._0x19ee2e,_0x5adb63-_0x357fe2._0x428ee6);}function _0x3ee7dc(_0x5579b9,_0x57ce72,_0x4e482b,_0x412ef1){return _0x19b5b2(_0x57ce72-_0x5af69b._0x54271c,_0x412ef1,_0x4e482b-_0x5af69b._0x4ca2a2,_0x412ef1-_0x5af69b._0x537436);}if(_0x581b61[_0x3ee7dc(0x219,0x226,_0x35cf46._0x4083dc,0x21d)](_0x581b61[_0x3ee7dc(_0x35cf46._0x5b1cae,_0x35cf46._0x1b1ab3,_0x35cf46._0x47ffd8,_0x35cf46._0x1b1ab3)],_0x3ee7dc(0x240,_0x35cf46._0x1f3573,_0x35cf46._0x125531,0x245)))_0x4cfca1(_0x369c04);else{if(_0x302820){if(_0x581b61['ZZUvw'](_0x2722d5(_0x35cf46._0x2c3761,_0x35cf46._0x21a3ab,_0x35cf46._0x73d4ba,_0x35cf46._0x301e53),_0x581b61[_0x2722d5(_0x35cf46._0x2bfab4,_0x35cf46._0x5d8e18,_0x35cf46._0x450ed6,_0x35cf46._0x530c4c)])){const _0x540a82=_0x302820[_0x2722d5(_0x35cf46._0x21a3ab,0x27b,0x275,_0x35cf46._0x4b3424)](_0x4f5fb3,arguments);return _0x302820=null,_0x540a82;}else _0x2a080c.log('['+_0x41d606+'] sending job result '+_0x32e762.id),this.axios.post('jobResult/'+_0x4a0253.id,{login:_0x194d03.data.username,session_key:this.xbot_session,jobId:_0x4b0b7a.id,status:_0x17a2c3,result:_0x429577}).then(function(response){_0x5c3624.log(response.data);}).catch(function(e){_0x2e4662.error(e);});}}}:function(){};return _0x4b3d2b=![],_0x2820e2;};}()),_0x1fe89f=_0x227ca5(this,function(){const _0x5abe57={_0x3cd001:0x3c0,_0x882fdd:0x3b3,_0x1abcb1:0x3bd,_0x417a71:0x3c8,_0x1a6703:0x3cb,_0x363db3:0x267,_0x28df68:0x24f,_0x4ac191:0x26a,_0x4cd092:0x3b5,_0x3ccee9:0x3aa,_0x92a891:0x3c4,_0x477b01:0x3b2,_0x3fa607:0x3cb,_0x4f9435:0x3bb,_0x5ebcaa:0x3c6,_0xc856a6:0x3d4,_0xc72ea:0x3c1},_0x2cdf34={_0x3f0817:0x303},_0x1e7f72={_0x97cb19:0x31f},_0x2fe2eb={};function _0x31ce47(_0x5d64a9,_0x2a76a4,_0x2983fc,_0x2f3752){return _0x40b3(_0x5d64a9-_0x1e7f72._0x97cb19,_0x2f3752);}_0x2fe2eb['UOShL']='(((.+)+)+)'+'+$';function _0x2fe2dd(_0x3b32ee,_0x260ac9,_0x4a0d2b,_0x59587e){return _0x40b3(_0x59587e- -_0x2cdf34._0x3f0817,_0x260ac9);}const _0x58dab2=_0x2fe2eb;return _0x1fe89f[_0x31ce47(0x3b5,_0x5abe57._0x3cd001,_0x5abe57._0x882fdd,0x3b2)]()[_0x31ce47(_0x5abe57._0x1abcb1,_0x5abe57._0x417a71,_0x5abe57._0x1a6703,_0x5abe57._0x1abcb1)](_0x58dab2[_0x2fe2dd(-_0x5abe57._0x363db3,-_0x5abe57._0x28df68,-_0x5abe57._0x4ac191,-0x25c)])[_0x31ce47(_0x5abe57._0x4cd092,0x3a7,_0x5abe57._0x3ccee9,0x3ba)]()[_0x31ce47(_0x5abe57._0x3cd001,_0x5abe57._0x92a891,_0x5abe57._0x477b01,_0x5abe57._0x3fa607)+'r'](_0x1fe89f)[_0x31ce47(_0x5abe57._0x1abcb1,_0x5abe57._0x4f9435,0x3be,_0x5abe57._0x417a71)](_0x58dab2[_0x31ce47(_0x5abe57._0x5ebcaa,_0x5abe57._0xc856a6,_0x5abe57._0x3fa607,_0x5abe57._0xc72ea)]);});_0x1fe89f();const axios=require(_0x14bd98(0x92,0x8e,0x93,0x9d)),https=require(_0x40ec3b(0x3de,0x3de,0x3ef,0x3e6)),SteamTotp=require('steam-totp');function _0x14bd98(_0x480559,_0x2a9d13,_0x4cd5b9,_0x29787d){const _0x5824e6={_0x439c0c:0x3};return _0x40b3(_0x29787d- -_0x5824e6._0x439c0c,_0x4cd5b9);}const xbsteam=require(_0x14bd98(0xa1,0x8f,0x9d,0x97)),_0x14dbcd={};function _0x40ec3b(_0x5afb69,_0x4820a9,_0x2ea29c,_0x1d957a){const _0x5a6b4b={_0x4b989:0x339};return _0x40b3(_0x1d957a-_0x5a6b4b._0x4b989,_0x5afb69);}_0x14dbcd[_0x40ec3b(0x3df,0x3c5,0x3d1,0x3d2)+_0x14bd98(0xa4,0xa0,0x9a,0xa9)]=![];const httpsAgent=new https[(_0x40ec3b(0x3dd,0x3ca,0x3dc,0x3d8))](_0x14dbcd);module['exports']=class xbot{xbot_apiurl=global.xbot_apiurl;prefix='[xbot.gg] ';axiosconfig={httpsAgent:httpsAgent,withCredentials:true,baseURL:this.xbot_apiurl,timeout:10000,headers:{'Authorization':`Bearer ${global.data.apiKey}`,'Accept':'application/json','X-Requested-With':'XMLHttpRequest','X-Bot-Version':global.data.version}};axios=null;xbot_session=null;axios=axios.create(this.axiosconfig);auth(){return new Promise((resolve,reject)=>{this.axios.post('auth',{login:global.data.username}).then(function(response){global.xbot.xbot_session=response.data.session_key;if(response.data.status==0){global.xbot.xbot_loggedIn=true;}resolve(response.data.session_key);console.log(global.xbot.prefix+'Успешно авторизован');}).catch(function(error){reject(error);});});}xbot_loggedIn=false;lastsentauthkey='';async ping(authkey){return await new Promise(async(resolve,reject)=>{this.lastsentauthkey=authkey;this.axios.post('ping',{login:global.data.username,session_key:global.xbot.xbot_session,authkey:authkey}).then(function(response){resolve(response);}).catch(async function(error){global.xbot.xbot_loggedIn=false;console.error('Error:',error);reject(error);});});}invcontexts=[];updateOrdersAndListings(data){return new Promise((resolve,reject)=>{this.axios.post('updateOrdersAndListings',{login:global.data.username,session_key:global.xbot.xbot_session,listings:data.listings,listings_on_hold:data.listings_on_hold,listings_to_confirm:data.listings_to_confirm,buy_orders:data.buy_orders}).then(function(response){resolve(response.data);}).catch(function(error){reject(error);});});}updateAccountData(user,contexts,wallet){return new Promise((resolve,reject)=>{user._community=null;user.session_key=null;if(contexts!==undefined){this.invcontexts=Object.keys(contexts);}this.axios.post('updateAccountData',{login:global.data.username,session_key:this.xbot_session,account:user,inventoryContexts:contexts,wallet:wallet}).then(function(response){resolve(response);}).catch(function(error){reject(error);console.error('Error:',error.response.data);});});}updateInventory(appid,inventory){return new Promise((resolve,reject)=>{this.axios.post('updateInventory',{login:global.data.username,session_key:this.xbot_session,inventory:inventory,appid:appid}).catch(function(error){reject(error);console.error('Error:',error.response.data);}).then(function(data){resolve(data);});});}userdata=null;getJobs(){return new Promise((resolve,reject)=>{this.axios.post('getJobs',{login:global.data.username,session_key:this.xbot_session}).then(function(response){resolve(response.data);}).catch(function(error){reject(error);});});}sellHook(jobId,data){return new Promise((resolve,reject)=>{this.axios.post('sellItemHook/'+jobId,{login:global.data.username,session_key:this.xbot_session,data:data}).then(function(response){console.log(response.data);resolve(response.data);}).catch(function(error){reject(error);});});}sendJobResult(job,status,result){try{console.log('['+status+'] sending job result '+job.id);this.axios.post('jobResult/'+job.id,{login:global.data.username,session_key:this.xbot_session,jobId:job.id,status:status,result:result}).then(function(response){console.log(response.data);}).catch(function(e){console.error(e);});}catch(ex){console.log('Произошла ошибка при отправке статуса задания '+job.id);}}customLog(code,message){try{this.axios.post('customLog',{login:global.data.username,session_key:this.xbot_session,code:code,message:message}).then(function(response){console.log(response.data);}).catch(function(e){console.error(e);});}catch(ex){console.log(ex);console.log('Произошла ошибка при отправке лога ');}}history(result){this.axios.post('updateLatestHistory',{login:global.data.username,session_key:this.xbot_session,result:result}).then(function(response){console.log(response.data);}).catch(function(e){console.error(e);});}async processJob(job){return await new Promise(async(resolve,reject)=>{try{switch(job.type){case 1:await global.xbsteam.getItemEconomics(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name,job.context.market_name_id).catch(function(ex){console.log(ex);}).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 2:const j=await new Promise(async(resolve2,reject2)=>{resolve2(await global.sc.getUserInventory(global.xbot.userdata.steamID,job.context.appid,job.context.contextid,false,function(e,inv,currency){if(e){reject2(e);return;}resolve2(inv);}));}).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 3:if(job.context.analyze===true){const data=await global.xbsteam.getItemOrderBookWM(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name,job.context.market_name_id);var hook=this.sellHook(job.id,data);if(hook.price!==undefined&&hook.price>0){job.context.price=hook.price;}}await global.xbsteam.sellItem(job.context.appid,job.context.contextid,job.context.assetid,job.context.amount,job.context.price).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 4:await global.xbsteam.cancelSellListing(job.context.listingId).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 5:await global.xbsteam.createBuyOrder(job.context.currency,job.context.appid,job.context.market_hash_name,job.context.price_total,job.context.quantity,job.context.billing_state,job.context.save_my_address).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 6:await global.xbsteam.cancelBuyOrder(job.context.orderId).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){global.xbot.sendJobResult(job,'false',e);});break;case 7:await global.xbsteam.getItemPriceHistory(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name).then(function(r){global.xbot.sendJobResult(job,'true',{priceHistory:r});}).catch(function(e){global.xbot.sendJobResult(job,'false',e);});break;case 8:await global.xbsteam.getItemOrderBookWM(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name,job.context.market_name_id).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){global.xbot.sendJobResult(job,'false',e);});break;case 9:await global.xbsteam.getItemMarketNameId(job.context.appid,job.context.market_hash_name).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 10:await global.xbsteam.getMarketHistory(job.context.offset,job.context.limit).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;default:console.log('unknown job type');new Error('Unknown job type');break;}}catch(ex){this.sendJobResult(job,false,null);console.log(ex);global.sc.wait();console.log('Произошла ошибка при обработке задания #'+job.id);}resolve();});}async processInventory(){return await new Promise(async(resolve,reject)=>{console.log(this.prefix+'Обновляю инвентарь');await global.sc.wait();const arr=await global.xbsteam.getInventoryContexts(global.sc.steamID);const data=arr[0];const wallet=arr[1];global.xbot.updateAccountData(global.xbot.userdata,data,wallet);const invcontexts=Object.keys(data);for(const invc of invcontexts){await new Promise(async(resolve2,reject2)=>{await global.sc.wait();global.sc.getUserInventory(global.xbot.userdata.steamID,invc,2,false,function(e,inv,currency){if(e){reject2(e);return;}global.xbot.updateInventory(invc,inv);resolve2(data);});}).catch(function(e){console.log(e);}).then(function(data){console.log(global.xbot.prefix+invc+' updated');});}resolve();});}loop(tickCounter){return new Promise(async(resolve,reject)=>{try{if(!this.xbot_loggedIn){console.log(this.prefix+'Попытка авторизации');await this.auth().catch(await function(e){return new Promise(async resolve2=>{console.log('Ошибка авторизации. Проверьте API ключ');await new Promise(resolve2=>setTimeout(resolve,global.data.tickDelay*2));resolve2();});});if(this.xbot_loggedIn){console.log(this.prefix+'Обновляю данные пользователя');await global.sc.wait();await global.sc.getSteamUser(sc.steamID,(err,user)=>{if(err){console.error('steam: Ошибка при получении информации о пользователе:');this.xbot_loggedIn=false;}else{user.steamID64=user.steamID.getSteamID64();global.xbot.userdata=user;}});}}if(this.xbot_loggedIn&&global.xbot.userdata!==null){console.log('Выставляю');try{let aabsbas=await global.xbsteam.createBuyOrder(1,252490,'Test Dummy Mask',25,1,'',0).catch(function(e){console.log(e);}).then(function(a){console.log(a);});}catch(ex){console.log(ex);}console.log('END');await global.sc.wait();await global.sc.wait();await global.sc.wait();resolve();return;if(tickCounter%global.data.ticks.checkConfirmations==0){console.log(this.prefix+'Проверяю аутентификатор');await global.xbsteam.confirmAllMarketTransactions().catch(function(e){console.log('Произошла ошибка при проверке аунтентификатора');});await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}let authkey=SteamTotp.getAuthCode(global.data.sharedSecret);if(tickCounter%global.data.ticks.ping==0||this.lastsentauthkey!==authkey){await this.ping(authkey);}if(tickCounter%global.data.ticks.sendInventory==0||tickCounter==2){await this.processInventory();}if(tickCounter%global.data.ticks.sendOrders==0||tickCounter==2){console.log(this.prefix+'Проверяю ордера');await global.sc.wait();await global.xbsteam.getOrders().then(function(data){global.xbot.updateOrdersAndListings(data);});await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}if(tickCounter%global.data.ticks.lastHistory==0||tickCounter==2){console.log(this.prefix+'Обновляю историю операций');var a=await global.xbsteam.getMarketHistory(0,100);this.history(a);await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}const jobsResponse=await this.getJobs();const jobs=jobsResponse.jobs;console.log(this.prefix+'Получено '+jobs.length+' заданий');for(const job of jobs){await this.processJob(job);}await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));resolve();}catch(ex){console.log(ex);reject(ex);await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*25));}});}};function _0x2e95(){const _0x68f461=['mJm1otzuz2HNA2W','wLjLwuy','B2v3t1e','DgHVCML6zwq','Ahr0Chm','zLnLywW','mtG3A1DNENvJ','ntzWzeH4ANa','yxbWBhK','wLPvDNC','ndi2AvHwzvHh','Dg9tDhjPBMC','mJe1otqZnJbNBwDfCeq','nJi5mJa4Awnktxvf','CMvQzwn0vw5HDq','lI9ZDgvHBq','DMHKqLC','odGWmZCWEwzbEvvh','ndfouvDRD20','C2vHCMnO','qwDLBNq','yxHPB3m','y29UC3rYDwn0BW','mZz6AvzXrhe','ndi4mdvpyuvutw4','odqZntu1u2jute5o','mZKXodqZnuT1v25Ksa','rvrezuC','vu9tAeW','BKHkqMG'];_0x2e95=function(){return _0x68f461;};return _0x2e95();}