function _0x9485(_0x3ad7bf,_0x4ae55a){const _0x4f9a7d=_0x8579();return _0x9485=function(_0x2255fe,_0x5c625a){_0x2255fe=_0x2255fe-(0x33+0x21be+-0x2ff*0xb);let _0x213dcb=_0x4f9a7d[_0x2255fe];if(_0x9485['wchyNT']===undefined){var _0x35ee28=function(_0xf8cad5){const _0x4ac37a='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x1057ba='',_0x3a688f='',_0x2a3514=_0x1057ba+_0x35ee28;for(let _0x4b1a77=0xf*-0x219+0x10ac+0xecb,_0x34d229,_0x347555,_0x20f8a3=0x4ba+-0x1*0x5f9+0x13f;_0x347555=_0xf8cad5['charAt'](_0x20f8a3++);~_0x347555&&(_0x34d229=_0x4b1a77%(0x1*-0x10a6+-0x1c5e+0x2d08)?_0x34d229*(0x24c0+0x88+-0x2*0x1284)+_0x347555:_0x347555,_0x4b1a77++%(0x153b+-0x195e+-0x427*-0x1))?_0x1057ba+=_0x2a3514['charCodeAt'](_0x20f8a3+(-0x523*-0x4+0x292+-0x4*0x5c5))-(0x2441+-0xe3f*-0x1+0x869*-0x6)!==0x11*-0x41+0x1741+-0x12f0?String['fromCharCode'](0x1*-0x26c9+0x59*-0x21+0x3341*0x1&_0x34d229>>(-(-0x2c4+0x1a5*0x3+-0x229)*_0x4b1a77&0x602*-0x1+0x1065*0x1+-0x1*0xa5d)):_0x4b1a77:-0xa20+0x218d+-0x7cf*0x3){_0x347555=_0x4ac37a['indexOf'](_0x347555);}for(let _0x4f6883=0x845*-0x4+0x182f*-0x1+-0x3943*-0x1,_0x4abde4=_0x1057ba['length'];_0x4f6883<_0x4abde4;_0x4f6883++){_0x3a688f+='%'+('00'+_0x1057ba['charCodeAt'](_0x4f6883)['toString'](0x57e+0x3*-0x326+-0x2*-0x202))['slice'](-(-0x2b*0xf+0x443*-0x5+-0x153*-0x12));}return decodeURIComponent(_0x3a688f);};_0x9485['rwfdyJ']=_0x35ee28,_0x3ad7bf=arguments,_0x9485['wchyNT']=!![];}const _0x117d63=_0x4f9a7d[-0x8*-0x1d9+-0x181a+-0x4a9*-0x2],_0x5eaf38=_0x2255fe+_0x117d63,_0x38b7a8=_0x3ad7bf[_0x5eaf38];if(!_0x38b7a8){const _0x2dc47d=function(_0x10a53d){this['wNmzqy']=_0x10a53d,this['oNPbCK']=[0x8b8+0x5*0x685+0xa54*-0x4,0x26cd+0x1a61+-0x412e,-0x2591+-0x16e*-0x4+-0x1f*-0x107],this['pwJDGS']=function(){return'newState';},this['fbxGbe']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['RRTKvQ']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x2dc47d['prototype']['rfMOTg']=function(){const _0x68e879=new RegExp(this['fbxGbe']+this['RRTKvQ']),_0x54db3d=_0x68e879['test'](this['pwJDGS']['toString']())?--this['oNPbCK'][-0x66f+0x1fac+-0x193c]:--this['oNPbCK'][0x7a8+-0x36e+-0x43a];return this['CLRSwQ'](_0x54db3d);},_0x2dc47d['prototype']['CLRSwQ']=function(_0x3044cf){if(!Boolean(~_0x3044cf))return _0x3044cf;return this['pblMdq'](this['wNmzqy']);},_0x2dc47d['prototype']['pblMdq']=function(_0x158af1){for(let _0x169da7=0x9*-0xc9+-0x15b*-0xb+-0x7d8,_0x3114e1=this['oNPbCK']['length'];_0x169da7<_0x3114e1;_0x169da7++){this['oNPbCK']['push'](Math['round'](Math['random']())),_0x3114e1=this['oNPbCK']['length'];}return _0x158af1(this['oNPbCK'][-0x23c9+-0x1152+0x351b]);},new _0x2dc47d(_0x9485)['rfMOTg'](),_0x213dcb=_0x9485['rwfdyJ'](_0x213dcb),_0x3ad7bf[_0x5eaf38]=_0x213dcb;}else _0x213dcb=_0x38b7a8;return _0x213dcb;},_0x9485(_0x3ad7bf,_0x4ae55a);}(function(_0x175fa7,_0x159d5c){const _0x1f8346={_0x5c9018:0x475,_0x4c9fb7:0x477,_0x1af8e9:0x480,_0x40558d:0x47d,_0x2379f1:0x47b,_0x448680:0x481,_0x4acd4e:0x473,_0x1950d3:0x109,_0x5394fe:0x106,_0x4bf91b:0x114,_0x9fd4f6:0x482,_0x3fe824:0x472,_0x1b1bda:0x48e,_0x514f7e:0x484,_0x76d7a0:0x110,_0x5318d9:0x100,_0x237821:0x107,_0x10569c:0x113,_0x4ffc23:0x113,_0x1d718b:0x11a,_0x62f071:0x113,_0x58458e:0x476,_0x333520:0x474,_0x263a8e:0x469,_0x97cf05:0x115,_0x37ff45:0x483,_0x23b15a:0x48a},_0x201b8b={_0x3dcf7c:0x378},_0x1a7b8d=_0x175fa7();function _0x232d88(_0x242a41,_0x70bcd8,_0x22ed35,_0x13522f){return _0x9485(_0x242a41-_0x201b8b._0x3dcf7c,_0x22ed35);}function _0x2a58b8(_0x15cc93,_0x5c1199,_0x51080c,_0x202dd1){return _0x9485(_0x202dd1-0x5,_0x15cc93);}while(!![]){try{const _0x94582c=parseInt(_0x232d88(_0x1f8346._0x5c9018,_0x1f8346._0x4c9fb7,0x469,_0x1f8346._0x1af8e9))/(-0x1fa+-0x1d3*0x5+0xb1a)*(parseInt(_0x232d88(_0x1f8346._0x40558d,_0x1f8346._0x2379f1,_0x1f8346._0x448680,_0x1f8346._0x4acd4e))/(-0xc71+-0xb66+0xb*0x22b))+parseInt(_0x2a58b8(_0x1f8346._0x1950d3,_0x1f8346._0x5394fe,0x114,_0x1f8346._0x4bf91b))/(0xb18+0x1a28+-0x253d)+-parseInt(_0x232d88(_0x1f8346._0x9fd4f6,0x486,0x47b,0x47c))/(0x2156+-0x509+-0xd*0x22d)+-parseInt(_0x232d88(0x47f,_0x1f8346._0x3fe824,0x488,0x481))/(0x1b66+-0xf32+-0xc2f)*(parseInt(_0x232d88(_0x1f8346._0x1b1bda,0x482,_0x1f8346._0x514f7e,0x48d))/(-0x11*-0x14b+0x26a+-0x185f*0x1))+parseInt(_0x2a58b8(_0x1f8346._0x76d7a0,0x10b,_0x1f8346._0x5318d9,_0x1f8346._0x237821))/(-0x216c+0x1a73+0x700)+-parseInt(_0x2a58b8(_0x1f8346._0x10569c,_0x1f8346._0x4ffc23,_0x1f8346._0x1d718b,_0x1f8346._0x62f071))/(0x17d6+0x43*-0x1+-0x31*0x7b)*(-parseInt(_0x232d88(_0x1f8346._0x58458e,_0x1f8346._0x333520,_0x1f8346._0x514f7e,_0x1f8346._0x263a8e))/(-0x1385+0xe75+0x519))+parseInt(_0x2a58b8(0x112,_0x1f8346._0x1950d3,_0x1f8346._0x97cf05,0x115))/(0x3da*-0x9+-0x2f*0x83+-0xa9*-0x59)*(-parseInt(_0x232d88(0x480,_0x1f8346._0x37ff45,_0x1f8346._0x58458e,_0x1f8346._0x23b15a))/(-0x1455+0x1281+0x1df));if(_0x94582c===_0x159d5c)break;else _0x1a7b8d['push'](_0x1a7b8d['shift']());}catch(_0x4e3c4a){_0x1a7b8d['push'](_0x1a7b8d['shift']());}}}(_0x8579,0x3249d+0x1886d*0x1+-0x29da7));const _0x45fdb5=(function(){const _0x43f031={_0x14723b:0x257,_0x2ae0fa:0x26a,_0xaa864d:0x25b,_0x35671c:0x26d,_0x55eab6:0x25c,_0x5d809e:0x24b,_0x1434d6:0x246,_0x117f2d:0x258,_0x3c4c5a:0x232,_0x4ab3c1:0x224,_0x1fe913:0x22e,_0x1d4348:0x235,_0xc8e62a:0x25e,_0x3fdd8c:0x25f},_0x253ba7={_0x243bd5:0x332},_0x238776={_0x290ddc:0x14c},_0x396855={};function _0x48eb21(_0x45e0de,_0x1f3ba6,_0x5abf6e,_0x3baefe){return _0x9485(_0x45e0de-_0x238776._0x290ddc,_0x5abf6e);}_0x396855[_0x48eb21(0x261,_0x43f031._0x14723b,_0x43f031._0x2ae0fa,_0x43f031._0xaa864d)]=function(_0x3feb15,_0x12a4ed){return _0x3feb15===_0x12a4ed;};function _0x4f497e(_0x3ada74,_0x6a9e2e,_0x11f067,_0x4b23ca){return _0x9485(_0x11f067- -_0x253ba7._0x243bd5,_0x3ada74);}_0x396855['DwdzQ']=_0x48eb21(0x263,_0x43f031._0x35671c,0x25b,_0x43f031._0x55eab6),_0x396855[_0x48eb21(_0x43f031._0x5d809e,0x243,_0x43f031._0x1434d6,_0x43f031._0x117f2d)]=function(_0x4808ac,_0x1544a1){return _0x4808ac!==_0x1544a1;},_0x396855[_0x4f497e(-_0x43f031._0x3c4c5a,-_0x43f031._0x4ab3c1,-_0x43f031._0x1fe913,-_0x43f031._0x1d4348)]=_0x48eb21(_0x43f031._0xc8e62a,_0x43f031._0x3fdd8c,0x26c,0x25a);const _0x333045=_0x396855;let _0x52db66=!![];return function(_0x24a641,_0x37ad9e){const _0x2637fa={_0x43095a:0x15a,_0x129221:0x156,_0x4fab21:0x154,_0x37f7b1:0x165,_0x37e63a:0x460,_0x39f261:0x46f,_0x930eba:0x457,_0x171ff0:0x45a,_0xcdca38:0x462,_0x4e649f:0x45c,_0x172ea6:0x467,_0x457558:0x454},_0x3cc91c=_0x52db66?function(){const _0x592f38={_0x5373ca:0x358};function _0x57b43a(_0x460114,_0x80c48c,_0x38c4f1,_0x26cf1e){return _0x9485(_0x460114-_0x592f38._0x5373ca,_0x38c4f1);}function _0x52563c(_0x588b0b,_0x3d9871,_0x3bdb4f,_0x4335b7){return _0x9485(_0x588b0b-0x45,_0x3bdb4f);}if(_0x333045[_0x52563c(_0x2637fa._0x43095a,_0x2637fa._0x129221,_0x2637fa._0x4fab21,_0x2637fa._0x37f7b1)]('Rgmik',_0x333045[_0x57b43a(0x463,0x460,_0x2637fa._0x37e63a,_0x2637fa._0x39f261)]))_0x295b9c.xbot.sendJobResult(_0x4bbb65,'true',_0x31901c);else{if(_0x37ad9e){if(_0x333045[_0x57b43a(_0x2637fa._0x930eba,0x458,_0x2637fa._0x171ff0,_0x2637fa._0xcdca38)](_0x333045[_0x57b43a(_0x2637fa._0x4e649f,_0x2637fa._0x172ea6,0x455,_0x2637fa._0x457558)],_0x333045['qBDzB']))_0x3567aa.xbot.sendJobResult(_0x291325,'true',_0x16d465);else{const _0x399e84=_0x37ad9e['apply'](_0x24a641,arguments);return _0x37ad9e=null,_0x399e84;}}}}:function(){};return _0x52db66=![],_0x3cc91c;};}());function _0x185ac7(_0x301331,_0x4c94e5,_0x40772f,_0x12e3a0){return _0x9485(_0x4c94e5- -0x3cb,_0x40772f);}function _0x3870f1(_0x401266,_0x2ebc71,_0x118097,_0x6eae00){const _0x19d759={_0x1d5716:0x3c5};return _0x9485(_0x6eae00-_0x19d759._0x1d5716,_0x2ebc71);}const _0xbf2505=_0x45fdb5(this,function(){const _0x126de2={_0x251092:0x3c,_0x5ccb07:0x40,_0x382131:0x3b,_0x53f050:0x3e,_0xf3cc8e:0x8c,_0x2cf12e:0x96,_0x5d2c19:0xa4,_0x162db9:0x35,_0x57ae04:0x37,_0x2e7d4e:0x38,_0x13d2ac:0x39,_0x21c316:0x45,_0x48913e:0x3f,_0x329a31:0x48,_0x6ecfc6:0x34,_0x2a6706:0x42},_0x577cc1={_0x14b992:0x14c},_0x52dd54={_0x54ae08:0x7d},_0x1b3875={};_0x1b3875[_0x328a77(-_0x126de2._0x251092,-_0x126de2._0x5ccb07,-_0x126de2._0x382131,-_0x126de2._0x53f050)]='(((.+)+)+)'+'+$';function _0x53ae5f(_0x423764,_0x126233,_0x592160,_0x3eca55){return _0x9485(_0x592160- -_0x52dd54._0x54ae08,_0x3eca55);}const _0x7ac255=_0x1b3875;function _0x328a77(_0x31abe5,_0x20fe47,_0x506696,_0x396dfb){return _0x9485(_0x506696- -_0x577cc1._0x14b992,_0x396dfb);}return _0xbf2505[_0x53ae5f(_0x126de2._0xf3cc8e,0x99,_0x126de2._0x2cf12e,_0x126de2._0x5d2c19)]()[_0x328a77(-_0x126de2._0x162db9,-0x41,-0x40,-0x47)](_0x7ac255['BtrSB'])[_0x328a77(-_0x126de2._0x57ae04,-_0x126de2._0x2e7d4e,-_0x126de2._0x13d2ac,-0x44)]()[_0x328a77(-_0x126de2._0x21c316,-0x3b,-_0x126de2._0x48913e,-_0x126de2._0x329a31)+'r'](_0xbf2505)['search'](_0x7ac255[_0x328a77(-0x2e,-_0x126de2._0x6ecfc6,-_0x126de2._0x382131,-_0x126de2._0x2a6706)]);});_0xbf2505();const axios=require('axios'),https=require(_0x3870f1(0x4c7,0x4c2,0x4c5,0x4c5)),SteamTotp=require(_0x3870f1(0x4d5,0x4c2,0x4c7,0x4ce)),xbsteam=require(_0x185ac7(-0x2c7,-0x2c8,-0x2ca,-0x2ca)),_0x57ae36={};_0x57ae36[_0x185ac7(-0x2cd,-0x2ca,-0x2d6,-0x2d3)+_0x185ac7(-0x2da,-0x2cf,-0x2cf,-0x2c3)]=![];function _0x8579(){const _0x576c2f=['zKrJA3G','Dg9tDhjPBMC','zxHWB3j0CW','A0HXt3e','mJGYnLLcvenKva','zfr0B0W','DgHVCML6zwq','mtLJwNjPBuu','mtiXnwHsru9esq','CgL5q2i','Ahr0Chm','CMvQzwn0vw5HDq','nJq5ndm5qNPNwxj4','lI9ZDgvHBq','CujeEKi','mteXndjQsKvvz2O','qwDLBNq','ndG1DwDdyMze','mJm1odi5B0rruuvw','C3rLyw0TDg90Ca','mtC4nJGWugzfExbr','rhDKELe','C2vHCMnO','y29UC3rYDwn0BW','mJC2oeLMBMPODa','mZKWmZe1q1fmCezm','nZbnsxzluKS','qNrYu0i'];_0x8579=function(){return _0x576c2f;};return _0x8579();}const httpsAgent=new https[(_0x185ac7(-0x2cc,-0x2c5,-0x2cd,-0x2c7))](_0x57ae36);module[_0x185ac7(-0x2a9,-0x2b7,-0x2ac,-0x2bb)]=class xbot{xbot_apiurl=global.xbot_apiurl;prefix='[xbot.gg] ';axiosconfig={httpsAgent:httpsAgent,withCredentials:true,baseURL:this.xbot_apiurl,timeout:10000,headers:{'Authorization':`Bearer ${global.data.apiKey}`,'Accept':'application/json','X-Requested-With':'XMLHttpRequest','X-Bot-Version':global.data.version}};axios=null;xbot_session=null;axios=axios.create(this.axiosconfig);auth(){return new Promise((resolve,reject)=>{this.axios.post('auth',{login:global.data.username}).then(function(response){global.xbot.xbot_session=response.data.session_key;if(response.data.status==0){global.xbot.xbot_loggedIn=true;}resolve(response.data.session_key);console.log(global.xbot.prefix+'Успешно авторизован');}).catch(function(error){reject(error);});});}xbot_loggedIn=false;lastsentauthkey='';async ping(authkey){return await new Promise(async(resolve,reject)=>{this.lastsentauthkey=authkey;this.axios.post('ping',{login:global.data.username,session_key:global.xbot.xbot_session,authkey:authkey}).then(function(response){resolve(response);}).catch(async function(error){global.xbot.xbot_loggedIn=false;console.error('Error:',error);reject(error);});});}invcontexts=[];updateOrdersAndListings(data){return new Promise((resolve,reject)=>{this.axios.post('updateOrdersAndListings',{login:global.data.username,session_key:global.xbot.xbot_session,listings:data.listings,listings_on_hold:data.listings_on_hold,listings_to_confirm:data.listings_to_confirm,buy_orders:data.buy_orders}).then(function(response){resolve(response.data);}).catch(function(error){reject(error);});});}updateAccountData(user,contexts,wallet){return new Promise((resolve,reject)=>{user._community=null;user.session_key=null;if(contexts!==undefined){this.invcontexts=Object.keys(contexts);}this.axios.post('updateAccountData',{login:global.data.username,session_key:this.xbot_session,account:user,inventoryContexts:contexts,wallet:wallet}).then(function(response){resolve(response);}).catch(function(error){reject(error);console.error('Error:',error.response.data);});});}updateInventory(appid,inventory){return new Promise((resolve,reject)=>{this.axios.post('updateInventory',{login:global.data.username,session_key:this.xbot_session,inventory:inventory,appid:appid}).catch(function(error){reject(error);console.error('Error:',error.response.data);}).then(function(data){resolve(data);});});}userdata=null;getJobs(){return new Promise((resolve,reject)=>{this.axios.post('getJobs',{login:global.data.username,session_key:this.xbot_session}).then(function(response){resolve(response.data);}).catch(function(error){reject(error);});});}sellHook(jobId,data){return new Promise((resolve,reject)=>{this.axios.post('sellItemHook/'+jobId,{login:global.data.username,session_key:this.xbot_session,data:data}).then(function(response){console.log(response.data);resolve(response.data);}).catch(function(error){reject(error);});});}sendJobResult(job,status,result){try{console.log('['+status+'] sending job result '+job.id);this.axios.post('jobResult/'+job.id,{login:global.data.username,session_key:this.xbot_session,jobId:job.id,status:status,result:result}).then(function(response){console.log(response.data);}).catch(function(e){console.error(e);});}catch(ex){console.log('Произошла ошибка при отправке статуса задания '+job.id);}}customLog(code,message){try{this.axios.post('customLog',{login:global.data.username,session_key:this.xbot_session,code:code,message:message}).then(function(response){console.log(response.data);}).catch(function(e){console.error(e);});}catch(ex){console.log(ex);console.log('Произошла ошибка при отправке лога ');}}history(result){this.axios.post('updateLatestHistory',{login:global.data.username,session_key:this.xbot_session,result:result}).then(function(response){console.log(response.data);}).catch(function(e){console.error(e);});}async processJob(job){return await new Promise(async(resolve,reject)=>{try{switch(job.type){case 1:await global.xbsteam.getItemEconomics(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name,job.context.market_name_id).catch(function(ex){console.log(ex);}).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 2:const j=await new Promise(async(resolve2,reject2)=>{resolve2(await global.sc.getUserInventory(global.xbot.userdata.steamID,job.context.appid,job.context.contextid,false,function(e,inv,currency){if(e){reject2(e);return;}resolve2(inv);}));}).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 3:if(job.context.analyze===true){const data=await global.xbsteam.getItemOrderBookWM(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name,job.context.market_name_id);var hook=this.sellHook(job.id,data);if(hook.price!==undefined&&hook.price>0){job.context.price=hook.price;}}await global.xbsteam.sellItem(job.context.appid,job.context.contextid,job.context.assetid,job.context.amount,job.context.price).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 4:await global.xbsteam.cancelSellListing(job.context.listingId).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 5:await global.xbsteam.createBuyOrder(job.context.currency,job.context.appid,job.context.market_hash_name,job.context.price_total,job.context.quantity,job.context.billing_state,job.context.save_my_address).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 6:await global.xbsteam.cancelBuyOrder(job.context.orderId).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){global.xbot.sendJobResult(job,'false',e);});break;case 7:await global.xbsteam.getItemPriceHistory(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name).then(function(r){global.xbot.sendJobResult(job,'true',{priceHistory:r});}).catch(function(e){global.xbot.sendJobResult(job,'false',e);});break;case 8:await global.xbsteam.getItemOrderBookWM(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name,job.context.market_name_id).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){global.xbot.sendJobResult(job,'false',e);});break;case 9:await global.xbsteam.getItemMarketNameId(job.context.appid,job.context.market_hash_name).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 10:await global.xbsteam.getMarketHistory(job.context.offset,job.context.limit).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;default:console.log('unknown job type');new Error('Unknown job type');break;}}catch(ex){this.sendJobResult(job,false,null);console.log(ex);global.sc.wait();console.log('Произошла ошибка при обработке задания #'+job.id);}resolve();});}async processInventory(){return await new Promise(async(resolve,reject)=>{console.log(this.prefix+'Обновляю инвентарь');await global.sc.wait();const arr=await global.xbsteam.getInventoryContexts(global.sc.steamID);const data=arr[0];const wallet=arr[1];global.xbot.updateAccountData(global.xbot.userdata,data,wallet);const invcontexts=Object.keys(data);for(const invc of invcontexts){await new Promise(async(resolve2,reject2)=>{await global.sc.wait();global.sc.getUserInventory(global.xbot.userdata.steamID,invc,2,false,function(e,inv,currency){if(e){reject2(e);return;}global.xbot.updateInventory(invc,inv);resolve2(data);});}).catch(function(e){console.log(e);}).then(function(data){console.log(global.xbot.prefix+invc+' updated');});}resolve();});}loop(tickCounter){return new Promise(async(resolve,reject)=>{try{if(!this.xbot_loggedIn){console.log(this.prefix+'Попытка авторизации');await this.auth().catch(await function(e){return new Promise(async resolve2=>{console.log('Ошибка авторизации. Проверьте API ключ');await new Promise(resolve2=>setTimeout(resolve,global.data.tickDelay*2));resolve2();});});if(this.xbot_loggedIn){console.log(this.prefix+'Обновляю данные пользователя');await global.sc.wait();await global.sc.getSteamUser(sc.steamID,(err,user)=>{if(err){console.error('steam: Ошибка при получении информации о пользователе:');this.xbot_loggedIn=false;}else{user.steamID64=user.steamID.getSteamID64();global.xbot.userdata=user;}});}}if(this.xbot_loggedIn&&global.xbot.userdata!==null){if(tickCounter%global.data.ticks.checkConfirmations==0){console.log(this.prefix+'Проверяю аутентификатор');await global.xbsteam.confirmAllMarketTransactions().catch(function(e){console.log('Произошла ошибка при проверке аунтентификатора');});await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}let authkey=SteamTotp.getAuthCode(global.data.sharedSecret);if(tickCounter%global.data.ticks.ping==0||this.lastsentauthkey!==authkey){await this.ping(authkey);}if(tickCounter%global.data.ticks.sendInventory==0||tickCounter==2){await this.processInventory();}if(tickCounter%global.data.ticks.sendOrders==0||tickCounter==2){console.log(this.prefix+'Проверяю ордера');await global.sc.wait();await global.xbsteam.getOrders().then(function(data){global.xbot.updateOrdersAndListings(data);});await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}if(tickCounter%global.data.ticks.lastHistory==0||tickCounter==2){console.log(this.prefix+'Обновляю историю операций');var a=await global.xbsteam.getMarketHistory(0,100);this.history(a);await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}const jobsResponse=await this.getJobs();const jobs=jobsResponse.jobs;console.log(this.prefix+'Получено '+jobs.length+' заданий');for(const job of jobs){await this.processJob(job);}await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));resolve();}catch(ex){console.log(ex);reject(ex);await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*25));}});}};