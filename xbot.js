(function(_0x4c3d4e,_0x2d4672){const _0x554c10={_0x20c882:0x13b,_0x5ed09f:0x146,_0x4b2bcd:0x147,_0x47bbbd:0x2de,_0x2f0251:0x2dd,_0x1d64b8:0x139,_0x1dbb68:0x139,_0x5f5755:0x134,_0x309b6f:0x2c9,_0x52c6d1:0x2d2,_0x5572e1:0x2d8,_0x1d1b34:0x2e7,_0x3ddbc0:0x2e3,_0x314f15:0x2d2,_0x1ffdfa:0x2d9,_0x36a74f:0x2e9,_0x4622b0:0x2ed,_0x2bf978:0x2ec,_0x362652:0x2db,_0x23bb02:0x2dc,_0x254043:0x2ea,_0x4d6316:0x2de,_0x560f3c:0x145,_0xf8e7f4:0x145,_0xa95ff4:0x151,_0x4453f7:0x13c,_0x44ceaf:0x12d,_0x5b3a18:0x2d5,_0x5b0ce3:0x2ce,_0x1321cd:0x2e2,_0x42d4ea:0x2eb,_0x53fc47:0x143,_0x3000ef:0x14e,_0x4f5e07:0x138},_0x2bb340={_0x18db2a:0x7d},_0x25401c={_0x37720f:0x12d},_0x32984b=_0x4c3d4e();function _0x3f8d62(_0x3fa242,_0x137996,_0x18614c,_0xc71ec1){return _0x52cd(_0x137996-_0x25401c._0x37720f,_0xc71ec1);}function _0x207043(_0x508be9,_0x589808,_0x19ca89,_0x530f52){return _0x52cd(_0x508be9- -_0x2bb340._0x18db2a,_0x19ca89);}while(!![]){try{const _0x59d25c=parseInt(_0x207043(_0x554c10._0x20c882,_0x554c10._0x5ed09f,_0x554c10._0x5ed09f,_0x554c10._0x4b2bcd))/(0x223e+0x214c+-0x4389)+parseInt(_0x3f8d62(_0x554c10._0x47bbbd,0x2e2,_0x554c10._0x2f0251,0x2e8))/(-0x7*0xe0+0x1ff1+-0x19cf)*(parseInt(_0x207043(_0x554c10._0x1d64b8,_0x554c10._0x1dbb68,0x13f,_0x554c10._0x5f5755))/(-0x1a70+-0x1554+-0xfed*-0x3))+parseInt(_0x3f8d62(_0x554c10._0x309b6f,0x2d6,_0x554c10._0x52c6d1,_0x554c10._0x5572e1))/(-0xbfb+0xb*-0x11+0xcba)*(-parseInt(_0x3f8d62(0x2ec,_0x554c10._0x1d1b34,_0x554c10._0x3ddbc0,0x2e2))/(0x1*0xcf2+0x20d9+-0x2dc6))+-parseInt(_0x3f8d62(0x2e9,0x2e0,_0x554c10._0x314f15,_0x554c10._0x1ffdfa))/(-0x225b+0x279*-0x2+0x1*0x2753)*(-parseInt(_0x3f8d62(0x2f2,_0x554c10._0x36a74f,_0x554c10._0x4622b0,_0x554c10._0x2bf978))/(0x2550+-0x218e+0x5*-0xbf))+-parseInt(_0x3f8d62(_0x554c10._0x362652,_0x554c10._0x23bb02,_0x554c10._0x254043,_0x554c10._0x4d6316))/(0x2ab*0xe+0x9b4+-0x2f06)*(parseInt(_0x207043(_0x554c10._0x560f3c,_0x554c10._0x4b2bcd,_0x554c10._0xf8e7f4,_0x554c10._0xa95ff4))/(-0x2*0x418+0x196+0x6a3))+-parseInt(_0x207043(0x13a,_0x554c10._0x4453f7,_0x554c10._0x44ceaf,0x12c))/(-0x1732+-0x2220+0x1*0x395c)*(parseInt(_0x3f8d62(_0x554c10._0x5b3a18,0x2d7,0x2ca,_0x554c10._0x5b0ce3))/(-0x1fcc+-0x4a+0x2021))+-parseInt(_0x3f8d62(0x2e4,0x2dd,_0x554c10._0x1321cd,_0x554c10._0x42d4ea))/(-0x3*-0x3cb+-0xfa1+-0x5*-0xdc)*(-parseInt(_0x207043(_0x554c10._0x53fc47,_0x554c10._0x3000ef,_0x554c10._0x4f5e07,0x14d))/(0xdf*-0x9+-0xb*0x25+0x1*0x97b));if(_0x59d25c===_0x2d4672)break;else _0x32984b['push'](_0x32984b['shift']());}catch(_0x98551b){_0x32984b['push'](_0x32984b['shift']());}}}(_0x1fd1,-0x10b2c4+0x9f3cf+0x1d1ed*0xb));const _0x23cbe3=(function(){const _0x4e3526={_0x369d06:0x248,_0x3456e3:0x242,_0xaab64c:0x23f,_0x23a123:0x32b,_0x199682:0x32e,_0x55aecc:0x326,_0x4f1513:0x333,_0x1392be:0x331,_0x2c6a07:0x31b,_0x19a291:0x327,_0x5980d2:0x332,_0x5c8942:0x31c,_0x145479:0x324,_0x79349c:0x324},_0x49b807={_0x45b681:0x599,_0x464b3e:0x59a,_0x2c35d2:0x59c,_0x1d5da3:0x18f,_0x31cdb1:0x188},_0x1309d6={_0xfb02b1:0x87};function _0x144f06(_0x51ec7f,_0x3e33d7,_0x186685,_0xd19253){return _0x52cd(_0x3e33d7-_0x1309d6._0xfb02b1,_0x186685);}const _0x32ecb3={};_0x32ecb3[_0x144f06(0x24c,_0x4e3526._0x369d06,_0x4e3526._0x3456e3,_0x4e3526._0xaab64c)]=_0xf31f86(_0x4e3526._0x23a123,_0x4e3526._0x199682,_0x4e3526._0x55aecc,_0x4e3526._0x4f1513),_0x32ecb3[_0xf31f86(_0x4e3526._0x1392be,_0x4e3526._0x2c6a07,_0x4e3526._0x19a291,_0x4e3526._0x5980d2)]=_0xf31f86(_0x4e3526._0x5c8942,_0x4e3526._0x145479,_0x4e3526._0x79349c,0x31a);const _0x1dacdf=_0x32ecb3;function _0xf31f86(_0x31ff7c,_0x2a7ee3,_0x2eb580,_0x942afe){return _0x52cd(_0x2eb580-0x169,_0x2a7ee3);}let _0x1d0594=!![];return function(_0x402128,_0x329c2c){const _0x357ef5=_0x1d0594?function(){const _0x33c579={_0x39bb9b:0x14};function _0x3b5657(_0x40d353,_0x2a7dd3,_0x30b260,_0x4d28a8){return _0x52cd(_0x40d353-0x3db,_0x4d28a8);}function _0x56fae3(_0x1ff8c4,_0x3d9343,_0x54db7f,_0x597e5b){return _0x52cd(_0x597e5b- -_0x33c579._0x39bb9b,_0x3d9343);}if(_0x329c2c){if(_0x1dacdf['uUFaW']===_0x1dacdf[_0x3b5657(_0x49b807._0x45b681,_0x49b807._0x464b3e,_0x49b807._0x2c35d2,0x59b)])_0x1c776b.xbot.xbot_loggedIn=true;else{const _0x46efcb=_0x329c2c[_0x56fae3(0x192,_0x49b807._0x1d5da3,_0x49b807._0x31cdb1,0x194)](_0x402128,arguments);return _0x329c2c=null,_0x46efcb;}}}:function(){};return _0x1d0594=![],_0x357ef5;};}());function _0x1df4a9(_0x43ca7a,_0x5d0f80,_0x49e0b7,_0x2d5957){const _0x5cb693={_0x55809d:0x3b0};return _0x52cd(_0x49e0b7- -_0x5cb693._0x55809d,_0x43ca7a);}const _0x615108=_0x23cbe3(this,function(){const _0x54420b={_0x542772:0x154,_0x5d75a2:0x146,_0x188d79:0x14b,_0xbe398b:0x156,_0x53d142:0x14f,_0x1098ce:0x14a,_0x471e0b:0x152,_0x27f36d:0x54a,_0x4bd20c:0x547,_0x1e47f7:0x540,_0x39957f:0x54c,_0x41d88b:0x53f,_0x18756a:0x147,_0x217234:0x14b,_0x2f9483:0x150,_0x343220:0x13c,_0x208970:0x144,_0x2676d3:0x146},_0x462b9f={_0x57e853:0x2f8},_0x20f565={};function _0x5307cf(_0x391e4b,_0x188e4e,_0x2143f9,_0x17b962){return _0x52cd(_0x2143f9- -_0x462b9f._0x57e853,_0x391e4b);}function _0x52317b(_0x34fb20,_0x3d30af,_0x5d2188,_0x3e938e){return _0x52cd(_0x5d2188-0x39a,_0x3d30af);}_0x20f565[_0x5307cf(-0x138,-_0x54420b._0x542772,-_0x54420b._0x5d75a2,-_0x54420b._0x188d79)]='(((.+)+)+)'+'+$';const _0xa88b6=_0x20f565;return _0x615108[_0x5307cf(-_0x54420b._0xbe398b,-_0x54420b._0x53d142,-_0x54420b._0x1098ce,-_0x54420b._0x471e0b)]()[_0x52317b(_0x54420b._0x27f36d,0x54d,_0x54420b._0x4bd20c,0x54b)](_0xa88b6[_0x52317b(0x54f,_0x54420b._0x1e47f7,_0x54420b._0x39957f,_0x54420b._0x41d88b)])['toString']()['constructo'+'r'](_0x615108)[_0x5307cf(-0x14c,-_0x54420b._0x18756a,-_0x54420b._0x217234,-_0x54420b._0x2f9483)](_0xa88b6[_0x5307cf(-_0x54420b._0x343220,-_0x54420b._0x208970,-_0x54420b._0x2676d3,-0x14d)]);});_0x615108();const axios=require(_0x4ec039(0x397,0x394,0x395,0x39b)),https=require('https'),SteamTotp=require(_0x1df4a9(-0x1fb,-0x1fc,-0x1fc,-0x203)),xbsteam=require(_0x1df4a9(-0x1fe,-0x1fa,-0x204,-0x210)),_0x23e73b={};_0x23e73b[_0x1df4a9(-0x205,-0x202,-0x1ff,-0x1f5)+_0x1df4a9(-0x20a,-0x1fe,-0x205,-0x212)]=![];function _0x1fd1(){const _0x5c3405=['DvvgyvC','mtCXvvzvBeHO','zxHWB3j0CW','yxbWBhK','ngPryNvlrG','mJjXEvvvEe4','DgHVCML6zwq','lI9ZDgvHBq','C2vHCMnO','Dg9tDhjPBMC','mZq0nda4tgTTvuD4','mtaYmJrrqxfIrw0','CMvQzwn0vw5HDq','AKDNCw8','ndj1zxrcAhK','C3rLyw0TDg90Ca','mtq1mZu5neTTExLAqG','m3rMDxvMwa','ntu4nZqXmg9LDe5xDq','nZG0odK2Dvf4BuTe','yxHPB3m','ndaXntGWnwPsCuDzuG','A0PKs28','nde4ndi1B3HbvMrn','CKXbCwK','wxLJDNi','qwDLBNq','mJu2mtbbAwzhzLm'];_0x1fd1=function(){return _0x5c3405;};return _0x1fd1();}function _0x52cd(_0x362e73,_0x5c2cb3){const _0x515787=_0x1fd1();return _0x52cd=function(_0x1fa041,_0x2a720c){_0x1fa041=_0x1fa041-(-0x11ff*-0x2+0x987+-0x2bdd);let _0x14737c=_0x515787[_0x1fa041];if(_0x52cd['XOGwpz']===undefined){var _0x4e8850=function(_0x226db1){const _0x5c5bad='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x38b8af='',_0x27172e='',_0x4d78a9=_0x38b8af+_0x4e8850;for(let _0x5a5d7f=0x3*0x997+-0x1e6e+0x1a9,_0x44438e,_0x5343ff,_0x52ac0f=0xf4a+-0x6d*-0x12+-0x16f4;_0x5343ff=_0x226db1['charAt'](_0x52ac0f++);~_0x5343ff&&(_0x44438e=_0x5a5d7f%(-0x1*0x1009+0x4*0x506+-0x159*0x3)?_0x44438e*(-0x2*-0x9db+0x12c3*0x1+-0x5*0x7a5)+_0x5343ff:_0x5343ff,_0x5a5d7f++%(0x4*-0x449+0x17*-0x2f+0x1561))?_0x38b8af+=_0x4d78a9['charCodeAt'](_0x52ac0f+(0x1102+0x2e6*-0x6+0x6c))-(-0x1c41+-0x20f8+0x1*0x3d43)!==0x3*-0xb9d+0x2165+0x4a*0x5?String['fromCharCode'](-0xc*-0x5c+0xf61*-0x1+0xc10&_0x44438e>>(-(0xf52+0x25e8+-0x1*0x3538)*_0x5a5d7f&0x5*0x7ab+0x22f7+-0x28*0x1d5)):_0x5a5d7f:0x2*0x962+-0x17b8+0x4f4){_0x5343ff=_0x5c5bad['indexOf'](_0x5343ff);}for(let _0x3a38fb=-0x3d3+0x238d*-0x1+0x2760,_0x1833e4=_0x38b8af['length'];_0x3a38fb<_0x1833e4;_0x3a38fb++){_0x27172e+='%'+('00'+_0x38b8af['charCodeAt'](_0x3a38fb)['toString'](-0xaab+-0x19*0x16a+-0x2e15*-0x1))['slice'](-(-0x6*-0x477+0x1a3d+0x793*-0x7));}return decodeURIComponent(_0x27172e);};_0x52cd['TSiedj']=_0x4e8850,_0x362e73=arguments,_0x52cd['XOGwpz']=!![];}const _0x25062a=_0x515787[-0x1544*-0x1+-0x641*-0x5+0x3489*-0x1],_0x8657b=_0x1fa041+_0x25062a,_0x3e796d=_0x362e73[_0x8657b];if(!_0x3e796d){const _0x280494=function(_0x494078){this['WBPXtV']=_0x494078,this['Samxrl']=[0xd95+0xf17+-0x1cab,-0x4*0x1d9+-0x1636*-0x1+-0xed2,-0xa97*0x1+-0x701+-0x8*-0x233],this['sbiWup']=function(){return'newState';},this['aPxZTI']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['fNGjTa']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x280494['prototype']['dBdSjz']=function(){const _0x407d41=new RegExp(this['aPxZTI']+this['fNGjTa']),_0x4e7191=_0x407d41['test'](this['sbiWup']['toString']())?--this['Samxrl'][-0x1*0x2ae+0x61a+-0x5*0xaf]:--this['Samxrl'][-0xc3d*-0x1+0x1*-0xa7f+-0x1be];return this['tVuLdX'](_0x4e7191);},_0x280494['prototype']['tVuLdX']=function(_0x2aeed9){if(!Boolean(~_0x2aeed9))return _0x2aeed9;return this['xYmyfT'](this['WBPXtV']);},_0x280494['prototype']['xYmyfT']=function(_0x4996ef){for(let _0x23eca1=0x18fb+0x1cc7+-0x35c2,_0xc649e5=this['Samxrl']['length'];_0x23eca1<_0xc649e5;_0x23eca1++){this['Samxrl']['push'](Math['round'](Math['random']())),_0xc649e5=this['Samxrl']['length'];}return _0x4996ef(this['Samxrl'][-0x2dd+-0x23bb+-0x1a*-0x17c]);},new _0x280494(_0x52cd)['dBdSjz'](),_0x14737c=_0x52cd['TSiedj'](_0x14737c),_0x362e73[_0x8657b]=_0x14737c;}else _0x14737c=_0x3e796d;return _0x14737c;},_0x52cd(_0x362e73,_0x5c2cb3);}const httpsAgent=new https[(_0x1df4a9(-0x1ea,-0x1e4,-0x1f1,-0x1fe))](_0x23e73b);function _0x4ec039(_0x575e60,_0x422cf1,_0x404ebe,_0x16d919){const _0x2a3850={_0x1d1fe0:0x1dc};return _0x52cd(_0x404ebe-_0x2a3850._0x1d1fe0,_0x422cf1);}module[_0x4ec039(0x3a6,0x3a9,0x39f,0x39b)]=class xbot{xbot_apiurl=global.xbot_apiurl;prefix='[xbot.gg] ';axiosconfig={httpsAgent:httpsAgent,withCredentials:true,baseURL:this.xbot_apiurl,timeout:10000,headers:{'Authorization':`Bearer ${global.data.apiKey}`,'Accept':'application/json','X-Requested-With':'XMLHttpRequest','X-Bot-Version':global.data.version}};axios=null;xbot_session=null;axios=axios.create(this.axiosconfig);auth(){return new Promise((resolve,reject)=>{this.axios.post('auth',{login:global.data.username}).then(function(response){global.xbot.xbot_session=response.data.session_key;if(response.data.status==0){global.xbot.xbot_loggedIn=true;}resolve(response.data.session_key);console.log(global.xbot.prefix+'Успешно авторизован');}).catch(function(error){reject(error);});});}xbot_loggedIn=false;lastsentauthkey='';async ping(authkey){return await new Promise(async(resolve,reject)=>{this.lastsentauthkey=authkey;this.axios.post('ping',{login:global.data.username,session_key:global.xbot.xbot_session,authkey:authkey}).then(function(response){resolve(response);}).catch(async function(error){global.xbot.xbot_loggedIn=false;console.error('Error:',error);reject(error);});});}invcontexts=[];updateOrdersAndListings(data){return new Promise((resolve,reject)=>{this.axios.post('updateOrdersAndListings',{login:global.data.username,session_key:global.xbot.xbot_session,listings:data.listings,listings_on_hold:data.listings_on_hold,listings_to_confirm:data.listings_to_confirm,buy_orders:data.buy_orders}).then(function(response){resolve(response.data);}).catch(function(error){reject(error);});});}updateAccountData(user,contexts,wallet){return new Promise((resolve,reject)=>{user._community=null;user.session_key=null;if(contexts!==undefined){this.invcontexts=Object.keys(contexts);}this.axios.post('updateAccountData',{login:global.data.username,session_key:this.xbot_session,account:user,inventoryContexts:contexts,wallet:wallet}).then(function(response){resolve(response);}).catch(function(error){reject(error);console.error('Error:',error.response.data);});});}updateInventory(appid,inventory){return new Promise((resolve,reject)=>{this.axios.post('updateInventory',{login:global.data.username,session_key:this.xbot_session,inventory:inventory,appid:appid}).catch(function(error){reject(error);console.error('Error:',error.response.data);}).then(function(data){resolve(data);});});}userdata=null;getJobs(){return new Promise((resolve,reject)=>{this.axios.post('getJobs',{login:global.data.username,session_key:this.xbot_session}).then(function(response){resolve(response.data);}).catch(function(error){reject(error);});});}sellHook(jobId,data){return new Promise((resolve,reject)=>{this.axios.post('sellItemHook/'+jobId,{login:global.data.username,session_key:this.xbot_session,data:data}).then(function(response){console.log(response.data);resolve(response.data);}).catch(function(error){reject(error);});});}sendJobResult(job,status,result){try{console.log('['+status+'] sending job result '+job.id);this.axios.post('jobResult/'+job.id,{login:global.data.username,session_key:this.xbot_session,jobId:job.id,status:status,result:result}).then(function(response){console.log(response.data);}).catch(function(e){console.error(e);});}catch(ex){console.log('Произошла ошибка при отправке статуса задания '+job.id);}}customLog(code,message){try{this.axios.post('customLog',{login:global.data.username,session_key:this.xbot_session,code:code,message:message}).then(function(response){console.log(response.data);}).catch(function(e){console.error(e);});}catch(ex){console.log(ex);console.log('Произошла ошибка при отправке лога ');}}history(result){this.axios.post('updateLatestHistory',{login:global.data.username,session_key:this.xbot_session,result:result}).then(function(response){console.log(response.data);}).catch(function(e){console.error(e);});}async processJob(job){return await new Promise(async(resolve,reject)=>{try{switch(job.type){case 1:await global.xbsteam.getItemEconomics(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name,job.context.market_name_id).catch(function(ex){console.log(ex);}).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 2:const j=await new Promise(async(resolve2,reject2)=>{resolve2(await global.sc.getUserInventory(global.xbot.userdata.steamID,job.context.appid,job.context.contextid,false,function(e,inv,currency){if(e){reject2(e);return;}resolve2(inv);}));}).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 3:if(job.context.analyze===true){const data=await global.xbsteam.getItemOrderBookWM(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name,job.context.market_name_id);var hook=this.sellHook(job.id,data);if(hook.price!==undefined&&hook.price>0){job.context.price=hook.price;}}await global.xbsteam.sellItem(job.context.appid,job.context.contextid,job.context.assetid,job.context.amount,job.context.price).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 4:await global.xbsteam.cancelSellListing(job.context.listingId).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 5:await global.xbsteam.createBuyOrder(job.context.currency,job.context.appid,job.context.market_hash_name,job.context.price_total,job.context.quantity,job.context.billing_state,job.context.save_my_address).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 6:await global.xbsteam.cancelBuyOrder(job.context.orderId).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){global.xbot.sendJobResult(job,'false',e);});break;case 7:await global.xbsteam.getItemPriceHistory(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name).then(function(r){global.xbot.sendJobResult(job,'true',{priceHistory:r});}).catch(function(e){global.xbot.sendJobResult(job,'false',e);});break;case 8:await global.xbsteam.getItemOrderBookWM(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name,job.context.market_name_id).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){global.xbot.sendJobResult(job,'false',e);});break;case 9:await global.xbsteam.getItemMarketNameId(job.context.appid,job.context.market_hash_name).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 10:await global.xbsteam.getMarketHistory(job.context.offset,job.context.limit).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;default:console.log('unknown job type');new Error('Unknown job type');break;}}catch(ex){this.sendJobResult(job,false,null);console.log(ex);global.sc.wait();console.log('Произошла ошибка при обработке задания #'+job.id);}resolve();});}async processInventory(){return await new Promise(async(resolve,reject)=>{console.log(this.prefix+'Обновляю инвентарь');await global.sc.wait();const arr=await global.xbsteam.getInventoryContexts(global.sc.steamID);const data=arr[0];const wallet=arr[1];global.xbot.updateAccountData(global.xbot.userdata,data,wallet);const invcontexts=Object.keys(data);for(const invc of invcontexts){await new Promise(async(resolve2,reject2)=>{await global.sc.wait();global.sc.getUserInventory(global.xbot.userdata.steamID,invc,2,false,function(e,inv,currency){if(e){reject2(e);return;}global.xbot.updateInventory(invc,inv);resolve2(data);});}).catch(function(e){console.log(e);}).then(function(data){console.log(global.xbot.prefix+invc+' updated');});}resolve();});}loop(tickCounter){return new Promise(async(resolve,reject)=>{try{if(!this.xbot_loggedIn){console.log(this.prefix+'Попытка авторизации');await this.auth().catch(await function(e){return new Promise(async resolve2=>{console.log('Ошибка авторизации. Проверьте API ключ');await new Promise(resolve2=>setTimeout(resolve,global.data.tickDelay*2));resolve2();});});if(this.xbot_loggedIn){console.log(this.prefix+'Обновляю данные пользователя');await global.sc.wait();await global.sc.getSteamUser(sc.steamID,(err,user)=>{if(err){console.error('steam: Ошибка при получении информации о пользователе:',err);this.xbot_loggedIn=false;}else{user.steamID64=user.steamID.getSteamID64();global.xbot.userdata=user;}}).catch(function(err){console.error('steam: Ошибка при получении информации о пользователе:',err);});}}if(this.xbot_loggedIn&&global.xbot.userdata!==null){if(tickCounter%global.data.ticks.checkConfirmations==0){console.log(this.prefix+'Проверяю аутентификатор');await global.xbsteam.confirmAllMarketTransactions();await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}let authkey=SteamTotp.getAuthCode(global.data.sharedSecret);if(tickCounter%global.data.ticks.ping==0||this.lastsentauthkey!==authkey){await this.ping(authkey);}if(tickCounter%global.data.ticks.sendInventory==0||tickCounter==2){await this.processInventory();}if(tickCounter%global.data.ticks.sendOrders==0||tickCounter==2){console.log(this.prefix+'Проверяю ордера');await global.sc.wait();await global.xbsteam.getOrders().then(function(data){global.xbot.updateOrdersAndListings(data);});await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}if(tickCounter%global.data.ticks.lastHistory==0||tickCounter==2){console.log(this.prefix+'Обновляю историю операций');var a=await global.xbsteam.getMarketHistory(0,100);this.history(a);await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}const jobsResponse=await this.getJobs();const jobs=jobsResponse.jobs;console.log(this.prefix+'Получено '+jobs.length+' заданий');for(const job of jobs){await this.processJob(job);}await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));resolve();}catch(ex){console.log(ex);reject(ex);await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*25));}});}};