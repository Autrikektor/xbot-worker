(function(_0x1c2b66,_0x343def){const _0x2b4c89={_0x11c40d:0x455,_0x5dcb10:0x45d,_0xc877ca:0x451,_0x4e0f08:0x33,_0x33346d:0x33,_0x2f4c72:0x38,_0x2a8c0a:0x37,_0x17bbaf:0x452,_0x22792f:0x458,_0x58e970:0x453,_0x28a459:0x452,_0x314de1:0x36,_0x39edea:0x31,_0x119362:0x30,_0x26bcf6:0x44f,_0x3e24a9:0x463,_0x9bdb7c:0x27,_0x42f759:0x32,_0x47c464:0x39,_0x44201c:0x462,_0x180201:0x46b,_0x67d299:0x45b,_0x21dd8e:0x463,_0x3fdbf2:0x460,_0xde9e07:0x464,_0x6c6f7c:0x46c},_0x3fdbbf={_0x5e4042:0x391},_0x5ab2b6={_0x3e3bc3:0xa1},_0x5c9c67=_0x1c2b66();function _0x5082d4(_0x2042fd,_0x32277d,_0x16f221,_0x1d190a){return _0x59af(_0x2042fd- -_0x5ab2b6._0x3e3bc3,_0x1d190a);}function _0x526361(_0x1dd30a,_0x14c32a,_0x99c479,_0x4bdb15){return _0x59af(_0x1dd30a-_0x3fdbbf._0x5e4042,_0x99c479);}while(!![]){try{const _0x31ccc0=-parseInt(_0x526361(_0x2b4c89._0x11c40d,_0x2b4c89._0x5dcb10,0x458,_0x2b4c89._0xc877ca))/(0x53*-0x1c+-0x18e5+0x21fa)+parseInt(_0x5082d4(_0x2b4c89._0x4e0f08,_0x2b4c89._0x33346d,_0x2b4c89._0x2f4c72,_0x2b4c89._0x2a8c0a))/(-0xa34+0x11*0xf1+-0x5cb)+-parseInt(_0x526361(_0x2b4c89._0x17bbaf,_0x2b4c89._0x22792f,_0x2b4c89._0x58e970,_0x2b4c89._0x28a459))/(0x1*-0xa11+-0x1031+-0x1a45*-0x1)*(-parseInt(_0x5082d4(_0x2b4c89._0x314de1,0x41,_0x2b4c89._0x39edea,_0x2b4c89._0x119362))/(-0x22f*-0x5+-0x18*-0xd7+-0x1f0f))+-parseInt(_0x526361(0x45b,_0x2b4c89._0x26bcf6,_0x2b4c89._0x3e24a9,0x467))/(0x15a8+0x1*-0x10ed+-0x2*0x25b)+parseInt(_0x5082d4(0x31,_0x2b4c89._0x9bdb7c,_0x2b4c89._0x42f759,_0x2b4c89._0x47c464))/(-0xe4e+0x118+0x79*0x1c)+-parseInt(_0x526361(_0x2b4c89._0x44201c,_0x2b4c89._0x180201,_0x2b4c89._0x67d299,_0x2b4c89._0x3e24a9))/(0x4*0x7e1+0xf*-0x1d1+-0x16a*0x3)*(parseInt(_0x526361(0x45e,0x45a,_0x2b4c89._0x21dd8e,0x462))/(-0xc9a+0x1*-0x1127+0x1dc9))+parseInt(_0x526361(_0x2b4c89._0x3fdbf2,_0x2b4c89._0xde9e07,_0x2b4c89._0x6c6f7c,_0x2b4c89._0x5dcb10))/(0x5*0x13a+0x74*-0x4c+0x1c57);if(_0x31ccc0===_0x343def)break;else _0x5c9c67['push'](_0x5c9c67['shift']());}catch(_0x36c750){_0x5c9c67['push'](_0x5c9c67['shift']());}}}(_0x37bd,-0x2b63*0x9+0x147e5+-0x36e29*-0x1));const _0xb47a48=(function(){const _0x446274={_0x45baa8:0x3d,_0x4c24fa:0x35},_0x42d449={_0x4a2455:0x93};function _0x3302f5(_0x286e4a,_0x4173a5,_0x3820e9,_0xa6d69d){return _0x59af(_0xa6d69d- -_0x42d449._0x4a2455,_0x286e4a);}const _0x5d648f={};_0x5d648f[_0x3302f5(_0x446274._0x45baa8,0x38,_0x446274._0x4c24fa,0x33)]=function(_0x549922,_0x443e81){return _0x549922!==_0x443e81;};const _0x730b9f=_0x5d648f;let _0x5a9a10=!![];return function(_0x47400a,_0x3367f4){const _0x2eef58={_0x28fdb2:0xe6,_0x464656:0xd2,_0x56e59f:0x1e,_0xe1356c:0xdf,_0x2a9291:0xec,_0x5910cc:0xd7,_0x4a59db:0xe5,_0x173dee:0xdb,_0x176297:0xcf},_0x4f6026={_0x21df58:0x1a4},_0x43659a=_0x5a9a10?function(){const _0xd167c9={_0x581ec6:0xab};function _0x4598c7(_0x2cc185,_0x5ab34a,_0x252749,_0x345554){return _0x59af(_0x345554- -_0xd167c9._0x581ec6,_0x2cc185);}function _0x551c1f(_0x118686,_0x28198f,_0x37f552,_0x2c9c30){return _0x59af(_0x28198f- -_0x4f6026._0x21df58,_0x118686);}if(_0x730b9f[_0x551c1f(-_0x2eef58._0x28fdb2,-0xde,-0xe6,-_0x2eef58._0x464656)](_0x4598c7(_0x2eef58._0x56e59f,0x35,0x30,0x2b),_0x551c1f(-_0x2eef58._0xe1356c,-0xe4,-_0x2eef58._0x2a9291,-_0x2eef58._0x5910cc))){if(_0x3367f4){const _0x3562ff=_0x3367f4[_0x551c1f(-_0x2eef58._0x4a59db,-_0x2eef58._0x173dee,-0xd1,-_0x2eef58._0x176297)](_0x47400a,arguments);return _0x3367f4=null,_0x3562ff;}}else{if(_0x2bca45){_0xaa4e05.error('steam: Ошибка при получении информации о пользователе:',_0x228cd1);this.xbot_loggedIn=false;}else{_0x43ed9e.steamID64=_0x16c298.steamID.getSteamID64();_0x1a4158.xbot.userdata=_0x4e2d64;}}}:function(){};return _0x5a9a10=![],_0x43659a;};}()),_0xfd58d3=_0xb47a48(this,function(){const _0xc275b2={_0x125cea:0x19d,_0x46e6f8:0x194,_0x205638:0x193,_0x3dc2d6:0x199,_0x26de45:0x198,_0x4e4767:0x1ad,_0x2471b1:0x1a4,_0x45db6c:0x1a2,_0x47354b:0x18f,_0x17bef0:0x197,_0x12c682:0x18f,_0x74a07:0x313,_0x41890b:0x307,_0x496247:0x305,_0x4ca567:0x2f8,_0x523add:0x19f,_0x7bc4f5:0x1a4,_0x56f0f1:0x1a6},_0x48ffdc={_0x91888:0xd4};function _0xb2c7be(_0x1c24ca,_0x5dda1d,_0x572650,_0xc2b17b){return _0x59af(_0x1c24ca-0x242,_0x572650);}const _0x257d0f={};_0x257d0f['sZsMf']='(((.+)+)+)'+'+$';const _0x219f95=_0x257d0f;function _0x587b21(_0xc585a7,_0x42ab6b,_0x41426d,_0x17be46){return _0x59af(_0x41426d-_0x48ffdc._0x91888,_0xc585a7);}return _0xfd58d3[_0x587b21(_0xc275b2._0x125cea,_0xc275b2._0x46e6f8,_0xc275b2._0x205638,_0xc275b2._0x3dc2d6)]()['search'](_0x219f95[_0x587b21(_0xc275b2._0x26de45,_0xc275b2._0x4e4767,_0xc275b2._0x2471b1,_0xc275b2._0x45db6c)])[_0x587b21(_0xc275b2._0x47354b,_0xc275b2._0x17bef0,0x193,_0xc275b2._0x12c682)]()[_0xb2c7be(0x30d,_0xc275b2._0x74a07,0x314,_0xc275b2._0x41890b)+'r'](_0xfd58d3)[_0xb2c7be(_0xc275b2._0x496247,_0xc275b2._0x4ca567,0x307,0x308)](_0x219f95[_0x587b21(_0xc275b2._0x523add,0x1a9,_0xc275b2._0x7bc4f5,_0xc275b2._0x56f0f1)]);});_0xfd58d3();const axios=require(_0x2e2d4d(0x2cb,0x2d0,0x2c8,0x2bf)),https=require(_0x2e2d4d(0x2c8,0x2cd,0x2cf,0x2c6)),SteamTotp=require(_0x6e0d8(-0x15a,-0x171,-0x165,-0x15d));function _0x2e2d4d(_0x494240,_0x9a4939,_0x59c52e,_0x2cea81){const _0x16a9c7={_0x1740e5:0x206};return _0x59af(_0x494240-_0x16a9c7._0x1740e5,_0x59c52e);}const xbsteam=require(_0x2e2d4d(0x2db,0x2cf,0x2d8,0x2d6));function _0x6e0d8(_0x54bae7,_0x1bfbf6,_0x32b8c5,_0x574f0c){const _0x284e4d={_0x3c1d29:0x231};return _0x59af(_0x32b8c5- -_0x284e4d._0x3c1d29,_0x1bfbf6);}const _0x441e35={};function _0x37bd(){const _0x39b1df=['mJC5oty0qvzHA05u','yxHPB3m','s2XRD2G','CMvQzwn0vw5HDq','qwDLBNq','yxbWBhK','ntG1odC1uxvvren6','y29UC3rYDwn0BW','C3rLyw0TDg90Ca','nty2mJy0u2DfAuHi','zxHWB3j0CW','mtmYmduYnxr3uwn4va','C1PZtwy','mtrvCeHit2u','mtC4mZC4mKDzshDyza','DgHVCML6zwq','mJuXmtyYsgX0Au9N','lI9ZDgvHBq','BhHfze4','nZeXntu2wwnvAvvJ','Dg9tDhjPBMC','DMrpAu0','m3r4wgXiEa','Ahr0Chm','C2vHCMnO'];_0x37bd=function(){return _0x39b1df;};return _0x37bd();}_0x441e35[_0x2e2d4d(0x2cd,0x2c8,0x2c1,0x2ca)+_0x2e2d4d(0x2d9,0x2ce,0x2e2,0x2d6)]=![];function _0x59af(_0x5e91c9,_0x4eeb0a){const _0x24b75c=_0x37bd();return _0x59af=function(_0x50cd6c,_0x114555){_0x50cd6c=_0x50cd6c-(-0x752*-0x2+-0x24e0+0x16fb*0x1);let _0x46ccbd=_0x24b75c[_0x50cd6c];if(_0x59af['YxxrpL']===undefined){var _0x146c40=function(_0x57d9e3){const _0x31d965='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x4f2d1b='',_0x371b7c='',_0x205be8=_0x4f2d1b+_0x146c40;for(let _0x25d290=-0x1c*-0xce+-0x7bc+0x4*-0x3b3,_0x449a7a,_0x3009bf,_0x239799=-0x1b84+0x33e+0x2*0xc23;_0x3009bf=_0x57d9e3['charAt'](_0x239799++);~_0x3009bf&&(_0x449a7a=_0x25d290%(-0x3*-0x5d+0x1346+-0x1459)?_0x449a7a*(0x4*0x1f1+0x18ba+-0x203e)+_0x3009bf:_0x3009bf,_0x25d290++%(0xa27*-0x1+0xead+0x241*-0x2))?_0x4f2d1b+=_0x205be8['charCodeAt'](_0x239799+(-0x3c*0x7+0xa3*0x27+0x1727*-0x1))-(-0x193a+-0xe4a+0xa6*0x3d)!==-0x1*0x15bc+0x1a14+-0x8*0x8b?String['fromCharCode'](0xfd*0x1+0x2d7*0x5+0x1*-0xe31&_0x449a7a>>(-(0x11*0x95+0x1b57+-0x253a)*_0x25d290&-0x11fd+-0x18c7+0x2aca)):_0x25d290:0xe88+0x1*-0x2513+0x168b){_0x3009bf=_0x31d965['indexOf'](_0x3009bf);}for(let _0x48c3b0=0x1f08+-0x621+0x11*-0x177,_0x16c475=_0x4f2d1b['length'];_0x48c3b0<_0x16c475;_0x48c3b0++){_0x371b7c+='%'+('00'+_0x4f2d1b['charCodeAt'](_0x48c3b0)['toString'](0x1*0x2135+-0x39*-0x52+-0x3367))['slice'](-(-0x23a1+-0x9f6*0x3+0x4185));}return decodeURIComponent(_0x371b7c);};_0x59af['FENXWY']=_0x146c40,_0x5e91c9=arguments,_0x59af['YxxrpL']=!![];}const _0x1e8560=_0x24b75c[-0x87c+0x1275+-0x9f9],_0x3eba9b=_0x50cd6c+_0x1e8560,_0x4d44a0=_0x5e91c9[_0x3eba9b];if(!_0x4d44a0){const _0x28e1de=function(_0x3fa373){this['NRfziS']=_0x3fa373,this['zUQzPE']=[-0x396*0x3+0x42d+0x3*0x232,0x119*-0xf+0x2647+-0x15d0,-0x1*0x6b+0xc8*0x32+-0x26a5],this['KTbODt']=function(){return'newState';},this['UzBNlr']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['yrkqhk']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x28e1de['prototype']['udkGPZ']=function(){const _0x46cfb0=new RegExp(this['UzBNlr']+this['yrkqhk']),_0x551683=_0x46cfb0['test'](this['KTbODt']['toString']())?--this['zUQzPE'][-0x1ffe+-0x31c*0xb+0x3f*0x10d]:--this['zUQzPE'][0x1*-0x18a6+0x52f+0x3*0x67d];return this['bnJxeU'](_0x551683);},_0x28e1de['prototype']['bnJxeU']=function(_0x38febc){if(!Boolean(~_0x38febc))return _0x38febc;return this['pfmiSQ'](this['NRfziS']);},_0x28e1de['prototype']['pfmiSQ']=function(_0x5e3a98){for(let _0x42d5cb=0x1f7e+0x1da3*0x1+0x3d21*-0x1,_0x36b8e8=this['zUQzPE']['length'];_0x42d5cb<_0x36b8e8;_0x42d5cb++){this['zUQzPE']['push'](Math['round'](Math['random']())),_0x36b8e8=this['zUQzPE']['length'];}return _0x5e3a98(this['zUQzPE'][-0x7f*0x13+-0x984+0x12f1]);},new _0x28e1de(_0x59af)['udkGPZ'](),_0x46ccbd=_0x59af['FENXWY'](_0x46ccbd),_0x5e91c9[_0x3eba9b]=_0x46ccbd;}else _0x46ccbd=_0x4d44a0;return _0x46ccbd;},_0x59af(_0x5e91c9,_0x4eeb0a);}const httpsAgent=new https[(_0x6e0d8(-0x163,-0x162,-0x169,-0x166))](_0x441e35);module[_0x2e2d4d(0x2d4,0x2cd,0x2de,0x2d9)]=class xbot{xbot_apiurl=global.xbot_apiurl;prefix='[xbot.gg] ';axiosconfig={httpsAgent:httpsAgent,withCredentials:true,baseURL:this.xbot_apiurl,timeout:10000,headers:{'Authorization':`Bearer ${global.data.apiKey}`,'Accept':'application/json','X-Requested-With':'XMLHttpRequest','X-Bot-Version':global.data.version}};axios=null;xbot_session=null;axios=axios.create(this.axiosconfig);auth(){return new Promise((resolve,reject)=>{this.axios.post('auth',{login:global.data.username}).then(function(response){global.xbot.xbot_session=response.data.session_key;if(response.data.status==0){global.xbot.xbot_loggedIn=true;}resolve(response.data.session_key);console.log(global.xbot.prefix+'Успешно авторизован');}).catch(function(error){reject(error);});});}xbot_loggedIn=false;lastsentauthkey='';async ping(authkey){return await new Promise(async(resolve,reject)=>{this.lastsentauthkey=authkey;this.axios.post('ping',{login:global.data.username,session_key:global.xbot.xbot_session,authkey:authkey}).then(function(response){resolve(response);}).catch(async function(error){global.xbot.xbot_loggedIn=false;console.error('Error:',error);reject(error);});});}invcontexts=[];updateOrdersAndListings(data){return new Promise((resolve,reject)=>{this.axios.post('updateOrdersAndListings',{login:global.data.username,session_key:global.xbot.xbot_session,listings:data.listings,listings_on_hold:data.listings_on_hold,listings_to_confirm:data.listings_to_confirm,buy_orders:data.buy_orders}).then(function(response){resolve(response.data);}).catch(function(error){reject(error);});});}updateAccountData(user,contexts,wallet){return new Promise((resolve,reject)=>{user._community=null;user.session_key=null;if(contexts!==undefined){this.invcontexts=Object.keys(contexts);}this.axios.post('updateAccountData',{login:global.data.username,session_key:this.xbot_session,account:user,inventoryContexts:contexts,wallet:wallet}).then(function(response){resolve(response);}).catch(function(error){reject(error);console.error('Error:',error.response.data);});});}updateInventory(appid,inventory){return new Promise((resolve,reject)=>{this.axios.post('updateInventory',{login:global.data.username,session_key:this.xbot_session,inventory:inventory,appid:appid}).catch(function(error){reject(error);console.error('Error:',error.response.data);}).then(function(data){resolve(data);});});}userdata=null;getJobs(){return new Promise((resolve,reject)=>{this.axios.post('getJobs',{login:global.data.username,session_key:this.xbot_session}).then(function(response){resolve(response.data);}).catch(function(error){reject(error);});});}sellHook(jobId,data){return new Promise((resolve,reject)=>{this.axios.post('sellItemHook/'+jobId,{login:global.data.username,session_key:this.xbot_session,data:data}).then(function(response){console.log(response.data);resolve(response.data);}).catch(function(error){reject(error);});});}sendJobResult(job,status,result){try{console.log('['+status+'] sending job result '+job.id);this.axios.post('jobResult/'+job.id,{login:global.data.username,session_key:this.xbot_session,jobId:job.id,status:status,result:result}).then(function(response){console.log(response.data);}).catch(function(e){console.error(e);});}catch(ex){console.log('Произошла ошибка при отправке статуса задания '+job.id);}}customLog(code,message){try{this.axios.post('customLog',{login:global.data.username,session_key:this.xbot_session,code:code,message:message}).then(function(response){console.log(response.data);}).catch(function(e){console.error(e);});}catch(ex){console.log(ex);console.log('Произошла ошибка при отправке лога ');}}history(result){this.axios.post('updateLatestHistory',{login:global.data.username,session_key:this.xbot_session,result:result}).then(function(response){console.log(response.data);}).catch(function(e){console.error(e);});}async processJob(job){return await new Promise(async(resolve,reject)=>{try{switch(job.type){case 1:await global.xbsteam.getItemEconomics(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name,job.context.market_name_id).catch(function(ex){console.log(ex);}).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 2:const j=await new Promise(async(resolve2,reject2)=>{resolve2(await global.sc.getUserInventory(global.xbot.userdata.steamID,job.context.appid,job.context.contextid,false,function(e,inv,currency){if(e){reject2(e);return;}resolve2(inv);}));}).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 3:if(job.context.analyze===true){const data=await global.xbsteam.getItemOrderBookWM(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name,job.context.market_name_id);var hook=this.sellHook(job.id,data);if(hook.price!==undefined&&hook.price>0){job.context.price=hook.price;}}await global.xbsteam.sellItem(job.context.appid,job.context.contextid,job.context.assetid,job.context.amount,job.context.price).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 4:await global.xbsteam.cancelSellListing(job.context.listingId).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 5:await global.xbsteam.createBuyOrder(job.context.currency,job.context.appid,job.context.market_hash_name,job.context.price_total,job.context.quantity,job.context.billing_state,job.context.save_my_address).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 6:await global.xbsteam.cancelBuyOrder(job.context.orderId).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){global.xbot.sendJobResult(job,'false',e);});break;case 7:await global.xbsteam.getItemPriceHistory(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name).then(function(r){global.xbot.sendJobResult(job,'true',{priceHistory:r});}).catch(function(e){global.xbot.sendJobResult(job,'false',e);});break;case 8:await global.xbsteam.getItemOrderBookWM(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name,job.context.market_name_id).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){global.xbot.sendJobResult(job,'false',e);});break;case 9:await global.xbsteam.getItemMarketNameId(job.context.appid,job.context.market_hash_name).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 10:await global.xbsteam.getMarketHistory(job.context.offset,job.context.limit).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;default:console.log('unknown job type');new Error('Unknown job type');break;}}catch(ex){this.sendJobResult(job,false,null);console.log(ex);global.sc.wait();console.log('Произошла ошибка при обработке задания #'+job.id);}resolve();});}async processInventory(){return await new Promise(async(resolve,reject)=>{console.log(this.prefix+'Обновляю инвентарь');await global.sc.wait();const arr=await global.xbsteam.getInventoryContexts(global.sc.steamID);const data=arr[0];const wallet=arr[1];global.xbot.updateAccountData(global.xbot.userdata,data,wallet);const invcontexts=Object.keys(data);for(const invc of invcontexts){await new Promise(async(resolve2,reject2)=>{await global.sc.wait();global.sc.getUserInventory(global.xbot.userdata.steamID,invc,2,false,function(e,inv,currency){if(e){reject2(e);return;}global.xbot.updateInventory(invc,inv);resolve2(data);});}).catch(function(e){console.log(e);}).then(function(data){console.log(global.xbot.prefix+invc+' updated');});}resolve();});}loop(tickCounter){return new Promise(async(resolve,reject)=>{try{if(!this.xbot_loggedIn){console.log(this.prefix+'Попытка авторизации');await this.auth().catch(await function(e){return new Promise(async resolve2=>{console.log('Ошибка авторизации. Проверьте API ключ');await new Promise(resolve2=>setTimeout(resolve,global.data.tickDelay*2));resolve2();});});if(this.xbot_loggedIn){console.log(this.prefix+'Обновляю данные пользователя');await global.sc.wait();await global.sc.getSteamUser(sc.steamID,(err,user)=>{if(err){console.error('steam: Ошибка при получении информации о пользователе:',err);this.xbot_loggedIn=false;}else{user.steamID64=user.steamID.getSteamID64();global.xbot.userdata=user;}}).catch(function(err){console.error('steam: Ошибка при получении информации о пользователе:',err);});}}if(this.xbot_loggedIn&&global.xbot.userdata!==null){if(tickCounter%global.data.ticks.checkConfirmations==0){console.log(this.prefix+'Проверяю аутентификатор');await global.xbsteam.confirmAllMarketTransactions();await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}let authkey=SteamTotp.getAuthCode(global.data.sharedSecret);if(tickCounter%global.data.ticks.ping==0||this.lastsentauthkey!==authkey){await this.ping(authkey);}if(tickCounter%global.data.ticks.sendInventory==0||tickCounter==2){await this.processInventory();}if(tickCounter%global.data.ticks.sendOrders==0||tickCounter==2){console.log(this.prefix+'Проверяю ордера');await global.sc.wait();await global.xbsteam.getOrders().then(function(data){global.xbot.updateOrdersAndListings(data);});await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}if(tickCounter%global.data.ticks.lastHistory==0||tickCounter==2){console.log(this.prefix+'Обновляю историю операций');var a=await global.xbsteam.getMarketHistory(0,100);this.history(a);await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}const jobsResponse=await this.getJobs();const jobs=jobsResponse.jobs;console.log(this.prefix+'Получено '+jobs.length+' заданий');for(const job of jobs){await this.processJob(job);}await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));resolve();}catch(ex){console.log(ex);reject(ex);await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*25));}});}};