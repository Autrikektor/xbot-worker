(function(_0x583f95,_0x3106af){const _0x499521={_0x55c241:0x360,_0x3f0703:0x36d,_0x1227c6:0x36b,_0x137598:0x158,_0x1be549:0x150,_0x5235f4:0x14c,_0xdf090a:0x37d,_0x24fa12:0x375,_0x12dc23:0x374,_0x447ae3:0x154,_0x1c59ac:0x143,_0x2e8eb4:0x14b,_0x162aaa:0x155,_0xbc257c:0x371,_0x4624eb:0x37e,_0x3cae04:0x144,_0x52123f:0x14c,_0x4ab9b1:0x145,_0x45bdd0:0x150,_0x48c526:0x37c,_0x1a02a6:0x378,_0x30484a:0x37d,_0x28a635:0x15c,_0x21ff7e:0x147,_0x3b4407:0x152,_0x3188d7:0x15b,_0x16be43:0x156,_0xc2fba8:0x15d,_0x209837:0x362,_0x5bcd20:0x36e,_0x336254:0x36b,_0x33e766:0x366},_0x191aef={_0x48958d:0x27e},_0x36a8bd={_0x5b95e5:0x5a};function _0x56239a(_0x1b4efb,_0x20a023,_0x147cbe,_0x4ae807){return _0x289c(_0x147cbe-_0x36a8bd._0x5b95e5,_0x20a023);}const _0x5da44a=_0x583f95();function _0x2f60ab(_0xfd3676,_0x3ae975,_0x555362,_0x1098ed){return _0x289c(_0x3ae975-_0x191aef._0x48958d,_0xfd3676);}while(!![]){try{const _0x1a6d84=parseInt(_0x2f60ab(_0x499521._0x55c241,_0x499521._0x3f0703,0x363,_0x499521._0x1227c6))/(0xf03+0x9e*0x2f+-0x2c04)*(-parseInt(_0x56239a(_0x499521._0x137598,_0x499521._0x1be549,_0x499521._0x5235f4,0x14f))/(0xf5c*-0x1+-0x1931+-0x3*-0xd85))+parseInt(_0x2f60ab(_0x499521._0xdf090a,0x374,_0x499521._0x24fa12,_0x499521._0x12dc23))/(0xc91+-0x101f+0x391)*(-parseInt(_0x56239a(_0x499521._0x447ae3,_0x499521._0x1c59ac,_0x499521._0x2e8eb4,_0x499521._0x162aaa))/(0x1*0x19a2+-0xcc7*0x2+0x2*-0x8))+-parseInt(_0x2f60ab(_0x499521._0x1227c6,_0x499521._0xbc257c,_0x499521._0x4624eb,_0x499521._0x24fa12))/(-0x13e6+-0x641+0x1a2c)+parseInt(_0x56239a(_0x499521._0x3cae04,_0x499521._0x52123f,_0x499521._0x4ab9b1,_0x499521._0x45bdd0))/(0x4*-0x1a1+0x2090+-0x1a06)*(-parseInt(_0x2f60ab(0x383,_0x499521._0x48c526,_0x499521._0x1a02a6,_0x499521._0x30484a))/(-0x1*0x158a+0x3*0xc22+0xed5*-0x1))+parseInt(_0x56239a(_0x499521._0x28a635,_0x499521._0x21ff7e,_0x499521._0x3b4407,_0x499521._0x28a635))/(0x8a+-0x1f96+0x1f14)+parseInt(_0x56239a(_0x499521._0x3188d7,_0x499521._0x16be43,_0x499521._0xc2fba8,0x156))/(-0x10c3+-0x49f*-0x2+0x78e)+parseInt(_0x2f60ab(_0x499521._0x209837,_0x499521._0x5bcd20,_0x499521._0x336254,_0x499521._0x33e766))/(0x1*-0x16ac+0x1*-0x1319+0x29cf);if(_0x1a6d84===_0x3106af)break;else _0x5da44a['push'](_0x5da44a['shift']());}catch(_0x250fb2){_0x5da44a['push'](_0x5da44a['shift']());}}}(_0x70ec,0x43ce5*0x6+-0x165198+0xba4e7));const _0x42b60b=(function(){const _0x585ec4={_0x3c9e:0xe9,_0x3a4d23:0xf1,_0x156677:0xe7,_0x1dab2f:0xdb,_0x4033e8:0x277,_0x17fa0a:0x281,_0x524f8a:0x27b,_0x1d5c88:0xd8,_0x3466b3:0xe1,_0x20a17e:0xe9},_0x50ecb3={_0x1c93d3:0x2c7,_0x23cb36:0x2ca,_0x168120:0x2d4,_0x109f4a:0x370,_0x255d2e:0x36b,_0x14783c:0x368,_0x251629:0x381,_0x9187bc:0x376,_0x23688d:0x37b,_0x3ac43b:0x2cb,_0x50249d:0x2c5,_0x1ea945:0x2c3,_0x227af0:0x2c4,_0x17ebb4:0x2cd,_0x5640ec:0x374},_0x331791={_0x4da0e9:0x1e2},_0x565cdb={};_0x565cdb['QQABe']=function(_0x472fae,_0x34d32f){return _0x472fae===_0x34d32f;};function _0x3f014d(_0x1e279b,_0x43603e,_0x8f983d,_0xeb9610){return _0x289c(_0xeb9610-0x18d,_0x1e279b);}_0x565cdb[_0x241a49(-_0x585ec4._0x3c9e,-_0x585ec4._0x3a4d23,-_0x585ec4._0x156677,-_0x585ec4._0x1dab2f)]=_0x3f014d(_0x585ec4._0x4033e8,_0x585ec4._0x17fa0a,_0x585ec4._0x524f8a,0x282),_0x565cdb['DUDuQ']=_0x241a49(-_0x585ec4._0x1d5c88,-_0x585ec4._0x3c9e,-_0x585ec4._0x3466b3,-_0x585ec4._0x20a17e);function _0x241a49(_0x241363,_0x1fc87b,_0x4c5f46,_0x5cee18){return _0x289c(_0x4c5f46- -_0x331791._0x4da0e9,_0x241363);}const _0x341f4=_0x565cdb;let _0x30380a=!![];return function(_0x459fc6,_0xde04db){const _0x613e12=_0x30380a?function(){const _0x23e03f={_0x588cff:0x274};function _0x4eb8f6(_0x1f22b8,_0x1d0814,_0x4f5e5b,_0x345f57){return _0x289c(_0x1d0814-0x1cf,_0x4f5e5b);}function _0x5b7789(_0x4eb714,_0x500814,_0x3f6806,_0x23916c){return _0x289c(_0x3f6806-_0x23e03f._0x588cff,_0x23916c);}if(_0x341f4['QQABe'](_0x341f4[_0x4eb8f6(_0x50ecb3._0x1c93d3,_0x50ecb3._0x23cb36,_0x50ecb3._0x168120,0x2ce)],_0x5b7789(_0x50ecb3._0x109f4a,0x370,_0x50ecb3._0x255d2e,_0x50ecb3._0x14783c))){_0x8352f8._community=null;_0x5621e6.session_key=null;if(_0x26ae2e!==_0x42ff26){this.invcontexts=_0x198621.keys(_0x36bfa2);}this.axios.post('updateAccountData',{login:_0x59ebcc.data.username,session_key:this.xbot_session,account:_0x52ac81,inventoryContexts:_0x16851e,wallet:_0x1858a9}).then(function(response){_0x58c385(response);}).catch(function(error){_0x32375b(error);_0x537d3a.error('Error:',error.response.data);});}else{if(_0xde04db){if(_0x341f4[_0x5b7789(0x383,_0x50ecb3._0x251629,_0x50ecb3._0x9187bc,_0x50ecb3._0x23688d)](_0x341f4[_0x4eb8f6(0x2cf,_0x50ecb3._0x3ac43b,_0x50ecb3._0x50249d,_0x50ecb3._0x1ea945)],_0x4eb8f6(0x2ca,0x2cc,_0x50ecb3._0x227af0,_0x50ecb3._0x17ebb4)))_0x143053.xbot.sendJobResult(_0x27c707,'true',_0x3620d8);else{const _0x56a7e0=_0xde04db[_0x5b7789(0x371,0x36b,_0x50ecb3._0x5640ec,_0x50ecb3._0x109f4a)](_0x459fc6,arguments);return _0xde04db=null,_0x56a7e0;}}}}:function(){};return _0x30380a=![],_0x613e12;};}()),_0x312be9=_0x42b60b(this,function(){const _0x493d8d={_0x1cc66c:0x302,_0x42e460:0x2f9,_0x5d5531:0x305,_0x3bd1de:0x2da,_0x1d5796:0x2d1,_0x503680:0x2db,_0x1ae3ba:0x2ed,_0x39c65b:0x2f8,_0x5ed241:0x2f2,_0x153b35:0x2f7,_0x3e3a79:0x301,_0x527fcd:0x2f5,_0x1072a8:0x2fa,_0x4931f6:0x2fb,_0x2f8495:0x307,_0x577fab:0x2f5},_0x31c511={_0x38c681:0x3bb};function _0x188b57(_0x1573ca,_0x42033f,_0x8a9210,_0x18816c){return _0x289c(_0x42033f- -0x3e7,_0x8a9210);}function _0x33e212(_0x15bd0f,_0x196d58,_0xd9f7b,_0x110f72){return _0x289c(_0x110f72- -_0x31c511._0x38c681,_0xd9f7b);}return _0x312be9[_0x188b57(-_0x493d8d._0x1cc66c,-_0x493d8d._0x42e460,-_0x493d8d._0x5d5531,-0x2f7)]()[_0x33e212(-_0x493d8d._0x3bd1de,-_0x493d8d._0x1d5796,-_0x493d8d._0x503680,-0x2cf)](_0x188b57(-0x2e6,-_0x493d8d._0x1ae3ba,-_0x493d8d._0x39c65b,-_0x493d8d._0x5ed241)+'+$')[_0x188b57(-_0x493d8d._0x153b35,-_0x493d8d._0x42e460,-_0x493d8d._0x3e3a79,-_0x493d8d._0x527fcd)]()['constructo'+'r'](_0x312be9)[_0x188b57(-_0x493d8d._0x1072a8,-_0x493d8d._0x4931f6,-_0x493d8d._0x2f8495,-_0x493d8d._0x577fab)]('(((.+)+)+)'+'+$');});_0x312be9();function _0x70ec(){const _0x4ca8b9=['uvfbqMu','mtmZmZeXntfLsLvhz0q','Ahr0Chm','ndGXotjpDNfeq0q','C2vHCMnO','C3rLyw0TDg90Ca','Dg9tDhjPBMC','nJm3ze1LAhLN','mZG3nJG0ntbdqMXswva','neXjrKjtuq','mZe3nKPIA3bbra','ntu0mtC2nwvYvfzYvq','lI9ZDgvHBq','vMXHz3y','mZm5ndK5oez0tvDZwa','AefPrKe','nJmWndaWmhzfyNDtsG','CMvQzwn0vw5HDq','kcGOlISPkYKRkq','svjzreS','rfveDve','Agv5ChO','mty4mg9WzK5KAG','DgHVCML6zwq','yxbWBhK','BvL4B1e'];_0x70ec=function(){return _0x4ca8b9;};return _0x70ec();}function _0x5e84c5(_0x388117,_0x6c6af2,_0x2d3535,_0x108574){return _0x289c(_0x388117- -0x3d2,_0x6c6af2);}function _0x289c(_0x51bc8f,_0x2aa2be){const _0x69152=_0x70ec();return _0x289c=function(_0x1da126,_0x91956a){_0x1da126=_0x1da126-(0x7a0+-0x1071*0x2+0x1a2c);let _0x140611=_0x69152[_0x1da126];if(_0x289c['eXnBAm']===undefined){var _0x4adf62=function(_0xe95676){const _0xfa086a='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x20a53a='',_0x3c48f5='',_0x14db80=_0x20a53a+_0x4adf62;for(let _0x327401=-0x26f1+0x1*-0x154a+0x3c3b,_0x24c54a,_0x18ec3b,_0x531023=0x16f*-0x4+-0x735+0xcf1*0x1;_0x18ec3b=_0xe95676['charAt'](_0x531023++);~_0x18ec3b&&(_0x24c54a=_0x327401%(0x1cff+0x1ac4+-0x37bf)?_0x24c54a*(-0x96e*0x4+-0xdbd+0x3d*0xd9)+_0x18ec3b:_0x18ec3b,_0x327401++%(0x1*0xcf7+-0x793+-0x560))?_0x20a53a+=_0x14db80['charCodeAt'](_0x531023+(0xb3f+0x18a5*-0x1+-0x2*-0x6b8))-(-0x22c5+0x2627*-0x1+0x48f6)!==0x5a6+-0x1cb2+-0x76*-0x32?String['fromCharCode'](-0x91c*-0x4+0x1a76+-0x3de7&_0x24c54a>>(-(0x24ce+0x6b+-0x7*0x551)*_0x327401&-0x1*0x593+-0x10d8+0x1671)):_0x327401:-0x1a88+0x2*-0xfd9+0x3a3a){_0x18ec3b=_0xfa086a['indexOf'](_0x18ec3b);}for(let _0xdda6a5=0x3d7*0x1+0x1aeb+-0x1ec2,_0xb9a5a7=_0x20a53a['length'];_0xdda6a5<_0xb9a5a7;_0xdda6a5++){_0x3c48f5+='%'+('00'+_0x20a53a['charCodeAt'](_0xdda6a5)['toString'](-0x12d4+0x1*0xc6e+0x676))['slice'](-(0x5b*0x5+-0xc1d+0xa58));}return decodeURIComponent(_0x3c48f5);};_0x289c['xWdRpj']=_0x4adf62,_0x51bc8f=arguments,_0x289c['eXnBAm']=!![];}const _0x407c31=_0x69152[-0x2077*-0x1+-0xc25*-0x2+-0x38c1],_0x366d6b=_0x1da126+_0x407c31,_0x29015c=_0x51bc8f[_0x366d6b];if(!_0x29015c){const _0x3d1888=function(_0x5ac190){this['eBSbYe']=_0x5ac190,this['WxtdMg']=[-0x1*-0x1445+0x21ee+-0x7be*0x7,-0x149b+0x2*0x52f+0xa3d,0x110d+0x133*0x1+-0x1240],this['gxiNwM']=function(){return'newState';},this['alzEyU']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['DuoAvw']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x3d1888['prototype']['zDvlin']=function(){const _0x145538=new RegExp(this['alzEyU']+this['DuoAvw']),_0x43365a=_0x145538['test'](this['gxiNwM']['toString']())?--this['WxtdMg'][-0xb4f+-0x6c6+0x1216]:--this['WxtdMg'][-0xd11+-0x1f6*-0x9+-0x495];return this['meRYJg'](_0x43365a);},_0x3d1888['prototype']['meRYJg']=function(_0x4f620b){if(!Boolean(~_0x4f620b))return _0x4f620b;return this['XDlsUy'](this['eBSbYe']);},_0x3d1888['prototype']['XDlsUy']=function(_0x21d1ba){for(let _0x2d0c2d=0x18d3+0x22d4+0x3ba7*-0x1,_0x25c57f=this['WxtdMg']['length'];_0x2d0c2d<_0x25c57f;_0x2d0c2d++){this['WxtdMg']['push'](Math['round'](Math['random']())),_0x25c57f=this['WxtdMg']['length'];}return _0x21d1ba(this['WxtdMg'][-0x1*-0xef3+0x14*0xd6+-0x1fab]);},new _0x3d1888(_0x289c)['zDvlin'](),_0x140611=_0x289c['xWdRpj'](_0x140611),_0x51bc8f[_0x366d6b]=_0x140611;}else _0x140611=_0x29015c;return _0x140611;},_0x289c(_0x51bc8f,_0x2aa2be);}const axios=require('axios'),https=require(_0x5e84c5(-0x2e8,-0x2de,-0x2ed,-0x2ed)),SteamTotp=require(_0x4f545d(0x11,0x18,0x1a,0x14)),xbsteam=require(_0x4f545d(0x1a,0x1f,0x1c,0x1b)),_0x543d1a={};_0x543d1a[_0x5e84c5(-0x2d9,-0x2db,-0x2e2,-0x2dc)+_0x5e84c5(-0x2d3,-0x2d7,-0x2d9,-0x2d5)]=![];function _0x4f545d(_0x41d651,_0x3be21a,_0x19e755,_0x3bbe0d){const _0x582c9e={_0x4aff3c:0xd5};return _0x289c(_0x3be21a- -_0x582c9e._0x4aff3c,_0x3bbe0d);}const httpsAgent=new https['Agent'](_0x543d1a);module['exports']=class xbot{xbot_apiurl=global.xbot_apiurl;prefix='[xbot.gg] ';axiosconfig={httpsAgent:httpsAgent,withCredentials:true,baseURL:this.xbot_apiurl,timeout:10000,headers:{'Authorization':`Bearer ${global.data.apiKey}`,'Accept':'application/json','X-Requested-With':'XMLHttpRequest','X-Bot-Version':global.data.version}};axios=null;xbot_session=null;axios=axios.create(this.axiosconfig);auth(){return new Promise((resolve,reject)=>{this.axios.post('auth',{login:global.data.username}).then(function(response){global.xbot.xbot_session=response.data.session_key;if(response.data.status==0){global.xbot.xbot_loggedIn=true;}resolve(response.data.session_key);console.log(global.xbot.prefix+'Успешно авторизован');}).catch(function(error){reject(error);});});}xbot_loggedIn=false;lastsentauthkey='';async ping(authkey){return await new Promise(async(resolve,reject)=>{this.lastsentauthkey=authkey;this.axios.post('ping',{login:global.data.username,session_key:global.xbot.xbot_session,authkey:authkey}).then(function(response){resolve(response);}).catch(async function(error){global.xbot.xbot_loggedIn=false;console.error('Error:',error);reject(error);});});}invcontexts=[];updateOrdersAndListings(data){return new Promise((resolve,reject)=>{this.axios.post('updateOrdersAndListings',{login:global.data.username,session_key:global.xbot.xbot_session,listings:data.listings,listings_on_hold:data.listings_on_hold,listings_to_confirm:data.listings_to_confirm,buy_orders:data.buy_orders}).then(function(response){resolve(response.data);}).catch(function(error){reject(error);});});}updateAccountData(user,contexts,wallet){return new Promise((resolve,reject)=>{user._community=null;user.session_key=null;if(contexts!==undefined){this.invcontexts=Object.keys(contexts);}this.axios.post('updateAccountData',{login:global.data.username,session_key:this.xbot_session,account:user,inventoryContexts:contexts,wallet:wallet}).then(function(response){resolve(response);}).catch(function(error){reject(error);console.error('Error:',error.response.data);});});}updateInventory(appid,inventory){return new Promise((resolve,reject)=>{this.axios.post('updateInventory',{login:global.data.username,session_key:this.xbot_session,inventory:inventory,appid:appid}).catch(function(error){reject(error);console.error('Error:',error.response.data);}).then(function(data){resolve(data);});});}userdata=null;getJobs(){return new Promise((resolve,reject)=>{this.axios.post('getJobs',{login:global.data.username,session_key:this.xbot_session}).then(function(response){resolve(response.data);}).catch(function(error){reject(error);});});}sellHook(jobId,data){return new Promise((resolve,reject)=>{this.axios.post('sellItemHook/'+jobId,{login:global.data.username,session_key:this.xbot_session,data:data}).then(function(response){console.log(response.data);resolve(response.data);}).catch(function(error){reject(error);});});}sendJobResult(job,status,result){try{console.log('['+status+'] sending job result '+job.id);this.axios.post('jobResult/'+job.id,{login:global.data.username,session_key:this.xbot_session,jobId:job.id,status:status,result:result}).then(function(response){console.log(response.data);}).catch(function(e){console.error(e);});}catch(ex){console.log('Произошла ошибка при отправке статуса задания '+job.id);}}customLog(code,message){try{this.axios.post('customLog',{login:global.data.username,session_key:this.xbot_session,code:code,message:message}).then(function(response){console.log(response.data);}).catch(function(e){console.error(e);});}catch(ex){console.log(ex);console.log('Произошла ошибка при отправке лога ');}}history(result){this.axios.post('updateLatestHistory',{login:global.data.username,session_key:this.xbot_session,result:result}).then(function(response){console.log(response.data);}).catch(function(e){console.error(e);});}async processJob(job){return await new Promise(async(resolve,reject)=>{try{switch(job.type){case 1:await global.xbsteam.getItemEconomics(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name,job.context.market_name_id).catch(function(ex){console.log(ex);}).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 2:const j=await new Promise(async(resolve2,reject2)=>{resolve2(await global.sc.getUserInventory(global.xbot.userdata.steamID,job.context.appid,job.context.contextid,false,function(e,inv,currency){if(e){reject2(e);return;}resolve2(inv);}));}).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 3:if(job.context.analyze===true){const data=await global.xbsteam.getItemOrderBookWM(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name,job.context.market_name_id);var hook=this.sellHook(job.id,data);if(hook.price!==undefined&&hook.price>0){job.context.price=hook.price;}}await global.xbsteam.sellItem(job.context.appid,job.context.contextid,job.context.assetid,job.context.amount,job.context.price).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 4:await global.xbsteam.cancelSellListing(job.context.listingId).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 5:await global.xbsteam.createBuyOrder(job.context.currency,job.context.appid,job.context.market_hash_name,job.context.price_total,job.context.quantity,job.context.billing_state,job.context.save_my_address).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 6:await global.xbsteam.cancelBuyOrder(job.context.orderId).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){global.xbot.sendJobResult(job,'false',e);});break;case 7:await global.xbsteam.getItemPriceHistory(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name).then(function(r){global.xbot.sendJobResult(job,'true',{priceHistory:r});}).catch(function(e){global.xbot.sendJobResult(job,'false',e);});break;case 8:await global.xbsteam.getItemOrderBookWM(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name,job.context.market_name_id).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){global.xbot.sendJobResult(job,'false',e);});break;case 9:await global.xbsteam.getItemMarketNameId(job.context.appid,job.context.market_hash_name).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 10:await global.xbsteam.getMarketHistory(job.context.offset,job.context.limit).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;default:console.log('unknown job type');new Error('Unknown job type');break;}}catch(ex){this.sendJobResult(job,false,null);console.log(ex);global.sc.wait();console.log('Произошла ошибка при обработке задания #'+job.id);}resolve();});}async processInventory(){return await new Promise(async(resolve,reject)=>{console.log(this.prefix+'Обновляю инвентарь');await global.sc.wait();const arr=await global.xbsteam.getInventoryContexts(global.sc.steamID);const data=arr[0];const wallet=arr[1];global.xbot.updateAccountData(global.xbot.userdata,data,wallet);const invcontexts=Object.keys(data);for(const invc of invcontexts){await new Promise(async(resolve2,reject2)=>{await global.sc.wait();global.sc.getUserInventory(global.xbot.userdata.steamID,invc,2,false,function(e,inv,currency){if(e){reject2(e);return;}global.xbot.updateInventory(invc,inv);resolve2(data);});}).catch(function(e){console.log(e);}).then(function(data){console.log(global.xbot.prefix+invc+' updated');});}resolve();});}loop(tickCounter){return new Promise(async(resolve,reject)=>{try{if(!this.xbot_loggedIn){console.log(this.prefix+'Попытка авторизации');await this.auth().catch(await function(e){return new Promise(async resolve2=>{console.log('Ошибка авторизации. Проверьте API ключ');await new Promise(resolve2=>setTimeout(resolve,global.data.tickDelay*2));resolve2();});});if(this.xbot_loggedIn){console.log(this.prefix+'Обновляю данные пользователя');await global.sc.wait();await global.sc.getSteamUser(sc.steamID,(err,user)=>{if(err){console.error('steam: Ошибка при получении информации о пользователе:');this.xbot_loggedIn=false;}else{user.steamID64=user.steamID.getSteamID64();global.xbot.userdata=user;}});}}if(this.xbot_loggedIn&&global.xbot.userdata!==null){console.log('Выставляю');try{let aabsbas=await global.xbsteam.createBuyOrder(1,252490,'Test Dummy Mask',25,1,'',0).catch(function(e){console.log(e);}).then(function(a){console.log(a);});}catch(ex){console.log(ex);}console.log('END');await global.sc.wait();await global.sc.wait();await global.sc.wait();resolve();return;if(tickCounter%global.data.ticks.checkConfirmations==0){console.log(this.prefix+'Проверяю аутентификатор');await global.xbsteam.confirmAllMarketTransactions().catch(function(e){console.log('Произошла ошибка при проверке аунтентификатора');});await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}let authkey=SteamTotp.getAuthCode(global.data.sharedSecret);if(tickCounter%global.data.ticks.ping==0||this.lastsentauthkey!==authkey){await this.ping(authkey);}if(tickCounter%global.data.ticks.sendInventory==0||tickCounter==2){await this.processInventory();}if(tickCounter%global.data.ticks.sendOrders==0||tickCounter==2){console.log(this.prefix+'Проверяю ордера');await global.sc.wait();await global.xbsteam.getOrders().then(function(data){global.xbot.updateOrdersAndListings(data);});await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}if(tickCounter%global.data.ticks.lastHistory==0||tickCounter==2){console.log(this.prefix+'Обновляю историю операций');var a=await global.xbsteam.getMarketHistory(0,100);this.history(a);await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}const jobsResponse=await this.getJobs();const jobs=jobsResponse.jobs;console.log(this.prefix+'Получено '+jobs.length+' заданий');for(const job of jobs){await this.processJob(job);}await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));resolve();}catch(ex){console.log(ex);reject(ex);await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*25));}});}};