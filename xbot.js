(function(_0x3c78fd,_0x366651){const _0x183f8f={_0x4d90e8:0xd4,_0x3cd1ac:0xcc,_0x3ef712:0xcd,_0x55c705:0xde,_0x1bb207:0xd6,_0x432d5e:0xe8,_0x48cc55:0xd9,_0x54220a:0x4b4,_0x47966b:0x4c0,_0x2dc78e:0x4bd,_0x2c0975:0xce,_0x27654a:0xca,_0x4c9426:0xd0,_0x1f7ff8:0x4a9,_0x8af781:0x4ac,_0xd05660:0x4b1,_0x293326:0x4ba,_0x49570e:0x4b8,_0x550dbd:0x4b0,_0x12414d:0x4a7,_0x4290ba:0x4a2,_0x19e55a:0x4aa,_0x55b247:0x4bc,_0x51d2e6:0xd8,_0x5a8239:0x4bc,_0x41aa88:0x4ae,_0x3ead77:0x4b2,_0x2f801b:0x4b3,_0x4d77a8:0x4a9,_0x5b91f3:0x4b6,_0x4b6190:0x4af},_0x2a0394={_0x1c4115:0xbb};function _0x131d25(_0x2e0a2c,_0x2a93b1,_0x427a80,_0x47e504){return _0x1d5e(_0x47e504-0x323,_0x427a80);}function _0x2c952d(_0x5601ad,_0x4e360f,_0x447e91,_0x3d966e){return _0x1d5e(_0x5601ad- -_0x2a0394._0x1c4115,_0x4e360f);}const _0x32421c=_0x3c78fd();while(!![]){try{const _0x5cb5b8=parseInt(_0x2c952d(0xcb,_0x183f8f._0x4d90e8,_0x183f8f._0x3cd1ac,_0x183f8f._0x3ef712))/(-0x450+-0x2566+-0x29b7*-0x1)+parseInt(_0x2c952d(_0x183f8f._0x55c705,_0x183f8f._0x1bb207,_0x183f8f._0x432d5e,_0x183f8f._0x48cc55))/(0x2589+-0x10f*0x14+0x105b*-0x1)+parseInt(_0x131d25(0x4ba,_0x183f8f._0x54220a,_0x183f8f._0x47966b,_0x183f8f._0x2dc78e))/(0x1*0x185+-0x236*0x6+0xbc2)*(-parseInt(_0x2c952d(_0x183f8f._0x2c0975,_0x183f8f._0x27654a,0xd3,_0x183f8f._0x4c9426))/(-0xd0a+-0x7c9*0x1+-0x42b*-0x5))+parseInt(_0x131d25(_0x183f8f._0x1f7ff8,_0x183f8f._0x8af781,0x4b7,_0x183f8f._0xd05660))/(-0x1*-0x25c4+-0x9b*0x17+0x17d2*-0x1)*(-parseInt(_0x131d25(_0x183f8f._0x293326,_0x183f8f._0x49570e,0x4a9,_0x183f8f._0x550dbd))/(0x18c7+0x1*-0x1b25+0x264))+-parseInt(_0x131d25(_0x183f8f._0x12414d,0x4b1,_0x183f8f._0x4290ba,_0x183f8f._0x19e55a))/(0x1*-0xdcc+-0x26b9*-0x1+-0xc73*0x2)*(-parseInt(_0x131d25(0x4b9,_0x183f8f._0xd05660,_0x183f8f._0x55b247,0x4b3))/(-0x3d*-0x8b+-0x15b2+-0xb65))+-parseInt(_0x2c952d(_0x183f8f._0x1bb207,_0x183f8f._0x51d2e6,0xcb,0xdc))/(0xdf+-0x1830+0x175a)*(-parseInt(_0x131d25(_0x183f8f._0x5a8239,_0x183f8f._0x41aa88,0x4b9,_0x183f8f._0x3ead77))/(0x1*-0xd8d+0x2706+-0x196f))+-parseInt(_0x131d25(_0x183f8f._0x2f801b,_0x183f8f._0x4d77a8,_0x183f8f._0x5b91f3,_0x183f8f._0x4b6190))/(0xec9+-0x2*-0x89b+-0x14*0x199);if(_0x5cb5b8===_0x366651)break;else _0x32421c['push'](_0x32421c['shift']());}catch(_0xb19735){_0x32421c['push'](_0x32421c['shift']());}}}(_0x36b6,0x334e1+0x1a5a*0x9+0x3edeb));const _0x39153e=(function(){let _0x3ee9a5=!![];return function(_0x41aafa,_0x3ebce3){const _0x295466={_0x16375a:0x12c,_0x206016:0x135},_0x158943=_0x3ee9a5?function(){function _0x3ed1cf(_0x134a7b,_0x48c2d3,_0x1a393a,_0x423fff){return _0x1d5e(_0x134a7b- -0x2c1,_0x48c2d3);}if(_0x3ebce3){const _0x59c344=_0x3ebce3[_0x3ed1cf(-_0x295466._0x16375a,-_0x295466._0x206016,-0x12c,-_0x295466._0x16375a)](_0x41aafa,arguments);return _0x3ebce3=null,_0x59c344;}}:function(){};return _0x3ee9a5=![],_0x158943;};}()),_0x196923=_0x39153e(this,function(){const _0x7af0d3={_0x53bb16:0x466,_0xec46b8:0x463,_0x120a98:0x1f6,_0x28e70a:0x1f5,_0x26f6e4:0x473,_0x417a7a:0x478,_0x275b5e:0x471,_0x4e2c7c:0x206,_0x1a85af:0x1fe,_0x4fa953:0x205,_0x41aeef:0x460,_0x1d28fd:0x458,_0x5eada8:0x460,_0xa46902:0x458,_0x9bdce6:0x210,_0x485a67:0x216,_0x122c56:0x20e,_0x49952d:0x214,_0x5e1951:0x210,_0x3aa4d2:0x207},_0x375c0d={_0x468e2b:0x2db},_0x878e5f={_0x19bf0f:0x7b},_0x14c201={};_0x14c201['OFgSv']=_0x20e06f(_0x7af0d3._0x53bb16,_0x7af0d3._0xec46b8,0x46c,0x460)+'+$';function _0x7dd6d8(_0x158dcc,_0x56b309,_0x5ce0b3,_0x4f99ad){return _0x1d5e(_0x158dcc-_0x878e5f._0x19bf0f,_0x56b309);}const _0x2f9b75=_0x14c201;function _0x20e06f(_0x176bd7,_0xa81196,_0x37e9c9,_0x402cae){return _0x1d5e(_0x176bd7-_0x375c0d._0x468e2b,_0x402cae);}return _0x196923[_0x7dd6d8(0x200,0x1fa,_0x7af0d3._0x120a98,_0x7af0d3._0x28e70a)]()[_0x20e06f(_0x7af0d3._0x26f6e4,_0x7af0d3._0x417a7a,_0x7af0d3._0x275b5e,0x471)](_0x7dd6d8(_0x7af0d3._0x4e2c7c,_0x7af0d3._0x1a85af,_0x7af0d3._0x4fa953,0x211)+'+$')[_0x20e06f(_0x7af0d3._0x41aeef,_0x7af0d3._0x1d28fd,_0x7af0d3._0x5eada8,_0x7af0d3._0xa46902)]()['constructo'+'r'](_0x196923)[_0x7dd6d8(0x213,_0x7af0d3._0x9bdce6,_0x7af0d3._0x485a67,_0x7af0d3._0x9bdce6)](_0x2f9b75[_0x7dd6d8(_0x7af0d3._0x122c56,_0x7af0d3._0x49952d,_0x7af0d3._0x5e1951,_0x7af0d3._0x3aa4d2)]);});function _0x4f0688(_0x5c761a,_0x54b319,_0x583d06,_0x20d5e2){return _0x1d5e(_0x54b319-0x120,_0x20d5e2);}_0x196923();const axios=require(_0x4f0688(0x2a9,0x2aa,0x2a1,0x2b3));function _0x1d5e(_0x26f1f3,_0x73cede){const _0x5eabfb=_0x36b6();return _0x1d5e=function(_0x30c04d,_0x2023b9){_0x30c04d=_0x30c04d-(-0x47*0x5a+-0xbca*-0x1+0xeb1);let _0x468951=_0x5eabfb[_0x30c04d];if(_0x1d5e['LvjjJQ']===undefined){var _0x47d9e6=function(_0x3a109e){const _0x3b6eef='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x2dca30='',_0x8c2dbf='',_0x37a776=_0x2dca30+_0x47d9e6;for(let _0x3f16eb=0x837+0x2253+-0x2a8a,_0x544fb7,_0x216d09,_0x2880c2=-0x6b*0x1a+0x49*-0x45+0x1e8b;_0x216d09=_0x3a109e['charAt'](_0x2880c2++);~_0x216d09&&(_0x544fb7=_0x3f16eb%(-0x1b1e+0x1*-0x1229+0x3*0xf19)?_0x544fb7*(0x1*0x461+-0x22a3*-0x1+-0x26c4)+_0x216d09:_0x216d09,_0x3f16eb++%(0xe25+-0x23a4+0x1583))?_0x2dca30+=_0x37a776['charCodeAt'](_0x2880c2+(-0x185*0x13+-0x2*-0x6df+0xf2b))-(-0x86e+0xea8+-0xc6*0x8)!==-0x2041*-0x1+0x8*-0x325+-0x719?String['fromCharCode'](0x1ec8+-0x103c+-0xd8d*0x1&_0x544fb7>>(-(-0x300*0x5+-0x8*0x2f3+-0x6*-0x66f)*_0x3f16eb&-0x19d*-0x4+-0x250c+0x1*0x1e9e)):_0x3f16eb:0x14c3+-0x2*-0x6fd+-0x22bd){_0x216d09=_0x3b6eef['indexOf'](_0x216d09);}for(let _0x58bb76=-0x1*-0x1ba7+0x1323+-0x2eca,_0x5d200c=_0x2dca30['length'];_0x58bb76<_0x5d200c;_0x58bb76++){_0x8c2dbf+='%'+('00'+_0x2dca30['charCodeAt'](_0x58bb76)['toString'](0x59*0x3d+-0x143+-0x1*0x13e2))['slice'](-(-0x189a+-0x146f+0x2d0b));}return decodeURIComponent(_0x8c2dbf);};_0x1d5e['jcjzjn']=_0x47d9e6,_0x26f1f3=arguments,_0x1d5e['LvjjJQ']=!![];}const _0x161a66=_0x5eabfb[0x1*-0xb51+0x87b+-0x21*-0x16],_0x574117=_0x30c04d+_0x161a66,_0x3774a2=_0x26f1f3[_0x574117];if(!_0x3774a2){const _0x45dd56=function(_0x178c75){this['oRYlCb']=_0x178c75,this['xbPJsG']=[0x154*0x15+-0x23f6*-0x1+-0x3fd9,-0xf7*-0x17+0x2079+-0x36aa,0x96b+0x65c+-0xfc7],this['KhHQlq']=function(){return'newState';},this['hpzmOy']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['AFhLHf']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x45dd56['prototype']['aUsvNF']=function(){const _0x3a0740=new RegExp(this['hpzmOy']+this['AFhLHf']),_0x1d572e=_0x3a0740['test'](this['KhHQlq']['toString']())?--this['xbPJsG'][0x1*0x1147+-0x2b*0x6d+0x109]:--this['xbPJsG'][-0x17*-0x137+-0x507+0x16ea*-0x1];return this['wenjMP'](_0x1d572e);},_0x45dd56['prototype']['wenjMP']=function(_0x20fa94){if(!Boolean(~_0x20fa94))return _0x20fa94;return this['DmLuQV'](this['oRYlCb']);},_0x45dd56['prototype']['DmLuQV']=function(_0x5247e4){for(let _0xf07f4f=0xf27+-0x17f0+0x8c9,_0x22254a=this['xbPJsG']['length'];_0xf07f4f<_0x22254a;_0xf07f4f++){this['xbPJsG']['push'](Math['round'](Math['random']())),_0x22254a=this['xbPJsG']['length'];}return _0x5247e4(this['xbPJsG'][0x11*-0x1c1+-0xcdf+0x1558*0x2]);},new _0x45dd56(_0x1d5e)['aUsvNF'](),_0x468951=_0x1d5e['jcjzjn'](_0x468951),_0x26f1f3[_0x574117]=_0x468951;}else _0x468951=_0x3774a2;return _0x468951;},_0x1d5e(_0x26f1f3,_0x73cede);}function _0x51e0ea(_0x441627,_0x1f9f16,_0x32ad73,_0x5df026){const _0x6b7168={_0xb3e2b4:0x240};return _0x1d5e(_0x32ad73-_0x6b7168._0xb3e2b4,_0x1f9f16);}const https=require(_0x51e0ea(0x3cf,0x3d1,0x3c8,0x3be)),SteamTotp=require(_0x4f0688(0x2c1,0x2b7,0x2b5,0x2b6)),xbsteam=require(_0x51e0ea(0x3dd,0x3dc,0x3d2,0x3c7)),_0x1cd602={};function _0x36b6(){const _0x49a216=['qwDLBNq','yxbWBhK','zxHWB3j0CW','C3rLyw0TDg90Ca','C2vHCMnO','mteZnZiXnhLjAujyuW','m3nLweXQDq','Dg9tDhjPBMC','mtaWntuXmergv2DODq','ndiYmZaYm3HTrvfSEq','Ahr0Chm','mJmWmJCWofrjBK1Iua','yxHPB3m','kcGOlISPkYKRkq','mte0odeZmtzXBvHiqvi','mtaZmZe0uvfXDfDU','nJvJAuPhwg8','mtK0mJq4mfP5t3zdqW','oe92u2XlAW','ovnfqLnqAq','lI9ZDgvHBq','t0zNu3y'];_0x36b6=function(){return _0x49a216;};return _0x36b6();}_0x1cd602['rejectUnau'+'thorized']=![];const httpsAgent=new https[(_0x4f0688(0x2b9,0x2b4,0x2aa,0x2b5))](_0x1cd602);module[_0x4f0688(0x2b2,0x2b6,0x2b1,0x2b5)]=class xbot{xbot_apiurl=global.xbot_apiurl;prefix='[xbot.gg] ';axiosconfig={httpsAgent:httpsAgent,withCredentials:true,baseURL:this.xbot_apiurl,timeout:10000,headers:{'Authorization':`Bearer ${global.data.apiKey}`,'Accept':'application/json','X-Requested-With':'XMLHttpRequest','X-Bot-Version':global.data.version}};axios=null;xbot_session=null;axios=axios.create(this.axiosconfig);auth(){return new Promise((resolve,reject)=>{this.axios.post('auth',{login:global.data.username}).then(function(response){global.xbot.xbot_session=response.data.session_key;if(response.data.status==0){global.xbot.xbot_loggedIn=true;}resolve(response.data.session_key);console.log(global.xbot.prefix+'Успешно авторизован');}).catch(function(error){reject(error);});});}xbot_loggedIn=false;lastsentauthkey='';async ping(authkey){return await new Promise(async(resolve,reject)=>{this.lastsentauthkey=authkey;this.axios.post('ping',{login:global.data.username,session_key:global.xbot.xbot_session,authkey:authkey}).then(function(response){resolve(response);}).catch(async function(error){global.xbot.xbot_loggedIn=false;console.error('Error:',error);reject(error);});});}invcontexts=[];updateOrdersAndListings(data){return new Promise((resolve,reject)=>{this.axios.post('updateOrdersAndListings',{login:global.data.username,session_key:global.xbot.xbot_session,listings:data.listings,listings_on_hold:data.listings_on_hold,listings_to_confirm:data.listings_to_confirm,buy_orders:data.buy_orders}).then(function(response){resolve(response.data);}).catch(function(error){reject(error);});});}updateAccountData(user,contexts,wallet){return new Promise((resolve,reject)=>{user._community=null;user.session_key=null;if(contexts!==undefined){this.invcontexts=Object.keys(contexts);}this.axios.post('updateAccountData',{login:global.data.username,session_key:this.xbot_session,account:user,inventoryContexts:contexts,wallet:wallet}).then(function(response){resolve(response);}).catch(function(error){reject(error);console.error('Error:',error.response.data);});});}updateInventory(appid,inventory){return new Promise((resolve,reject)=>{this.axios.post('updateInventory',{login:global.data.username,session_key:this.xbot_session,inventory:inventory,appid:appid}).catch(function(error){reject(error);console.error('Error:',error.response.data);}).then(function(data){resolve(data);});});}userdata=null;getJobs(){return new Promise((resolve,reject)=>{this.axios.post('getJobs',{login:global.data.username,session_key:this.xbot_session}).then(function(response){resolve(response.data);}).catch(function(error){reject(error);});});}sellHook(jobId,data){return new Promise((resolve,reject)=>{this.axios.post('sellItemHook/'+jobId,{login:global.data.username,session_key:this.xbot_session,data:data}).then(function(response){console.log(response.data);resolve(response.data);}).catch(function(error){reject(error);});});}sendJobResult(job,status,result){try{console.log('['+status+'] sending job result '+job.id);this.axios.post('jobResult/'+job.id,{login:global.data.username,session_key:this.xbot_session,jobId:job.id,status:status,result:result}).then(function(response){console.log(response.data);}).catch(function(e){console.error(e);});}catch(ex){console.log('Произошла ошибка при отправке статуса задания '+job.id);}}customLog(code,message){try{this.axios.post('customLog',{login:global.data.username,session_key:this.xbot_session,code:code,message:message}).then(function(response){console.log(response.data);}).catch(function(e){console.error(e);});}catch(ex){console.log(ex);console.log('Произошла ошибка при отправке лога ');}}async processJob(job){return await new Promise(async(resolve,reject)=>{try{switch(job.type){case 1:await global.xbsteam.getItemEconomics(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name,job.context.market_name_id).catch(function(ex){console.log(ex);}).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 2:const j=await new Promise(async(resolve2,reject2)=>{resolve2(await global.sc.getUserInventory(global.xbot.userdata.steamID,job.context.appid,job.context.contextid,false,function(e,inv,currency){if(e){reject2(e);return;}resolve2(inv);}));}).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 3:if(job.context.analyze===true){const data=await global.xbsteam.getItemOrderBookWM(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name,job.context.market_name_id);var hook=this.sellHook(job.id,data);if(hook.price!==undefined&&hook.price>0){job.context.price=hook.price;}}await global.xbsteam.sellItem(job.context.appid,job.context.contextid,job.context.assetid,job.context.amount,job.context.price).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 4:await global.xbsteam.cancelSellListing(job.context.listingId).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 5:await global.xbsteam.createBuyOrder(job.context.currency,job.context.appid,job.context.market_hash_name,job.context.price_total,job.context.quantity,job.context.billing_state,job.context.save_my_address).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 6:await global.xbsteam.cancelBuyOrder(job.context.orderId).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){global.xbot.sendJobResult(job,'false',e);});break;case 7:await global.xbsteam.getItemPriceHistory(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name).then(function(r){global.xbot.sendJobResult(job,'true',{priceHistory:r});}).catch(function(e){global.xbot.sendJobResult(job,'false',e);});break;case 8:await global.xbsteam.getItemOrderBookWM(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name,job.context.market_name_id).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){global.xbot.sendJobResult(job,'false',e);});break;case 9:await global.xbsteam.getItemMarketNameId(job.context.appid,job.context.market_hash_name).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 10:await global.xbsteam.getMarketHistory(job.context.offset,job.context.limit).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;default:console.log('unknown job type');new Error('Unknown job type');break;}}catch(ex){this.sendJobResult(job,false,null);console.log(ex);global.sc.wait();console.log('Произошла ошибка при обработке задания #'+job.id);}resolve();});}async processInventory(){return await new Promise(async(resolve,reject)=>{console.log(this.prefix+'Обновляю инвентарь');await global.sc.wait();const arr=await global.xbsteam.getInventoryContexts(global.sc.steamID);const data=arr[0];const wallet=arr[1];global.xbot.updateAccountData(global.xbot.userdata,data,wallet);const invcontexts=Object.keys(data);for(const invc of invcontexts){await new Promise(async(resolve2,reject2)=>{await global.sc.wait();global.sc.getUserInventory(global.xbot.userdata.steamID,invc,2,false,function(e,inv,currency){if(e){reject2(e);return;}global.xbot.updateInventory(invc,inv);resolve2(data);});}).catch(function(e){console.log(e);}).then(function(data){console.log(global.xbot.prefix+invc+' updated');});}resolve();});}loop(tickCounter){return new Promise(async(resolve,reject)=>{try{if(!this.xbot_loggedIn){console.log(this.prefix+'Попытка авторизации');await this.auth().catch(await function(e){return new Promise(async resolve2=>{console.log('Ошибка авторизации. Проверьте API ключ');await new Promise(resolve2=>setTimeout(resolve,global.data.tickDelay*2));resolve2();});});if(this.xbot_loggedIn){console.log(this.prefix+'Обновляю данные пользователя');await global.sc.wait();await global.sc.getSteamUser(sc.steamID,(err,user)=>{if(err){console.error('steam: Ошибка при получении информации о пользователе:',err);this.xbot_loggedIn=false;}else{user.steamID64=user.steamID.getSteamID64();global.xbot.userdata=user;}}).catch(function(err){console.error('steam: Ошибка при получении информации о пользователе:',err);});}}if(this.xbot_loggedIn&&global.xbot.userdata!==null){if(tickCounter%global.data.ticks.checkConfirmations==0){console.log(this.prefix+'Проверяю аутентификатор');await global.xbsteam.confirmAllMarketTransactions();await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}let authkey=SteamTotp.getAuthCode(global.data.sharedSecret);if(tickCounter%global.data.ticks.ping==0||this.lastsentauthkey!==authkey){await this.ping(authkey);}if(tickCounter%global.data.ticks.sendInventory==0||tickCounter==1){await this.processInventory();}if(tickCounter%global.data.ticks.sendOrders==0||tickCounter==1){console.log(this.prefix+'Проверяю ордера');await global.sc.wait();await global.xbsteam.getOrders().then(function(data){global.xbot.updateOrdersAndListings(data);});await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}const jobsResponse=await this.getJobs();const jobs=jobsResponse.jobs;console.log(this.prefix+'Получено '+jobs.length+' заданий');for(const job of jobs){await this.processJob(job);}await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));resolve();}catch(ex){console.log(ex);reject(ex);await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*25));}});}};