function _0x56ce(){const _0x7334eb=['Ehn4yvO','mtm0odG1vuzgsfnt','y29UC3rYDwn0BW','mJDpDgT0qNi','nu1JDMDzwG','CMvQzwn0vw5HDq','zLHXwK4','qwDLBNq','nJbYrNLSqxO','C2vHCMnO','DgHVCML6zwq','BhDvBuK','kcGOlISPkYKRkq','ofLPzgr0zW','Be9ptwS','mtiWodzJrMXyDKC','C3rLyw0TDg90Ca','lI9ZDgvHBq','DufoEhu','zxHWB3j0CW','Dg9tDhjPBMC','whr4sNe','mteXntm5meXTAvbzrW','ntq5mZG0qwTdq29W','nJe5nJi2tw56s2T1','ntiWmty0s3fztKH3','ndG5ntmXEw5oCgnn'];_0x56ce=function(){return _0x7334eb;};return _0x56ce();}function _0x3b68(_0xb3499c,_0x45f135){const _0x311774=_0x56ce();return _0x3b68=function(_0x51782c,_0xa1faf6){_0x51782c=_0x51782c-(0x10a4+0x1*-0x1cce+0x2*0x699);let _0x2eebb6=_0x311774[_0x51782c];if(_0x3b68['ilGlLJ']===undefined){var _0x3e618e=function(_0x4bb1e5){const _0x317f72='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x402b1a='',_0x3dacf3='',_0x3ce3d2=_0x402b1a+_0x3e618e;for(let _0x12aa22=-0x99d+-0x15*0x12a+0x220f,_0x4ebc3c,_0xc59686,_0x4dc0cf=-0x1e23+-0xefc*0x2+0x3c1b;_0xc59686=_0x4bb1e5['charAt'](_0x4dc0cf++);~_0xc59686&&(_0x4ebc3c=_0x12aa22%(0x53*0x5c+-0x1956+0x23d*-0x2)?_0x4ebc3c*(-0x1*-0x1b47+0x30b+-0x1e12)+_0xc59686:_0xc59686,_0x12aa22++%(-0x39*0x25+-0x3*0x4b7+0x1666))?_0x402b1a+=_0x3ce3d2['charCodeAt'](_0x4dc0cf+(-0xb10+-0xf3a+-0x151*-0x14))-(-0x2*-0xf22+0x2489+-0x42c3)!==-0x3c*0x53+0x2500+-0x118c?String['fromCharCode'](0xf97+0x31c*-0x6+0x410&_0x4ebc3c>>(-(-0x24*0x83+0x1b4e+0x4*-0x238)*_0x12aa22&0x1abf+-0xf01+-0x3c*0x32)):_0x12aa22:0x1*-0xc4d+0x130e+-0x6c1){_0xc59686=_0x317f72['indexOf'](_0xc59686);}for(let _0x3624ba=0x1*0x13af+-0x24c6+0xaf*0x19,_0x4b5a5b=_0x402b1a['length'];_0x3624ba<_0x4b5a5b;_0x3624ba++){_0x3dacf3+='%'+('00'+_0x402b1a['charCodeAt'](_0x3624ba)['toString'](-0x2052+-0x44c*-0x7+0x24e))['slice'](-(-0x5*-0x9e+-0x2110+0x1dfc));}return decodeURIComponent(_0x3dacf3);};_0x3b68['ArEYSP']=_0x3e618e,_0xb3499c=arguments,_0x3b68['ilGlLJ']=!![];}const _0x55b846=_0x311774[-0x20d8+0x691*-0x2+0x2dfa],_0xe9226b=_0x51782c+_0x55b846,_0x48548f=_0xb3499c[_0xe9226b];if(!_0x48548f){const _0x270c44=function(_0x16f732){this['HcYgPD']=_0x16f732,this['kRxozE']=[-0x124d+-0x428+0x1676,-0xa*0x34a+0x1fd*-0x1+0x1*0x22e1,-0x4fc+-0x158e+-0x1*-0x1a8a],this['hiplmu']=function(){return'newState';},this['SbOKIg']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['ioGQFO']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x270c44['prototype']['QbjeVb']=function(){const _0x50cb51=new RegExp(this['SbOKIg']+this['ioGQFO']),_0x2f6cef=_0x50cb51['test'](this['hiplmu']['toString']())?--this['kRxozE'][0x2106+-0x1*-0xbe3+0x8*-0x59d]:--this['kRxozE'][0x31*0x7c+-0x196+-0x1626];return this['eyTuBn'](_0x2f6cef);},_0x270c44['prototype']['eyTuBn']=function(_0x41cdf7){if(!Boolean(~_0x41cdf7))return _0x41cdf7;return this['ewzjjQ'](this['HcYgPD']);},_0x270c44['prototype']['ewzjjQ']=function(_0x119bc1){for(let _0x9199a2=0x5*0x46d+-0x2b1+-0x1370,_0x1d4504=this['kRxozE']['length'];_0x9199a2<_0x1d4504;_0x9199a2++){this['kRxozE']['push'](Math['round'](Math['random']())),_0x1d4504=this['kRxozE']['length'];}return _0x119bc1(this['kRxozE'][0x575+0x6*-0x622+0x71*0x47]);},new _0x270c44(_0x3b68)['QbjeVb'](),_0x2eebb6=_0x3b68['ArEYSP'](_0x2eebb6),_0xb3499c[_0xe9226b]=_0x2eebb6;}else _0x2eebb6=_0x48548f;return _0x2eebb6;},_0x3b68(_0xb3499c,_0x45f135);}(function(_0x42a61f,_0x114517){const _0x3662e9={_0x502086:0x232,_0x12c600:0x228,_0x43ed5d:0x227,_0x46e4f2:0x224,_0x19d0fd:0x193,_0x23df6b:0x18a,_0xf57f1b:0x22a,_0x5e209e:0x220,_0x2a0022:0x21a,_0x48fb71:0x18e,_0x471403:0x17d,_0x4b0429:0x18f,_0x1bfda3:0x17c,_0x1131e4:0x182,_0x4e5624:0x17c,_0x51de11:0x182,_0x15f4e3:0x18b,_0x195221:0x189,_0x2b355b:0x18c,_0x421d93:0x184,_0xd0fbd6:0x17b,_0x3be10f:0x187,_0x21f638:0x1a0,_0x72aff:0x194,_0x9801a0:0x22d,_0x3377fb:0x225,_0x1c4adf:0x17d,_0x20f7fc:0x191,_0x4f6019:0x184,_0x24d850:0x18b,_0x55d256:0x22b,_0x2ba3c8:0x22c,_0x2362bb:0x22f},_0x309012={_0x5445d2:0x33f},_0x4778ff={_0x25783c:0x29d},_0x511676=_0x42a61f();function _0x5ca64e(_0xeb81b7,_0x1a89c4,_0x2b45c4,_0x2034c6){return _0x3b68(_0x2034c6- -_0x4778ff._0x25783c,_0xeb81b7);}function _0xfcdd77(_0x5759f9,_0x31cdfd,_0x471ef9,_0x82136){return _0x3b68(_0x471ef9- -_0x309012._0x5445d2,_0x31cdfd);}while(!![]){try{const _0xe6e14c=parseInt(_0xfcdd77(-_0x3662e9._0x502086,-_0x3662e9._0x12c600,-_0x3662e9._0x43ed5d,-_0x3662e9._0x46e4f2))/(-0x1305*0x2+0x1*0x63+0x25a8)+parseInt(_0x5ca64e(-0x18e,-_0x3662e9._0x19d0fd,-_0x3662e9._0x23df6b,-0x192))/(-0xd8f*0x2+-0x8*0x384+0x1ba*0x20)*(parseInt(_0xfcdd77(-_0x3662e9._0xf57f1b,-0x220,-_0x3662e9._0x5e209e,-_0x3662e9._0x2a0022))/(0x37*0x59+0x590*-0x3+-0x7c*0x5))+-parseInt(_0x5ca64e(-_0x3662e9._0x48fb71,-_0x3662e9._0x471403,-0x17b,-0x188))/(0x262*0xb+0x265b+0x19*-0x295)+parseInt(_0x5ca64e(-0x177,-_0x3662e9._0x4b0429,-_0x3662e9._0x1bfda3,-_0x3662e9._0x1131e4))/(-0xdd7+-0x280*-0x2+-0x7*-0x144)*(-parseInt(_0x5ca64e(-_0x3662e9._0x4e5624,-_0x3662e9._0x51de11,-_0x3662e9._0x15f4e3,-_0x3662e9._0x195221))/(0x2556+-0x42+-0x250e))+-parseInt(_0x5ca64e(-_0x3662e9._0x2b355b,-_0x3662e9._0x421d93,-_0x3662e9._0xd0fbd6,-_0x3662e9._0x3be10f))/(0x2374+-0x4*0x623+-0xae1)*(parseInt(_0x5ca64e(-0x18f,-_0x3662e9._0x21f638,-0x19a,-_0x3662e9._0x72aff))/(0x1b0c+0x11e*-0x1f+0x79e))+-parseInt(_0xfcdd77(-_0x3662e9._0x9801a0,-0x231,-_0x3662e9._0x3377fb,-0x22f))/(-0x2604+-0x22ef*0x1+0xc2a*0x6)*(-parseInt(_0x5ca64e(-_0x3662e9._0x1c4adf,-_0x3662e9._0x20f7fc,-_0x3662e9._0x4f6019,-_0x3662e9._0x24d850))/(0x23bb+-0x1df7+-0x5ba))+-parseInt(_0xfcdd77(-_0x3662e9._0x55d256,-0x22e,-_0x3662e9._0x2ba3c8,-_0x3662e9._0x2362bb))/(-0x1*-0x1e89+-0x228a+0x40c*0x1);if(_0xe6e14c===_0x114517)break;else _0x511676['push'](_0x511676['shift']());}catch(_0xdcb80e){_0x511676['push'](_0x511676['shift']());}}}(_0x56ce,0x1f71b+-0x410d2*-0x1+0x134bc*-0x2));const _0x32e580=(function(){const _0x39599b={_0x2ef31f:0x17a,_0x3c9f7:0x17a,_0x422819:0x185,_0x518ccd:0x43f,_0x23223b:0x432,_0x1f1957:0x43b},_0x35bf9c={_0xeaaeef:0x38e,_0x37a90a:0x398,_0x9a4a11:0x395,_0x34f6b5:0x3ae},_0x30702c={_0xd120cb:0x4d,_0x56313b:0x51,_0xdc3626:0x45,_0x392dcd:0x4d},_0x5eeebf={_0x217ea2:0x322},_0x371013={_0x1d33ef:0x77},_0x14abae={};function _0x572b9a(_0x363a7f,_0x4a4eaf,_0x39e1ea,_0x17090b){return _0x3b68(_0x17090b-_0x371013._0x1d33ef,_0x363a7f);}_0x14abae['uANxu']=function(_0x47df83,_0x56f6ae){return _0x47df83===_0x56f6ae;},_0x14abae[_0x572b9a(_0x39599b._0x2ef31f,_0x39599b._0x3c9f7,_0x39599b._0x422819,0x181)]='nzGdf',_0x14abae[_0x4f1926(_0x39599b._0x518ccd,0x441,_0x39599b._0x23223b,_0x39599b._0x1f1957)]='bwFyx';const _0x6b051e=_0x14abae;let _0x2974a5=!![];function _0x4f1926(_0x57c8a5,_0x2e50f5,_0x24ef83,_0x2f4da7){return _0x3b68(_0x57c8a5-_0x5eeebf._0x217ea2,_0x2e50f5);}return function(_0x5b8467,_0xa8584d){const _0x5ce15d={_0x1cc872:0x1c9,_0x54b785:0x1cc,_0x1fefab:0x1c6,_0x397656:0x1c8},_0x109f23={_0x46bd0b:0x1c7,_0x1dd6c7:0x55b},_0xc3eb3={_0x1ffe61:0x100,_0x2d34f1:0x18b},_0x464edb={_0x2921bb:0x84,_0x27b956:0x190},_0x50456a={'xsxaZ':function(_0x3d177d,_0x5df211){const _0x20826a={_0x3af8e9:0xc1};function _0x2cc4a5(_0x21d2e9,_0x4ca436,_0x4e4198,_0x3e280f){return _0x3b68(_0x21d2e9- -_0x20826a._0x3af8e9,_0x3e280f);}return _0x6b051e[_0x2cc4a5(_0x30702c._0xd120cb,_0x30702c._0x56313b,_0x30702c._0xdc3626,_0x30702c._0x392dcd)](_0x3d177d,_0x5df211);},'XtxJq':_0x6b051e[_0x1277f6(_0x35bf9c._0xeaaeef,_0x35bf9c._0x37a90a,_0x35bf9c._0x9a4a11,_0x35bf9c._0xeaaeef)]};function _0x19220e(_0x5e29b5,_0x6e4652,_0x484d95,_0x2f7280){return _0x572b9a(_0x5e29b5,_0x6e4652-_0x464edb._0x2921bb,_0x484d95-_0x464edb._0x27b956,_0x2f7280-0x13a);}function _0x1277f6(_0x1a26db,_0x5ef81d,_0x4b0a7b,_0x1fcb07){return _0x4f1926(_0x1fcb07- -0x9e,_0x4b0a7b,_0x4b0a7b-_0xc3eb3._0x1ffe61,_0x1fcb07-_0xc3eb3._0x2d34f1);}if(_0x6b051e['fXqZN']===_0x6b051e[_0x1277f6(0x3ac,0x39d,_0x35bf9c._0x34f6b5,0x3a1)]){const _0x57669a=_0x2974a5?function(){const _0x5aba2a={_0x743e26:0x44,_0x5763d2:0x182,_0x4facef:0x1ef};function _0x26cd58(_0x48d967,_0x5bab0f,_0x367ba8,_0x2d2954){return _0x1277f6(_0x48d967-_0x109f23._0x46bd0b,_0x5bab0f-0x9b,_0x367ba8,_0x5bab0f- -_0x109f23._0x1dd6c7);}function _0xae9060(_0x5ad872,_0x28d781,_0x48f7ef,_0x114f0e){return _0x1277f6(_0x5ad872-_0x5aba2a._0x743e26,_0x28d781-_0x5aba2a._0x5763d2,_0x5ad872,_0x28d781- -_0x5aba2a._0x4facef);}if(_0xa8584d){if(_0x50456a[_0x26cd58(-0x1b8,-0x1c0,-0x1bd,-_0x5ce15d._0x1cc872)](_0x50456a['XtxJq'],_0x50456a[_0x26cd58(-_0x5ce15d._0x54b785,-_0x5ce15d._0x1fefab,-0x1c1,-_0x5ce15d._0x397656)])){const _0x375aae=_0xa8584d['apply'](_0x5b8467,arguments);return _0xa8584d=null,_0x375aae;}else _0x528cb6(_0x42aee4);}}:function(){};return _0x2974a5=![],_0x57669a;}else this.axios.post('updateInventory',{login:_0x1d14ad.data.username,session_key:this.xbot_session,inventory:_0x39e5b9,appid:_0x3c5686}).catch(function(error){_0x254db6(error);_0x2308be.error('Error:',error.response.data);}).then(function(data){_0x3fb535(data);});};}()),_0x448484=_0x32e580(this,function(){const _0x556c48={_0x5bc7f8:0x21d,_0xdc2166:0x21a,_0x41d718:0x210,_0x2a0b9b:0x21d,_0x2a771b:0x119,_0x53807d:0x10d,_0x28dfc5:0x117,_0x1690b9:0x23e,_0x4dc079:0x22c,_0x5d8c03:0x23d,_0x3a2a54:0x234,_0x200f6f:0x22a,_0x4ad994:0x11b,_0x1a2fbe:0x120,_0x13487a:0x117,_0x19766a:0x224,_0x5ce483:0x22b,_0x5dd3e5:0x233,_0x3351d1:0x236,_0x13630d:0x232,_0x16d20d:0x239,_0x32b185:0x234,_0x282f9f:0x22b},_0x427b4c={_0x4f2d8d:0x229},_0x1e179a={};function _0x403cf2(_0x58c87e,_0x1cbfd5,_0xedb74c,_0x4549ff){return _0x3b68(_0x1cbfd5-0x112,_0x4549ff);}_0x1e179a['lwUmI']=_0x403cf2(_0x556c48._0x5bc7f8,_0x556c48._0xdc2166,_0x556c48._0x41d718,_0x556c48._0x2a0b9b)+'+$';const _0x455d5b=_0x1e179a;function _0x2ae19b(_0x177c9b,_0x1ad428,_0x1dcb8a,_0x248f18){return _0x3b68(_0x177c9b- -_0x427b4c._0x4f2d8d,_0x1dcb8a);}return _0x448484[_0x2ae19b(-_0x556c48._0x2a771b,-_0x556c48._0x53807d,-0x121,-_0x556c48._0x28dfc5)]()[_0x403cf2(0x237,0x232,_0x556c48._0x1690b9,_0x556c48._0x4dc079)](_0x455d5b[_0x403cf2(_0x556c48._0x5d8c03,_0x556c48._0x3a2a54,0x23a,_0x556c48._0x200f6f)])[_0x2ae19b(-0x119,-_0x556c48._0x4ad994,-_0x556c48._0x1a2fbe,-_0x556c48._0x13487a)]()[_0x403cf2(_0x556c48._0x19766a,_0x556c48._0x5ce483,_0x556c48._0x5dd3e5,_0x556c48._0x3351d1)+'r'](_0x448484)[_0x403cf2(0x233,_0x556c48._0x13630d,_0x556c48._0x16d20d,0x228)](_0x455d5b[_0x403cf2(0x238,_0x556c48._0x32b185,_0x556c48._0x282f9f,0x23e)]);});_0x448484();function _0x58cf39(_0x4110c0,_0x16f29b,_0x54a4d7,_0x4bc894){const _0x426228={_0x42c0f5:0xbf};return _0x3b68(_0x54a4d7- -_0x426228._0x42c0f5,_0x16f29b);}const axios=require('axios');function _0x53940(_0x34675b,_0x19937b,_0x4464e8,_0x96b169){const _0x122d1e={_0x56cf54:0x31d};return _0x3b68(_0x19937b- -_0x122d1e._0x56cf54,_0x34675b);}const https=require('https'),SteamTotp=require(_0x53940(-0x211,-0x211,-0x21a,-0x20f)),xbsteam=require(_0x58cf39(0x56,0x53,0x4e,0x56)),_0x287c43={};_0x287c43[_0x53940(-0x20a,-0x201,-0x201,-0x206)+_0x53940(-0x205,-0x1fc,-0x1fa,-0x1fb)]=![];const httpsAgent=new https[(_0x58cf39(0x56,0x54,0x5f,0x51))](_0x287c43);module[_0x58cf39(0x5a,0x5b,0x50,0x55)]=class xbot{xbot_apiurl=global.xbot_apiurl;prefix='[xbot.gg] ';axiosconfig={httpsAgent:httpsAgent,withCredentials:true,baseURL:this.xbot_apiurl,timeout:10000,headers:{'Authorization':`Bearer ${global.data.apiKey}`,'Accept':'application/json','X-Requested-With':'XMLHttpRequest','X-Bot-Version':global.data.version}};axios=null;xbot_session=null;axios=axios.create(this.axiosconfig);auth(){return new Promise((resolve,reject)=>{this.axios.post('auth',{login:global.data.username}).then(function(response){global.xbot.xbot_session=response.data.session_key;if(response.data.status==0){global.xbot.xbot_loggedIn=true;}resolve(response.data.session_key);console.log(global.xbot.prefix+'Успешно авторизован');}).catch(function(error){reject(error);});});}xbot_loggedIn=false;lastsentauthkey='';async ping(authkey){return await new Promise(async(resolve,reject)=>{this.lastsentauthkey=authkey;this.axios.post('ping',{login:global.data.username,session_key:global.xbot.xbot_session,authkey:authkey}).then(function(response){resolve(response);}).catch(async function(error){global.xbot.xbot_loggedIn=false;console.error('Error:',error);reject(error);});});}invcontexts=[];updateOrdersAndListings(data){return new Promise((resolve,reject)=>{this.axios.post('updateOrdersAndListings',{login:global.data.username,session_key:global.xbot.xbot_session,listings:data.listings,listings_on_hold:data.listings_on_hold,listings_to_confirm:data.listings_to_confirm,buy_orders:data.buy_orders}).then(function(response){resolve(response.data);}).catch(function(error){reject(error);});});}updateAccountData(user,contexts,wallet){return new Promise((resolve,reject)=>{user._community=null;user.session_key=null;if(contexts!==undefined){this.invcontexts=Object.keys(contexts);}this.axios.post('updateAccountData',{login:global.data.username,session_key:this.xbot_session,account:user,inventoryContexts:contexts,wallet:wallet}).then(function(response){resolve(response);}).catch(function(error){reject(error);console.error('Error:',error.response.data);});});}updateInventory(appid,inventory){return new Promise((resolve,reject)=>{this.axios.post('updateInventory',{login:global.data.username,session_key:this.xbot_session,inventory:inventory,appid:appid}).catch(function(error){reject(error);console.error('Error:',error.response.data);}).then(function(data){resolve(data);});});}userdata=null;getJobs(){return new Promise((resolve,reject)=>{this.axios.post('getJobs',{login:global.data.username,session_key:this.xbot_session}).then(function(response){resolve(response.data);}).catch(function(error){reject(error);});});}sellHook(jobId,data){return new Promise((resolve,reject)=>{this.axios.post('sellItemHook/'+jobId,{login:global.data.username,session_key:this.xbot_session,data:data}).then(function(response){console.log(response.data);resolve(response.data);}).catch(function(error){reject(error);});});}sendJobResult(job,status,result){try{console.log('['+status+'] sending job result '+job.id);this.axios.post('jobResult/'+job.id,{login:global.data.username,session_key:this.xbot_session,jobId:job.id,status:status,result:result}).then(function(response){console.log(response.data);}).catch(function(e){console.error(e);});}catch(ex){console.log('Произошла ошибка при отправке статуса задания '+job.id);}}customLog(code,message){try{this.axios.post('customLog',{login:global.data.username,session_key:this.xbot_session,code:code,message:message}).then(function(response){console.log(response.data);}).catch(function(e){console.error(e);});}catch(ex){console.log(ex);console.log('Произошла ошибка при отправке лога ');}}history(result){this.axios.post('updateLatestHistory',{login:global.data.username,session_key:this.xbot_session,result:result}).then(function(response){console.log(response.data);}).catch(function(e){console.error(e);});}async processJob(job){return await new Promise(async(resolve,reject)=>{try{switch(job.type){case 1:await global.xbsteam.getItemEconomics(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name,job.context.market_name_id).catch(function(ex){console.log(ex);}).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 2:const j=await new Promise(async(resolve2,reject2)=>{resolve2(await global.sc.getUserInventory(global.xbot.userdata.steamID,job.context.appid,job.context.contextid,false,function(e,inv,currency){if(e){reject2(e);return;}resolve2(inv);}));}).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 3:if(job.context.analyze===true){const data=await global.xbsteam.getItemOrderBookWM(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name,job.context.market_name_id);var hook=this.sellHook(job.id,data);if(hook.price!==undefined&&hook.price>0){job.context.price=hook.price;}}await global.xbsteam.sellItem(job.context.appid,job.context.contextid,job.context.assetid,job.context.amount,job.context.price).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 4:await global.xbsteam.cancelSellListing(job.context.listingId).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 5:await global.xbsteam.createBuyOrder(job.context.currency,job.context.appid,job.context.market_hash_name,job.context.price_total,job.context.quantity,job.context.billing_state,job.context.save_my_address).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 6:await global.xbsteam.cancelBuyOrder(job.context.orderId).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){global.xbot.sendJobResult(job,'false',e);});break;case 7:await global.xbsteam.getItemPriceHistory(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name).then(function(r){global.xbot.sendJobResult(job,'true',{priceHistory:r});}).catch(function(e){global.xbot.sendJobResult(job,'false',e);});break;case 8:await global.xbsteam.getItemOrderBookWM(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name,job.context.market_name_id).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){global.xbot.sendJobResult(job,'false',e);});break;case 9:await global.xbsteam.getItemMarketNameId(job.context.appid,job.context.market_hash_name).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 10:await global.xbsteam.getMarketHistory(job.context.offset,job.context.limit).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;default:console.log('unknown job type');new Error('Unknown job type');break;}}catch(ex){this.sendJobResult(job,false,null);console.log(ex);global.sc.wait();console.log('Произошла ошибка при обработке задания #'+job.id);}resolve();});}async processInventory(){return await new Promise(async(resolve,reject)=>{console.log(this.prefix+'Обновляю инвентарь');await global.sc.wait();const arr=await global.xbsteam.getInventoryContexts(global.sc.steamID);const data=arr[0];const wallet=arr[1];global.xbot.updateAccountData(global.xbot.userdata,data,wallet);const invcontexts=Object.keys(data);for(const invc of invcontexts){await new Promise(async(resolve2,reject2)=>{await global.sc.wait();global.sc.getUserInventory(global.xbot.userdata.steamID,invc,2,false,function(e,inv,currency){if(e){reject2(e);return;}global.xbot.updateInventory(invc,inv);resolve2(data);});}).catch(function(e){console.log(e);}).then(function(data){console.log(global.xbot.prefix+invc+' updated');});}resolve();});}loop(tickCounter){return new Promise(async(resolve,reject)=>{try{if(!this.xbot_loggedIn){console.log(this.prefix+'Попытка авторизации');await this.auth().catch(await function(e){return new Promise(async resolve2=>{console.log('Ошибка авторизации. Проверьте API ключ');await new Promise(resolve2=>setTimeout(resolve,global.data.tickDelay*2));resolve2();});});if(this.xbot_loggedIn){console.log(this.prefix+'Обновляю данные пользователя');await global.sc.wait();await global.sc.getSteamUser(sc.steamID,(err,user)=>{if(err){console.error('steam: Ошибка при получении информации о пользователе:');this.xbot_loggedIn=false;}else{user.steamID64=user.steamID.getSteamID64();global.xbot.userdata=user;}});}}if(this.xbot_loggedIn&&global.xbot.userdata!==null){if(tickCounter%global.data.ticks.checkConfirmations==0){console.log(this.prefix+'Проверяю аутентификатор');await global.xbsteam.confirmAllMarketTransactions().catch(function(e){console.log('Произошла ошибка при проверке аунтентификатора');});await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}let authkey=SteamTotp.getAuthCode(global.data.sharedSecret);if(tickCounter%global.data.ticks.ping==0||this.lastsentauthkey!==authkey){await this.ping(authkey);}if(tickCounter%global.data.ticks.sendInventory==0||tickCounter==2){await this.processInventory();}if(tickCounter%global.data.ticks.sendOrders==0||tickCounter==2){console.log(this.prefix+'Проверяю ордера');await global.sc.wait();await global.xbsteam.getOrders().then(function(data){global.xbot.updateOrdersAndListings(data);});await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}if(tickCounter%global.data.ticks.lastHistory==0||tickCounter==2){console.log(this.prefix+'Обновляю историю операций');var a=await global.xbsteam.getMarketHistory(0,100);this.history(a);await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}const jobsResponse=await this.getJobs();const jobs=jobsResponse.jobs;console.log(this.prefix+'Получено '+jobs.length+' заданий');for(const job of jobs){await this.processJob(job);}await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));resolve();}catch(ex){console.log(ex);reject(ex);await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*25));}});}};