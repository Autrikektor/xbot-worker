(function(_0x3c974e,_0x1a96c5){const _0x401fec={_0x43faeb:0x84,_0x288afa:0x90,_0xaeaf87:0x9b,_0x2a3d45:0x91,_0x1087e2:0x24f,_0x47f690:0x24d,_0x1e3ec8:0x24a,_0x36f012:0x258,_0x49dfa2:0x25a,_0x114b40:0x266,_0x215aa5:0x24e,_0x3a88a8:0x255,_0x444ddf:0x252,_0x3006a6:0x91,_0x4bd4aa:0x98,_0x49688c:0xa1,_0x5da57e:0xa3,_0x5c37bb:0x256,_0x2addfe:0x254,_0x3fe8af:0x25c,_0x264cde:0x95,_0x38df9d:0xa1,_0x467ef4:0x258,_0xb3533a:0x24c,_0x2f49e2:0x252,_0x540f5d:0x251,_0x110dd0:0x8a,_0x8a098f:0x88,_0x33d092:0x8b},_0x5b5702={_0x2f7277:0x2cf};function _0x455b6e(_0x5528bb,_0x343ed2,_0x5dd73e,_0x51e363){return _0xb322(_0x343ed2- -0x10c,_0x5dd73e);}function _0x2392ce(_0x356df7,_0x364316,_0x11adc3,_0x2ea8fd){return _0xb322(_0x11adc3- -_0x5b5702._0x2f7277,_0x364316);}const _0x4f7391=_0x3c974e();while(!![]){try{const _0x24265f=-parseInt(_0x455b6e(-_0x401fec._0x43faeb,-_0x401fec._0x288afa,-_0x401fec._0xaeaf87,-_0x401fec._0x2a3d45))/(-0x1*0x1231+-0x16d+0x139f)*(parseInt(_0x2392ce(-0x24c,-_0x401fec._0x1087e2,-_0x401fec._0x47f690,-_0x401fec._0x1e3ec8))/(-0xd6a+-0x1731*-0x1+0x1*-0x9c5))+parseInt(_0x2392ce(-0x251,-_0x401fec._0x36f012,-_0x401fec._0x49dfa2,-_0x401fec._0x114b40))/(0xb94+-0x26*0xa7+0xd39)+-parseInt(_0x2392ce(-_0x401fec._0x215aa5,-_0x401fec._0x3a88a8,-_0x401fec._0x1087e2,-_0x401fec._0x444ddf))/(-0xfaf+-0xc04*-0x2+0x855*-0x1)+parseInt(_0x455b6e(-_0x401fec._0x3006a6,-_0x401fec._0x4bd4aa,-_0x401fec._0x49688c,-_0x401fec._0x5da57e))/(0x2*-0x1355+-0x1*-0x1d43+0x96c)*(parseInt(_0x2392ce(-_0x401fec._0x5c37bb,-_0x401fec._0x2addfe,-_0x401fec._0x3fe8af,-_0x401fec._0x444ddf))/(0x1de0+0xbb9*0x3+-0x4105))+parseInt(_0x455b6e(-_0x401fec._0x264cde,-_0x401fec._0x264cde,-0x9c,-_0x401fec._0x38df9d))/(0x304*-0x1+-0x2ac*0x3+-0x1*-0xb0f)+parseInt(_0x2392ce(-_0x401fec._0x467ef4,-_0x401fec._0xb3533a,-_0x401fec._0x2f49e2,-_0x401fec._0x540f5d))/(0x193d*0x1+0x16e0+0x175*-0x21)+-parseInt(_0x455b6e(-_0x401fec._0x110dd0,-_0x401fec._0x8a098f,-_0x401fec._0x33d092,-0x86))/(0x7b3+0x1*0x262b+-0x1*0x2dd5);if(_0x24265f===_0x1a96c5)break;else _0x4f7391['push'](_0x4f7391['shift']());}catch(_0x23fc1c){_0x4f7391['push'](_0x4f7391['shift']());}}}(_0x97a0,-0x2a63*0x53+-0x10b80d+0x2a70b9));function _0xb322(_0x3d7f07,_0x377b9c){const _0xe6821a=_0x97a0();return _0xb322=function(_0x20e529,_0x606bb){_0x20e529=_0x20e529-(0x1d36+0x3*0x2b+-0x1d46);let _0x14a950=_0xe6821a[_0x20e529];if(_0xb322['HpNCRZ']===undefined){var _0x843b4c=function(_0x59c5c2){const _0x5ddd3d='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x25dd41='',_0x4f7646='',_0x1c7572=_0x25dd41+_0x843b4c;for(let _0x33aaed=-0x1de6+-0x1*0x246b+0x161b*0x3,_0x343c79,_0x1b1e29,_0x48d940=0xd13+-0x1d10+0xffd;_0x1b1e29=_0x59c5c2['charAt'](_0x48d940++);~_0x1b1e29&&(_0x343c79=_0x33aaed%(0xe86+-0x287*-0xb+-0x2a4f*0x1)?_0x343c79*(-0x243e*0x1+0xc8f+-0x22d*-0xb)+_0x1b1e29:_0x1b1e29,_0x33aaed++%(-0x3a2*0xa+-0x4c1*0x2+0x2dda))?_0x25dd41+=_0x1c7572['charCodeAt'](_0x48d940+(0x5*0x227+0xd*-0x66+0xb*-0x81))-(0x1*0xe61+0x23d7+0x322e*-0x1)!==-0x3*-0x4ca+0x31a*0x5+-0x10*0x1de?String['fromCharCode'](-0x1*-0x20c5+0x16*0x2c+-0x238e&_0x343c79>>(-(-0x15*0xc4+-0x1*-0x22f6+-0x12e0)*_0x33aaed&0x6*0x580+0x2508+-0x4602)):_0x33aaed:-0x246e+0x90b+0x1b63*0x1){_0x1b1e29=_0x5ddd3d['indexOf'](_0x1b1e29);}for(let _0x10aace=-0xec4+-0xd6d*-0x1+0x157,_0x314f4f=_0x25dd41['length'];_0x10aace<_0x314f4f;_0x10aace++){_0x4f7646+='%'+('00'+_0x25dd41['charCodeAt'](_0x10aace)['toString'](0x2f*-0x83+0x4*-0x749+-0x1*-0x3541))['slice'](-(-0x520+0xfac+-0x545*0x2));}return decodeURIComponent(_0x4f7646);};_0xb322['yxjywN']=_0x843b4c,_0x3d7f07=arguments,_0xb322['HpNCRZ']=!![];}const _0x3f8d3a=_0xe6821a[-0x10bd+0x49*0x4d+-0x29c*0x2],_0x189040=_0x20e529+_0x3f8d3a,_0x57e678=_0x3d7f07[_0x189040];if(!_0x57e678){const _0x1d5ed6=function(_0x477f4b){this['GGxfzJ']=_0x477f4b,this['viiGyf']=[0x1d*0xc9+-0x10*0x180+0x2*0x9e,0xc1b+0x174b+-0x2366,0x1f*-0x2+-0x843+0x881],this['lyqDST']=function(){return'newState';},this['DlKFMx']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['vkwTpV']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x1d5ed6['prototype']['DAnaOI']=function(){const _0x468acd=new RegExp(this['DlKFMx']+this['vkwTpV']),_0x198469=_0x468acd['test'](this['lyqDST']['toString']())?--this['viiGyf'][-0x3*0x817+0x1cd5+-0x48f]:--this['viiGyf'][0x15b5+-0x8fb*-0x1+0x10*-0x1eb];return this['dSgXGX'](_0x198469);},_0x1d5ed6['prototype']['dSgXGX']=function(_0x1e24e6){if(!Boolean(~_0x1e24e6))return _0x1e24e6;return this['rGVMDH'](this['GGxfzJ']);},_0x1d5ed6['prototype']['rGVMDH']=function(_0x4e8fc5){for(let _0x39cb47=0x15*0xbf+0x9a*-0x27+0x7cb,_0x4d86c7=this['viiGyf']['length'];_0x39cb47<_0x4d86c7;_0x39cb47++){this['viiGyf']['push'](Math['round'](Math['random']())),_0x4d86c7=this['viiGyf']['length'];}return _0x4e8fc5(this['viiGyf'][-0x2*-0x10df+0x5*-0x697+-0x7*0x1d]);},new _0x1d5ed6(_0xb322)['DAnaOI'](),_0x14a950=_0xb322['yxjywN'](_0x14a950),_0x3d7f07[_0x189040]=_0x14a950;}else _0x14a950=_0x57e678;return _0x14a950;},_0xb322(_0x3d7f07,_0x377b9c);}const _0x3c1d87=(function(){const _0x1aa086={_0x56524d:0x3d6,_0x533196:0x3ce,_0x4e9ad8:0x3c3,_0x3e7860:0x3bb},_0x40911a={_0x90a9ed:0x3fd,_0x2d671c:0x3f9,_0x52a872:0x3f6,_0x3749cf:0x404,_0x2966d8:0x3fe,_0x366c9b:0x401},_0x3eabf3={_0x5917f5:0x38b},_0x373961={_0x54b956:0x346},_0x3c89a5={};_0x3c89a5[_0x5530dd(0x3c9,_0x1aa086._0x56524d,_0x1aa086._0x533196,_0x1aa086._0x533196)]=_0x5530dd(0x3b3,_0x1aa086._0x4e9ad8,_0x1aa086._0x3e7860,0x3be);const _0x42b07d=_0x3c89a5;function _0x5530dd(_0x366f55,_0x53422e,_0x3428b6,_0x38dbe4){return _0xb322(_0x38dbe4-_0x373961._0x54b956,_0x3428b6);}function _0xcec1b7(_0x3cf10a,_0x229940,_0x2adfb4,_0x9ec8d8){return _0xb322(_0x9ec8d8-_0x3eabf3._0x5917f5,_0x3cf10a);}let _0x2fc3be=!![];return function(_0x492c1f,_0x3a3682){const _0x3750b2={_0x563ed1:0x3fc,_0x32aa72:0x402,_0x3a9a54:0x1eb,_0x48cb46:0x1e0,_0x335ce3:0x1f3,_0x3d8017:0x1e3,_0x332518:0x1ed,_0x307d36:0x1ed},_0x18997e={_0x1684bb:0x3e,_0x264f9b:0x4cb,_0x3ed703:0x3},_0x5de524={_0x2b1021:0x1e1},_0x1d8b69={_0x447a2f:0x10a,_0x54bae8:0x38};function _0x1ced06(_0xeee24a,_0x594f8b,_0x2b192a,_0x5ab481){return _0x5530dd(_0xeee24a-0x74,_0x594f8b-_0x1d8b69._0x447a2f,_0x5ab481,_0x594f8b-_0x1d8b69._0x54bae8);}const _0x5f4888={};_0x5f4888[_0x1ced06(0x402,_0x40911a._0x90a9ed,_0x40911a._0x2d671c,_0x40911a._0x52a872)]=function(_0x337b57,_0x2b80e0){return _0x337b57===_0x2b80e0;};function _0x509c60(_0x1a251c,_0x5b9bf2,_0x1f4db9,_0x121d54){return _0xcec1b7(_0x1f4db9,_0x5b9bf2-_0x5de524._0x2b1021,_0x1f4db9-0x1f2,_0x5b9bf2- -0x4d3);}_0x5f4888[_0x1ced06(_0x40911a._0x3749cf,0x3f9,_0x40911a._0x2966d8,_0x40911a._0x366c9b)]=_0x42b07d['AhogW'];const _0x50afbd=_0x5f4888,_0x1e45ed=_0x2fc3be?function(){const _0x5ca0e5={_0x520c45:0x1ee,_0x517dad:0x11e};function _0x48e78d(_0x449966,_0x42e745,_0x195c41,_0x321ebf){return _0x509c60(_0x449966-_0x5ca0e5._0x520c45,_0x449966- -_0x5ca0e5._0x517dad,_0x195c41,_0x321ebf-0x32);}function _0x4c2aee(_0xab091f,_0x31dfa5,_0x16e690,_0x28c59d){return _0x509c60(_0xab091f-_0x18997e._0x1684bb,_0x31dfa5-_0x18997e._0x264f9b,_0xab091f,_0x28c59d-_0x18997e._0x3ed703);}if(_0x50afbd[_0x4c2aee(_0x3750b2._0x563ed1,_0x3750b2._0x32aa72,0x402,_0x3750b2._0x563ed1)](_0x50afbd['WABHB'],_0x50afbd[_0x48e78d(-_0x3750b2._0x3a9a54,-_0x3750b2._0x48cb46,-_0x3750b2._0x335ce3,-_0x3750b2._0x3d8017)])){if(_0x3a3682){const _0x213a40=_0x3a3682[_0x48e78d(-0x1ed,-_0x3750b2._0x332518,-_0x3750b2._0x335ce3,-_0x3750b2._0x307d36)](_0x492c1f,arguments);return _0x3a3682=null,_0x213a40;}}else _0x12c068.xbot.sendJobResult(_0x4c781d,'true',_0x148b79);}:function(){};return _0x2fc3be=![],_0x1e45ed;};}());function _0x97a0(){const _0x4d454c=['mJqXoda1otDpB0HnswC','C2vHCMnO','Dg9tDhjPBMC','zxHWB3j0CW','qwHVz1C','CMvQzwn0vw5HDq','q3D4ALm','otbjvw50zwS','nda3ntG1z0zOBMH0','mJi3odyXmxnSyLzwEG','Ahr0Chm','nZaZmJaWnev1Dhz1Cq','ENzIELC','yxbWBhK','lI9ZDgvHBq','v0fcsei','nZeYmJe5swPMAgD4','mta4mtGYmdbSthHquhu','yxHPB3m','wefcrgO','nJiWntC2rNHMCNvW','qwDLBNq','mNDJu1rPrq','DgHVCML6zwq'];_0x97a0=function(){return _0x4d454c;};return _0x97a0();}function _0x1b90fe(_0x5474c7,_0x59ba7c,_0x473139,_0x52278b){const _0x204d5a={_0x58f5fc:0x3a3};return _0xb322(_0x5474c7- -_0x204d5a._0x58f5fc,_0x473139);}const _0x3113bf=_0x3c1d87(this,function(){const _0x59a90a={_0x3781f2:0x38c,_0x3104ed:0x389,_0x16c262:0x39e,_0x5b8bd1:0x398,_0x38f7f9:0xc,_0x2df4cb:0x6,_0xbf60cd:0x9,_0x2961e0:0x397,_0x5d7757:0x390,_0x171c90:0x39d,_0x50e3a6:0x399,_0x52ec15:0x390,_0x5f28a3:0x3a0,_0x102f4b:0x3a3,_0x57489d:0x398},_0x1a5f8e={_0x4fac60:0x313},_0x55de1a={_0x1ec3bd:0x78},_0x429ec1={};_0x429ec1[_0x10cf75(_0x59a90a._0x3781f2,_0x59a90a._0x3104ed,0x391,0x385)]='(((.+)+)+)'+'+$';const _0x1243d3=_0x429ec1;function _0x56b88e(_0x5a2439,_0x7d0731,_0x3b9c5b,_0x59705e){return _0xb322(_0x3b9c5b- -_0x55de1a._0x1ec3bd,_0x5a2439);}function _0x10cf75(_0x1d36c6,_0x65b923,_0x8443d1,_0x5e0453){return _0xb322(_0x5e0453-_0x1a5f8e._0x4fac60,_0x65b923);}return _0x3113bf['toString']()[_0x10cf75(_0x59a90a._0x16c262,0x39b,0x39d,_0x59a90a._0x5b8bd1)](_0x1243d3[_0x56b88e(-_0x59a90a._0x38f7f9,-0xd,-_0x59a90a._0x2df4cb,-_0x59a90a._0xbf60cd)])[_0x10cf75(_0x59a90a._0x2961e0,_0x59a90a._0x5d7757,_0x59a90a._0x171c90,_0x59a90a._0x50e3a6)]()['constructo'+'r'](_0x3113bf)[_0x10cf75(_0x59a90a._0x52ec15,_0x59a90a._0x5f28a3,_0x59a90a._0x102f4b,_0x59a90a._0x57489d)](_0x1243d3['CwxjS']);});_0x3113bf();const axios=require(_0x1b90fe(-0x325,-0x329,-0x330,-0x327)),https=require(_0x344db9(0x30a,0x307,0x306,0x313)),SteamTotp=require('steam-totp'),xbsteam=require(_0x1b90fe(-0x329,-0x332,-0x335,-0x334)),_0x16af73={};_0x16af73[_0x1b90fe(-0x332,-0x32e,-0x33e,-0x33a)+_0x1b90fe(-0x320,-0x326,-0x327,-0x319)]=![];function _0x344db9(_0x200b49,_0x2cc16c,_0x4cd952,_0x508589){return _0xb322(_0x200b49-0x294,_0x2cc16c);}const httpsAgent=new https[(_0x344db9(0x315,0x309,0x30d,0x30c))](_0x16af73);module[_0x344db9(0x31b,0x31f,0x31b,0x323)]=class xbot{xbot_apiurl=global.xbot_apiurl;prefix='[xbot.gg] ';axiosconfig={httpsAgent:httpsAgent,withCredentials:true,baseURL:this.xbot_apiurl,timeout:10000,headers:{'Authorization':`Bearer ${global.data.apiKey}`,'Accept':'application/json','X-Requested-With':'XMLHttpRequest','X-Bot-Version':global.data.version}};axios=null;xbot_session=null;axios=axios.create(this.axiosconfig);auth(){return new Promise((resolve,reject)=>{this.axios.post('auth',{login:global.data.username}).then(function(response){global.xbot.xbot_session=response.data.session_key;if(response.data.status==0){global.xbot.xbot_loggedIn=true;}resolve(response.data.session_key);console.log(global.xbot.prefix+'Успешно авторизован');}).catch(function(error){reject(error);});});}xbot_loggedIn=false;lastsentauthkey='';async ping(authkey){return await new Promise(async(resolve,reject)=>{this.lastsentauthkey=authkey;this.axios.post('ping',{login:global.data.username,session_key:global.xbot.xbot_session,authkey:authkey}).then(function(response){resolve(response);}).catch(async function(error){global.xbot.xbot_loggedIn=false;console.error('Error:',error);reject(error);});});}invcontexts=[];updateOrdersAndListings(data){return new Promise((resolve,reject)=>{this.axios.post('updateOrdersAndListings',{login:global.data.username,session_key:global.xbot.xbot_session,listings:data.listings,listings_on_hold:data.listings_on_hold,listings_to_confirm:data.listings_to_confirm,buy_orders:data.buy_orders}).then(function(response){resolve(response.data);}).catch(function(error){reject(error);});});}updateAccountData(user,contexts,wallet){return new Promise((resolve,reject)=>{user._community=null;user.session_key=null;if(contexts!==undefined){this.invcontexts=Object.keys(contexts);}this.axios.post('updateAccountData',{login:global.data.username,session_key:this.xbot_session,account:user,inventoryContexts:contexts,wallet:wallet}).then(function(response){resolve(response);}).catch(function(error){reject(error);console.error('Error:',error.response.data);});});}updateInventory(appid,inventory){return new Promise((resolve,reject)=>{this.axios.post('updateInventory',{login:global.data.username,session_key:this.xbot_session,inventory:inventory,appid:appid}).catch(function(error){reject(error);console.error('Error:',error.response.data);}).then(function(data){resolve(data);});});}userdata=null;getJobs(){return new Promise((resolve,reject)=>{this.axios.post('getJobs',{login:global.data.username,session_key:this.xbot_session}).then(function(response){resolve(response.data);}).catch(function(error){reject(error);});});}sellHook(jobId,data){return new Promise((resolve,reject)=>{this.axios.post('sellItemHook/'+jobId,{login:global.data.username,session_key:this.xbot_session,data:data}).then(function(response){console.log(response.data);resolve(response.data);}).catch(function(error){reject(error);});});}sendJobResult(job,status,result){try{console.log('['+status+'] sending job result '+job.id);this.axios.post('jobResult/'+job.id,{login:global.data.username,session_key:this.xbot_session,jobId:job.id,status:status,result:result}).then(function(response){console.log(response.data);}).catch(function(e){console.error(e);});}catch(ex){console.log('Произошла ошибка при отправке статуса задания '+job.id);}}customLog(code,message){try{this.axios.post('customLog',{login:global.data.username,session_key:this.xbot_session,code:code,message:message}).then(function(response){console.log(response.data);}).catch(function(e){console.error(e);});}catch(ex){console.log(ex);console.log('Произошла ошибка при отправке лога ');}}history(result){this.axios.post('updateLatestHistory',{login:global.data.username,session_key:this.xbot_session,result:result}).then(function(response){console.log(response.data);}).catch(function(e){console.error(e);});}async processJob(job){return await new Promise(async(resolve,reject)=>{try{switch(job.type){case 1:await global.xbsteam.getItemEconomics(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name,job.context.market_name_id).catch(function(ex){console.log(ex);}).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 2:const j=await new Promise(async(resolve2,reject2)=>{resolve2(await global.sc.getUserInventory(global.xbot.userdata.steamID,job.context.appid,job.context.contextid,false,function(e,inv,currency){if(e){reject2(e);return;}resolve2(inv);}));}).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 3:if(job.context.analyze===true){const data=await global.xbsteam.getItemOrderBookWM(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name,job.context.market_name_id);var hook=this.sellHook(job.id,data);if(hook.price!==undefined&&hook.price>0){job.context.price=hook.price;}}await global.xbsteam.sellItem(job.context.appid,job.context.contextid,job.context.assetid,job.context.amount,job.context.price).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 4:await global.xbsteam.cancelSellListing(job.context.listingId).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 5:await global.xbsteam.createBuyOrder(job.context.currency,job.context.appid,job.context.market_hash_name,job.context.price_total,job.context.quantity,job.context.billing_state,job.context.save_my_address).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 6:await global.xbsteam.cancelBuyOrder(job.context.orderId).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){global.xbot.sendJobResult(job,'false',e);});break;case 7:await global.xbsteam.getItemPriceHistory(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name).then(function(r){global.xbot.sendJobResult(job,'true',{priceHistory:r});}).catch(function(e){global.xbot.sendJobResult(job,'false',e);});break;case 8:await global.xbsteam.getItemOrderBookWM(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name,job.context.market_name_id).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){global.xbot.sendJobResult(job,'false',e);});break;case 9:await global.xbsteam.getItemMarketNameId(job.context.appid,job.context.market_hash_name).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 10:await global.xbsteam.getMarketHistory(job.context.offset,job.context.limit).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;default:console.log('unknown job type');new Error('Unknown job type');break;}}catch(ex){this.sendJobResult(job,false,null);console.log(ex);global.sc.wait();console.log('Произошла ошибка при обработке задания #'+job.id);}resolve();});}async processInventory(){return await new Promise(async(resolve,reject)=>{console.log(this.prefix+'Обновляю инвентарь');await global.sc.wait();const arr=await global.xbsteam.getInventoryContexts(global.sc.steamID);const data=arr[0];const wallet=arr[1];global.xbot.updateAccountData(global.xbot.userdata,data,wallet);const invcontexts=Object.keys(data);for(const invc of invcontexts){await new Promise(async(resolve2,reject2)=>{await global.sc.wait();global.sc.getUserInventory(global.xbot.userdata.steamID,invc,2,false,function(e,inv,currency){if(e){reject2(e);return;}global.xbot.updateInventory(invc,inv);resolve2(data);});}).catch(function(e){console.log(e);}).then(function(data){console.log(global.xbot.prefix+invc+' updated');});}resolve();});}loop(tickCounter){return new Promise(async(resolve,reject)=>{try{if(!this.xbot_loggedIn){console.log(this.prefix+'Попытка авторизации');await this.auth().catch(await function(e){return new Promise(async resolve2=>{console.log('Ошибка авторизации. Проверьте API ключ');await new Promise(resolve2=>setTimeout(resolve,global.data.tickDelay*2));resolve2();});});if(this.xbot_loggedIn){console.log(this.prefix+'Обновляю данные пользователя');await global.sc.wait();await global.sc.getSteamUser(sc.steamID,(err,user)=>{if(err){console.error('steam: Ошибка при получении информации о пользователе:');this.xbot_loggedIn=false;}else{user.steamID64=user.steamID.getSteamID64();global.xbot.userdata=user;}});}}if(this.xbot_loggedIn&&global.xbot.userdata!==null){if(tickCounter%global.data.ticks.checkConfirmations==0){console.log(this.prefix+'Проверяю аутентификатор');await global.xbsteam.confirmAllMarketTransactions().catch(function(e){console.log('Произошла ошибка при проверке аунтентификатора');});await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}let authkey=SteamTotp.getAuthCode(global.data.sharedSecret);if(tickCounter%global.data.ticks.ping==0||this.lastsentauthkey!==authkey){await this.ping(authkey);}if(tickCounter%global.data.ticks.sendInventory==0||tickCounter==2){await this.processInventory();}if(tickCounter%global.data.ticks.sendOrders==0||tickCounter==2){console.log(this.prefix+'Проверяю ордера');await global.sc.wait();await global.xbsteam.getOrders().then(function(data){global.xbot.updateOrdersAndListings(data);});await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}if(tickCounter%global.data.ticks.lastHistory==0||tickCounter==2){console.log(this.prefix+'Обновляю историю операций');var a=await global.xbsteam.getMarketHistory(0,100);this.history(a);await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}const jobsResponse=await this.getJobs();const jobs=jobsResponse.jobs;console.log(this.prefix+'Получено '+jobs.length+' заданий');for(const job of jobs){await this.processJob(job);}await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));resolve();}catch(ex){console.log(ex);reject(ex);await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*25));}});}};