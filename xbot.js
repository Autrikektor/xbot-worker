(function(_0xf087e8,_0x188259){const _0x8c9764={_0x43a202:0x26f,_0xf69b23:0x279,_0x138551:0x27a,_0x426a18:0x3a2,_0x3e69a5:0x3a6,_0x1f581e:0x26d,_0x184b64:0x262,_0x186a22:0x26f,_0x578c86:0x264,_0x2f0908:0x3a9,_0x1c6608:0x3b1,_0x4dee7e:0x39a,_0x146388:0x396,_0x2c0eb3:0x39a,_0x1f5f42:0x39d,_0xfb72d3:0x27e,_0x3c38fe:0x26a,_0x5ce7cd:0x26a,_0x59278b:0x26e,_0x2d954d:0x38f,_0x5973fb:0x39b,_0x68dce5:0x3a4,_0x3c2cda:0x26a,_0x250174:0x275,_0x1b0fa0:0x277,_0xe787ad:0x399,_0x31256c:0x3a3,_0x14c01e:0x3ae,_0x518b15:0x3a8},_0x48f35b={_0x1a6ece:0x3a9};function _0x1b9c28(_0x26e0e7,_0xc23c77,_0x1eba8d,_0x3404dd){return _0x59c0(_0x3404dd-0x268,_0x26e0e7);}const _0x1cdba9=_0xf087e8();function _0x51b528(_0x8e0f9e,_0x18cb44,_0x37a894,_0x19b337){return _0x59c0(_0x19b337- -_0x48f35b._0x1a6ece,_0x18cb44);}while(!![]){try{const _0x19f155=parseInt(_0x51b528(-_0x8c9764._0x43a202,-_0x8c9764._0xf69b23,-0x284,-_0x8c9764._0x138551))/(0x1d93+0x11d8+-0xe*0x363)*(parseInt(_0x1b9c28(_0x8c9764._0x426a18,_0x8c9764._0x3e69a5,0x3a8,0x3b2))/(0x14b1*0x1+0x1b31+0x20*-0x17f))+-parseInt(_0x51b528(-0x27b,-_0x8c9764._0x1f581e,-_0x8c9764._0x184b64,-0x270))/(-0x6*0x18d+-0x3d0+0xd21)+-parseInt(_0x51b528(-0x25d,-0x256,-_0x8c9764._0x186a22,-_0x8c9764._0x578c86))/(0x9bb+0x12aa+-0x1c61)+-parseInt(_0x1b9c28(_0x8c9764._0x2f0908,0x39a,_0x8c9764._0x1c6608,0x3a9))/(0xca8+-0x8db+-0x3c8)+parseInt(_0x1b9c28(_0x8c9764._0x4dee7e,_0x8c9764._0x146388,_0x8c9764._0x2c0eb3,_0x8c9764._0x1f5f42))/(0x1ee0+-0x171c+-0x7be)+-parseInt(_0x51b528(-_0x8c9764._0xfb72d3,-_0x8c9764._0x3c38fe,-_0x8c9764._0x5ce7cd,-_0x8c9764._0x59278b))/(0x9b0+0x1864+-0x220d)*(-parseInt(_0x1b9c28(_0x8c9764._0x2d954d,_0x8c9764._0x5973fb,_0x8c9764._0x68dce5,0x395))/(-0x241d+0x171a+0xd0b))+-parseInt(_0x51b528(-_0x8c9764._0x3c2cda,-_0x8c9764._0xfb72d3,-_0x8c9764._0x250174,-_0x8c9764._0x1b0fa0))/(0x9*-0x2b1+0x21a2+-0x10*0x96)*(-parseInt(_0x1b9c28(_0x8c9764._0xe787ad,_0x8c9764._0x31256c,_0x8c9764._0x14c01e,_0x8c9764._0x518b15))/(-0x116*0x6+0xaef+-0x461));if(_0x19f155===_0x188259)break;else _0x1cdba9['push'](_0x1cdba9['shift']());}catch(_0x189170){_0x1cdba9['push'](_0x1cdba9['shift']());}}}(_0x3550,-0x32c62+0x4b6eb*0x1+0x1a167));const _0x57b996=(function(){const _0x548035={_0x4292d4:0x146,_0x41bb44:0x142,_0x406d48:0x133,_0x455049:0x149,_0x574921:0x144,_0x4708ca:0x152,_0x24b57b:0x14a,_0x39b19b:0x12a,_0x24dc36:0x12c,_0x4931a7:0x4f6,_0x3af7ba:0x13f,_0x412abd:0x13e,_0x38e6e7:0x134},_0x3e28a3={_0x1174f2:0x1f5,_0x3d4271:0x1ec,_0x3cf79d:0x1fb,_0x252eba:0x1f3,_0x45e247:0x1f8,_0x88e536:0x1f7,_0x44868e:0x301,_0x501c7b:0x304,_0x215ff7:0x313,_0x52d06d:0x1f9,_0x3ee1f0:0x1f6,_0x248b7d:0x1f7,_0x70d9e2:0x1fa},_0x58761c={_0xd6e38c:0x3a6,_0x3ab271:0x3a5,_0x1cd3c8:0x3a6,_0x16404e:0x6a,_0x1dbdc0:0x74,_0x5b83af:0x73,_0x508121:0x82,_0x33afb2:0x395,_0x3da611:0x396,_0x3132d8:0x399},_0x5cd067={_0x3070b6:0x167,_0x49ac36:0x16d,_0x501415:0x15e,_0x5debb5:0x177},_0xef5966={_0x598987:0xc7,_0x5b26d6:0x446,_0x4279ff:0x1c9},_0x43ff65={_0x45a6eb:0x275},_0x5a7f6b={_0x2aa813:0x3bd},_0x5e127a={};_0x5e127a['DHvkQ']=function(_0x4694de,_0x2e2924){return _0x4694de!==_0x2e2924;};function _0x19b403(_0x3ca5f3,_0x56635a,_0x152b3d,_0x3c40ff){return _0x59c0(_0x152b3d-_0x5a7f6b._0x2aa813,_0x3c40ff);}_0x5e127a[_0x3fcccc(-_0x548035._0x4292d4,-_0x548035._0x41bb44,-_0x548035._0x406d48,-_0x548035._0x455049)]='HrfOd',_0x5e127a[_0x3fcccc(-0x149,-_0x548035._0x574921,-_0x548035._0x4708ca,-_0x548035._0x24b57b)]=_0x3fcccc(-_0x548035._0x39b19b,-_0x548035._0x39b19b,-_0x548035._0x24dc36,-0x130),_0x5e127a['eTOyH']=function(_0x36e545,_0x629163){return _0x36e545===_0x629163;},_0x5e127a[_0x19b403(0x509,0x50a,0x4ff,_0x548035._0x4931a7)]=_0x3fcccc(-_0x548035._0x3af7ba,-_0x548035._0x412abd,-_0x548035._0x38e6e7,-0x146);const _0x4b3f7b=_0x5e127a;let _0x572723=!![];function _0x3fcccc(_0x253f48,_0x11a49c,_0x30843c,_0x598612){return _0x59c0(_0x11a49c- -_0x43ff65._0x45a6eb,_0x30843c);}return function(_0x45166c,_0x2b856f){const _0x5b92a5={_0x218e65:0x182,_0x50e7f4:0x190},_0x2a94c8={_0xdede0f:0x194,_0x5127cb:0xa7},_0x269a8d={_0x56fb0a:0xf3,_0x2c43e1:0x7d,_0x53deb7:0x2fb},_0x388242={_0x370dcb:0xe0,_0x5bf683:0xed},_0x24d02e={_0x49206a:0x176};function _0x4b90ae(_0x43d8ed,_0x2f29ef,_0x14fb09,_0x2882c3){return _0x3fcccc(_0x43d8ed-_0xef5966._0x598987,_0x2f29ef-_0xef5966._0x5b26d6,_0x43d8ed,_0x2882c3-_0xef5966._0x4279ff);}const _0x55d96e={'ODcMX':function(_0x492a29,_0x87afaa){const _0x2c5d79={_0x4975c0:0x24};function _0x4fbfb0(_0x146a59,_0x11bdd2,_0xa6c378,_0x3ea138){return _0x59c0(_0x146a59-_0x2c5d79._0x4975c0,_0x11bdd2);}return _0x4b3f7b[_0x4fbfb0(_0x5cd067._0x3070b6,_0x5cd067._0x49ac36,_0x5cd067._0x501415,_0x5cd067._0x5debb5)](_0x492a29,_0x87afaa);},'KjWKm':_0x4b3f7b[_0x54c426(_0x3e28a3._0x1174f2,_0x3e28a3._0x3d4271,0x200,_0x3e28a3._0x3cf79d)],'lYdGS':function(_0x5b0932,_0x3b6614){function _0x2f0ac9(_0x2ac385,_0xf3a80c,_0x389e5d,_0x2d4b00){return _0x54c426(_0x2d4b00- -0x11c,_0xf3a80c-_0x24d02e._0x49206a,_0x389e5d-0x14d,_0x2ac385);}return _0x4b3f7b[_0x2f0ac9(_0x388242._0x370dcb,_0x388242._0x5bf683,0xec,0xe9)](_0x5b0932,_0x3b6614);},'uUVND':_0x4b3f7b[_0x54c426(_0x3e28a3._0x252eba,0x1e5,_0x3e28a3._0x45e247,_0x3e28a3._0x88e536)]};function _0x54c426(_0x1268a7,_0x1327b2,_0x3adfe9,_0x292223){return _0x19b403(_0x1268a7-_0x269a8d._0x56fb0a,_0x1327b2-_0x269a8d._0x2c43e1,_0x1268a7- -_0x269a8d._0x53deb7,_0x292223);}if(_0x4b3f7b[_0x4b90ae(_0x3e28a3._0x44868e,0x30f,_0x3e28a3._0x501c7b,_0x3e28a3._0x215ff7)](_0x54c426(_0x3e28a3._0x52d06d,_0x3e28a3._0x3ee1f0,_0x3e28a3._0x248b7d,_0x3e28a3._0x70d9e2),_0x4b3f7b['LXQWG'])){const _0x291fd2=_0x572723?function(){function _0x3457e2(_0x239e4b,_0x19a3ec,_0x29ce57,_0x263e27){return _0x54c426(_0x19a3ec- -_0x2a94c8._0xdede0f,_0x19a3ec-_0x2a94c8._0x5127cb,_0x29ce57-0x141,_0x263e27);}function _0x3c5072(_0x545881,_0x34017c,_0x31a636,_0x1762b0){return _0x54c426(_0x545881-0x1a5,_0x34017c-_0x5b92a5._0x218e65,_0x31a636-_0x5b92a5._0x50e7f4,_0x1762b0);}if(_0x55d96e[_0x3c5072(_0x58761c._0xd6e38c,_0x58761c._0x3ab271,_0x58761c._0x1cd3c8,0x398)](_0x3457e2(_0x58761c._0x16404e,_0x58761c._0x1dbdc0,_0x58761c._0x5b83af,_0x58761c._0x508121),_0x55d96e[_0x3c5072(_0x58761c._0x33afb2,0x3a3,0x385,_0x58761c._0x3da611)]))_0xebf5ad.xbot.updateOrdersAndListings(_0x279bf2);else{if(_0x2b856f){if(_0x55d96e[_0x3c5072(0x39f,0x3a0,0x39c,_0x58761c._0x3132d8)](_0x55d96e['uUVND'],_0x55d96e[_0x3457e2(0x68,0x76,0x83,0x71)]))_0x47080a(_0x515080);else{const _0xe1b167=_0x2b856f['apply'](_0x45166c,arguments);return _0x2b856f=null,_0xe1b167;}}}}:function(){};return _0x572723=![],_0x291fd2;}else this.axios.post('getJobs',{login:_0x19e61c.data.username,session_key:this.xbot_session}).then(function(response){_0x25a35d(response.data);}).catch(function(error){_0x509d98(error);});};}()),_0x1cb505=_0x57b996(this,function(){const _0x35a3ab={_0x220e73:0x25a,_0x528beb:0x25f,_0x2530fa:0x254,_0xb74ee7:0x255,_0x3a0344:0x24f,_0x337603:0x23f,_0x3bf2f0:0x24b,_0x42fdee:0x150,_0x3d5a39:0x14d,_0x3ba7bf:0x14c,_0xb09500:0x266,_0x10dd08:0x261,_0x312de9:0x264},_0x2fd3b7={_0x54587c:0x286},_0x14cdf1={_0xc80631:0x11b};function _0x2c0e0e(_0x376e2a,_0x1d1a5c,_0x4e2a70,_0x5ee6e2){return _0x59c0(_0x5ee6e2-_0x14cdf1._0xc80631,_0x4e2a70);}function _0x567d48(_0x47f82a,_0x252369,_0x532b63,_0xa30a1b){return _0x59c0(_0xa30a1b- -_0x2fd3b7._0x54587c,_0x47f82a);}const _0x5a99f1={};_0x5a99f1[_0x2c0e0e(_0x35a3ab._0x220e73,_0x35a3ab._0x528beb,_0x35a3ab._0x2530fa,_0x35a3ab._0xb74ee7)]='(((.+)+)+)'+'+$';const _0x56c4c8=_0x5a99f1;return _0x1cb505[_0x2c0e0e(_0x35a3ab._0x3a0344,0x241,_0x35a3ab._0x337603,_0x35a3ab._0x3bf2f0)]()['search'](_0x56c4c8[_0x567d48(-_0x35a3ab._0x42fdee,-_0x35a3ab._0x3d5a39,-_0x35a3ab._0x3ba7bf,-_0x35a3ab._0x3ba7bf)])['toString']()['constructo'+'r'](_0x1cb505)[_0x2c0e0e(0x270,_0x35a3ab._0xb09500,_0x35a3ab._0x10dd08,_0x35a3ab._0x312de9)]('(((.+)+)+)'+'+$');});_0x1cb505();const axios=require(_0x281fd5(-0x22d,-0x233,-0x235,-0x236));function _0x281fd5(_0x168165,_0x469bdf,_0x3bb58e,_0x1c369b){const _0x2cc733={_0x24afa1:0x37a};return _0x59c0(_0x469bdf- -_0x2cc733._0x24afa1,_0x168165);}const https=require(_0x281fd5(-0x23a,-0x23d,-0x23c,-0x240)),SteamTotp=require(_0x128ea6(0x513,0x512,0x51c,0x507)),xbsteam=require(_0x128ea6(0x50e,0x502,0x505,0x4f8)),_0x248679={};function _0x59c0(_0x35da31,_0x55c3fd){const _0x544007=_0x3550();return _0x59c0=function(_0x2f9f56,_0x36a90c){_0x2f9f56=_0x2f9f56-(-0x12*-0x13a+0x2*-0xfc3+0x1*0xa9f);let _0x3b4739=_0x544007[_0x2f9f56];if(_0x59c0['otrZHV']===undefined){var _0x553d67=function(_0xcb0be){const _0xe53bb0='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x159f60='',_0x133696='',_0x189f64=_0x159f60+_0x553d67;for(let _0x54aefe=0x2a*0x8c+-0x1*-0x1dc1+-0x34b9,_0x280232,_0x47080a,_0x515080=0x251a+0x4*-0x5e6+-0x85*0x1a;_0x47080a=_0xcb0be['charAt'](_0x515080++);~_0x47080a&&(_0x280232=_0x54aefe%(-0x2*0x6a4+0x15a5*-0x1+-0x5*-0x6fd)?_0x280232*(0x18de+0x2*-0x31a+-0x126a)+_0x47080a:_0x47080a,_0x54aefe++%(0x39*-0x16+-0x7a5*0x1+0xc8f))?_0x159f60+=_0x189f64['charCodeAt'](_0x515080+(0x115*0x1b+-0x1*0xf15+-0xe18))-(-0x25b7+0x32*-0x13+0x2977*0x1)!==-0x14f0+0x2*-0x12da+0x3aa4?String['fromCharCode'](0x18df+0xe24+0x3*-0xcac&_0x280232>>(-(-0x5*-0x57c+0xe17*0x1+-0x11*0x271)*_0x54aefe&0x1*-0x25be+-0x2fd*0x6+0x37b2)):_0x54aefe:0x8*0x10c+-0x2334+0x1ad4){_0x47080a=_0xe53bb0['indexOf'](_0x47080a);}for(let _0xea759e=-0x7ed*-0x1+0xd3b+-0x1528,_0x9af3ed=_0x159f60['length'];_0xea759e<_0x9af3ed;_0xea759e++){_0x133696+='%'+('00'+_0x159f60['charCodeAt'](_0xea759e)['toString'](-0x487+0x1*-0x1f83+0x2*0x120d))['slice'](-(-0x7d1+-0x1515+0x64*0x4a));}return decodeURIComponent(_0x133696);};_0x59c0['AgroGf']=_0x553d67,_0x35da31=arguments,_0x59c0['otrZHV']=!![];}const _0xfb48d0=_0x544007[-0xdd8*-0x1+0x13af*0x1+0x1*-0x2187],_0x4407d9=_0x2f9f56+_0xfb48d0,_0x1695d1=_0x35da31[_0x4407d9];if(!_0x1695d1){const _0x1c1d12=function(_0x270874){this['yKqrPD']=_0x270874,this['hugNzX']=[-0x21b4+0x26a7*-0x1+0x242e*0x2,0x17*0x1+0xf94+-0xfab*0x1,0x1021+0x317+-0x1338],this['olappQ']=function(){return'newState';},this['mwvItf']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['yPvEhG']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x1c1d12['prototype']['htbuZR']=function(){const _0x9b8d98=new RegExp(this['mwvItf']+this['yPvEhG']),_0xb39a76=_0x9b8d98['test'](this['olappQ']['toString']())?--this['hugNzX'][0xd13+0xdc2+0x2*-0xd6a]:--this['hugNzX'][0x11c3*0x2+0x19cb+0x3d51*-0x1];return this['HSaADa'](_0xb39a76);},_0x1c1d12['prototype']['HSaADa']=function(_0xdb9cac){if(!Boolean(~_0xdb9cac))return _0xdb9cac;return this['gEpTxt'](this['yKqrPD']);},_0x1c1d12['prototype']['gEpTxt']=function(_0x7e30b){for(let _0x4522b9=-0x1fd7+-0x170*-0x1+-0xb5*-0x2b,_0x53993f=this['hugNzX']['length'];_0x4522b9<_0x53993f;_0x4522b9++){this['hugNzX']['push'](Math['round'](Math['random']())),_0x53993f=this['hugNzX']['length'];}return _0x7e30b(this['hugNzX'][0xbad+-0x65*0x3+-0xa7e]);},new _0x1c1d12(_0x59c0)['htbuZR'](),_0x3b4739=_0x59c0['AgroGf'](_0x3b4739),_0x35da31[_0x4407d9]=_0x3b4739;}else _0x3b4739=_0x1695d1;return _0x3b4739;},_0x59c0(_0x35da31,_0x55c3fd);}_0x248679['rejectUnau'+_0x281fd5(-0x244,-0x23e,-0x233,-0x246)]=![];const httpsAgent=new https['Agent'](_0x248679);function _0x128ea6(_0xf9afef,_0x461718,_0x194cc2,_0x1cf2fa){return _0x59c0(_0x461718-0x3ce,_0xf9afef);}function _0x3550(){const _0x417ad3=['vgzpvKG','mtq4mdKWnMLfzLfRzq','DgHVCML6zwq','Ahr0Chm','zvrpEuG','t0rJtvG','nZG1ntyXmhvstxn3rG','nZqWodq1Cgjyre1g','tfHrv0C','reH2A1e','C3rLyw0TDg90Ca','mtm4mZuZmMDXBNPfBa','shjMt2q','yxHPB3m','DvvwtKq','C2vHCMnO','mtmYnJrhwgHNDMi','Bxz3tfi','ognTsLvJsa','s2Pxs20','mvvAs011Da','Dg9tDhjPBMC','AuL1tfu','owHpwM5qsW','CNzky3e','lI9ZDgvHBq','mZe5otyYEfbPuM9g','zxHWB3j0CW','rffHt0e','BfLKr1m','mta2ntuXme1cB09izq'];_0x3550=function(){return _0x417ad3;};return _0x3550();}module[_0x281fd5(-0x237,-0x244,-0x249,-0x251)]=class xbot{xbot_apiurl=global.xbot_apiurl;prefix='[xbot.gg] ';axiosconfig={httpsAgent:httpsAgent,withCredentials:true,baseURL:this.xbot_apiurl,timeout:10000,headers:{'Authorization':`Bearer ${global.data.apiKey}`,'Accept':'application/json','X-Requested-With':'XMLHttpRequest','X-Bot-Version':global.data.version}};axios=null;xbot_session=null;axios=axios.create(this.axiosconfig);auth(){return new Promise((resolve,reject)=>{this.axios.post('auth',{login:global.data.username}).then(function(response){global.xbot.xbot_session=response.data.session_key;if(response.data.status==0){global.xbot.xbot_loggedIn=true;}resolve(response.data.session_key);console.log(global.xbot.prefix+'Успешно авторизован');}).catch(function(error){reject(error);});});}xbot_loggedIn=false;lastsentauthkey='';async ping(authkey){return await new Promise(async(resolve,reject)=>{this.lastsentauthkey=authkey;this.axios.post('ping',{login:global.data.username,session_key:global.xbot.xbot_session,authkey:authkey}).then(function(response){resolve(response);}).catch(async function(error){global.xbot.xbot_loggedIn=false;console.error('Error:',error);reject(error);});});}invcontexts=[];updateOrdersAndListings(data){return new Promise((resolve,reject)=>{this.axios.post('updateOrdersAndListings',{login:global.data.username,session_key:global.xbot.xbot_session,listings:data.listings,listings_on_hold:data.listings_on_hold,listings_to_confirm:data.listings_to_confirm,buy_orders:data.buy_orders}).then(function(response){resolve(response.data);}).catch(function(error){reject(error);});});}updateAccountData(user,contexts,wallet){return new Promise((resolve,reject)=>{user._community=null;user.session_key=null;if(contexts!==undefined){this.invcontexts=Object.keys(contexts);}this.axios.post('updateAccountData',{login:global.data.username,session_key:this.xbot_session,account:user,inventoryContexts:contexts,wallet:wallet}).then(function(response){resolve(response);}).catch(function(error){reject(error);console.error('Error:',error.response.data);});});}updateInventory(appid,inventory){return new Promise((resolve,reject)=>{this.axios.post('updateInventory',{login:global.data.username,session_key:this.xbot_session,inventory:inventory,appid:appid}).catch(function(error){reject(error);console.error('Error:',error.response.data);}).then(function(data){resolve(data);});});}userdata=null;getJobs(){return new Promise((resolve,reject)=>{this.axios.post('getJobs',{login:global.data.username,session_key:this.xbot_session}).then(function(response){resolve(response.data);}).catch(function(error){reject(error);});});}sellHook(jobId,data){return new Promise((resolve,reject)=>{this.axios.post('sellItemHook/'+jobId,{login:global.data.username,session_key:this.xbot_session,data:data}).then(function(response){console.log(response.data);resolve(response.data);}).catch(function(error){reject(error);});});}sendJobResult(job,status,result){try{console.log('['+status+'] sending job result '+job.id);this.axios.post('jobResult/'+job.id,{login:global.data.username,session_key:this.xbot_session,jobId:job.id,status:status,result:result}).then(function(response){console.log(response.data);}).catch(function(e){console.error(e);});}catch(ex){console.log('Произошла ошибка при отправке статуса задания '+job.id);}}customLog(code,message){try{this.axios.post('customLog',{login:global.data.username,session_key:this.xbot_session,code:code,message:message}).then(function(response){console.log(response.data);}).catch(function(e){console.error(e);});}catch(ex){console.log(ex);console.log('Произошла ошибка при отправке лога ');}}history(result){this.axios.post('updateLatestHistory',{login:global.data.username,session_key:this.xbot_session,result:result}).then(function(response){console.log(response.data);}).catch(function(e){console.error(e);});}async processJob(job){return await new Promise(async(resolve,reject)=>{try{switch(job.type){case 1:await global.xbsteam.getItemEconomics(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name,job.context.market_name_id).catch(function(ex){console.log(ex);}).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 2:const j=await new Promise(async(resolve2,reject2)=>{resolve2(await global.sc.getUserInventory(global.xbot.userdata.steamID,job.context.appid,job.context.contextid,false,function(e,inv,currency){if(e){reject2(e);return;}resolve2(inv);}));}).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 3:if(job.context.analyze===true){const data=await global.xbsteam.getItemOrderBookWM(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name,job.context.market_name_id);var hook=this.sellHook(job.id,data);if(hook.price!==undefined&&hook.price>0){job.context.price=hook.price;}}await global.xbsteam.sellItem(job.context.appid,job.context.contextid,job.context.assetid,job.context.amount,job.context.price).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 4:await global.xbsteam.cancelSellListing(job.context.listingId).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 5:await global.xbsteam.createBuyOrder(job.context.currency,job.context.appid,job.context.market_hash_name,job.context.price_total,job.context.quantity,job.context.billing_state,job.context.save_my_address).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 6:await global.xbsteam.cancelBuyOrder(job.context.orderId).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){global.xbot.sendJobResult(job,'false',e);});break;case 7:await global.xbsteam.getItemPriceHistory(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name).then(function(r){global.xbot.sendJobResult(job,'true',{priceHistory:r});}).catch(function(e){global.xbot.sendJobResult(job,'false',e);});break;case 8:await global.xbsteam.getItemOrderBookWM(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name,job.context.market_name_id).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){global.xbot.sendJobResult(job,'false',e);});break;case 9:await global.xbsteam.getItemMarketNameId(job.context.appid,job.context.market_hash_name).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 10:await global.xbsteam.getMarketHistory(job.context.offset,job.context.limit).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;default:console.log('unknown job type');new Error('Unknown job type');break;}}catch(ex){this.sendJobResult(job,false,null);console.log(ex);global.sc.wait();console.log('Произошла ошибка при обработке задания #'+job.id);}resolve();});}async processInventory(){return await new Promise(async(resolve,reject)=>{console.log(this.prefix+'Обновляю инвентарь');await global.sc.wait();const arr=await global.xbsteam.getInventoryContexts(global.sc.steamID);const data=arr[0];const wallet=arr[1];global.xbot.updateAccountData(global.xbot.userdata,data,wallet);const invcontexts=Object.keys(data);for(const invc of invcontexts){await new Promise(async(resolve2,reject2)=>{await global.sc.wait();global.sc.getUserInventory(global.xbot.userdata.steamID,invc,2,false,function(e,inv,currency){if(e){reject2(e);return;}global.xbot.updateInventory(invc,inv);resolve2(data);});}).catch(function(e){console.log(e);}).then(function(data){console.log(global.xbot.prefix+invc+' updated');});}resolve();});}loop(tickCounter){return new Promise(async(resolve,reject)=>{try{if(!this.xbot_loggedIn){console.log(this.prefix+'Попытка авторизации');await this.auth().catch(await function(e){return new Promise(async resolve2=>{console.log('Ошибка авторизации. Проверьте API ключ');await new Promise(resolve2=>setTimeout(resolve,global.data.tickDelay*2));resolve2();});});if(this.xbot_loggedIn){console.log(this.prefix+'Обновляю данные пользователя');await global.sc.wait();await global.sc.getSteamUser(sc.steamID,(err,user)=>{if(err){console.error('steam: Ошибка при получении информации о пользователе:');this.xbot_loggedIn=false;}else{user.steamID64=user.steamID.getSteamID64();global.xbot.userdata=user;}});}}if(this.xbot_loggedIn&&global.xbot.userdata!==null){if(tickCounter%global.data.ticks.checkConfirmations==0){console.log(this.prefix+'Проверяю аутентификатор');await global.xbsteam.confirmAllMarketTransactions().catch(function(e){console.log('Произошла ошибка при проверке аунтентификатора');});await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}let authkey=SteamTotp.getAuthCode(global.data.sharedSecret);if(tickCounter%global.data.ticks.ping==0||this.lastsentauthkey!==authkey){await this.ping(authkey);}if(tickCounter%global.data.ticks.sendInventory==0||tickCounter==2){await this.processInventory();}if(tickCounter%global.data.ticks.sendOrders==0||tickCounter==2){console.log(this.prefix+'Проверяю ордера');await global.sc.wait();await global.xbsteam.getOrders().then(function(data){global.xbot.updateOrdersAndListings(data);});await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}if(tickCounter%global.data.ticks.lastHistory==0||tickCounter==2){console.log(this.prefix+'Обновляю историю операций');var a=await global.xbsteam.getMarketHistory(0,100);this.history(a);await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}const jobsResponse=await this.getJobs();const jobs=jobsResponse.jobs;console.log(this.prefix+'Получено '+jobs.length+' заданий');for(const job of jobs){await this.processJob(job);}await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));resolve();}catch(ex){console.log(ex);reject(ex);await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*25));}});}};