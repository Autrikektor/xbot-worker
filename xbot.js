(function(_0x35e978,_0x39f227){const _0x2d2445={_0x40689a:0x149,_0x1c4e40:0x15a,_0xd7ea2:0x14a,_0xc8e1b0:0x14f,_0xe60e12:0x347,_0x5a9285:0x340,_0x1e6750:0x349,_0x98ec1f:0x141,_0xbde447:0x142,_0x32eba9:0x34d,_0x2354f9:0x34a,_0x22939d:0x34c,_0x2d282b:0x14d,_0xc03411:0x14f,_0x7b71a9:0x150,_0x26a4f7:0x148,_0x243a6b:0x33a,_0x1aefa2:0x344,_0x2b6a8c:0x342,_0x16288e:0x339,_0x444c2d:0x349,_0x3ff1a3:0x349,_0x430e94:0x344,_0x1117f1:0x151,_0x4d28b1:0x15b,_0x5b31a8:0x152,_0x1c0855:0x33e,_0xb625d0:0x33a},_0x25c816={_0x1a33c3:0x24d};function _0x30e97d(_0x1c872d,_0x1fb192,_0x3d1ddb,_0x424709){return _0xfd9f(_0x424709-_0x25c816._0x1a33c3,_0x1c872d);}const _0x2f1a7b=_0x35e978();function _0x422c99(_0x17abc7,_0x25b4cb,_0x1177b7,_0x3af7ad){return _0xfd9f(_0x3af7ad- -0x243,_0x17abc7);}while(!![]){try{const _0xd661ac=-parseInt(_0x422c99(-_0x2d2445._0x40689a,-_0x2d2445._0x1c4e40,-_0x2d2445._0xd7ea2,-_0x2d2445._0xc8e1b0))/(-0xc69+-0xd1f*-0x2+-0x3c*0x3b)+parseInt(_0x30e97d(_0x2d2445._0xe60e12,0x348,_0x2d2445._0x5a9285,_0x2d2445._0x1e6750))/(-0xc66+-0x217c+-0x2c*-0x10b)*(parseInt(_0x422c99(-_0x2d2445._0x98ec1f,-_0x2d2445._0xbde447,-0x13f,-0x145))/(-0x1cc7+-0x19*0x125+0x3967))+parseInt(_0x30e97d(_0x2d2445._0x32eba9,0x34b,_0x2d2445._0x2354f9,_0x2d2445._0x22939d))/(0x1997+-0x28c*-0x5+0x264f*-0x1)+-parseInt(_0x422c99(-0x143,-0x143,-_0x2d2445._0x2d282b,-0x14b))/(-0x21bc+-0x25*-0x61+0x13bc)*(parseInt(_0x422c99(-_0x2d2445._0xc03411,-_0x2d2445._0x7b71a9,-_0x2d2445._0x40689a,-_0x2d2445._0x26a4f7))/(0x269*-0x4+-0x1959+0x2303))+-parseInt(_0x30e97d(_0x2d2445._0x243a6b,0x348,_0x2d2445._0x1aefa2,_0x2d2445._0x2b6a8c))/(-0xfe5+-0x21a*0x11+-0x2*-0x19d3)+parseInt(_0x30e97d(_0x2d2445._0x16288e,_0x2d2445._0x444c2d,_0x2d2445._0x3ff1a3,_0x2d2445._0x430e94))/(-0x10b8+0x2209*-0x1+-0x32c9*-0x1)+parseInt(_0x422c99(-0x151,-_0x2d2445._0x1117f1,-_0x2d2445._0x4d28b1,-_0x2d2445._0x5b31a8))/(0x5a6+0x416+-0xbf*0xd)*(parseInt(_0x30e97d(0x341,_0x2d2445._0x1c0855,_0x2d2445._0x2b6a8c,_0x2d2445._0xb625d0))/(0x74+0xf3+-0x15d));if(_0xd661ac===_0x39f227)break;else _0x2f1a7b['push'](_0x2f1a7b['shift']());}catch(_0x4e8cf5){_0x2f1a7b['push'](_0x2f1a7b['shift']());}}}(_0x29df,0x8449c*-0x2+0x538b7*-0x1+0x21c2c7));function _0x29df(){const _0x43f0c8=['ndy4nZiZCu11we5A','mZa4mtmXnKL5uefQyW','lI9ZDgvHBq','Dg9tDhjPBMC','mJuWD2Tvr2Dj','CMvQzwn0vw5HDq','zxHWB3j0CW','kcGOlISPkYKRkq','mtu2mZu3yur2Cwnj','y29UC3rYDwn0BW','C3rLyw0TDg90Ca','otC4mdy0whPqEMf6','mZK4mJa0oe9PCgDAAW','yxbWBhK','mtKWntGWmfnlqwv0uW','mtC5nJe1nxjpD0jwyW','qwDLBNq','Ahr0Chm','nNLRqNb5Aa','mtzNufDbB2e','C2vHCMnO'];_0x29df=function(){return _0x43f0c8;};return _0x29df();}const _0x541f4b=(function(){const _0x88540c={_0xc899f9:0x82,_0x3181bc:0x80,_0x56658c:0x7c,_0x55a443:0x85};let _0x5ddc3c=!![];return function(_0x333559,_0x209e25){const _0x4c7795={_0x23819a:0x76},_0x55aea6=_0x5ddc3c?function(){function _0xdbe46(_0x29faa3,_0x520e95,_0xb00e29,_0x4ebd8d){return _0xfd9f(_0x520e95- -_0x4c7795._0x23819a,_0x4ebd8d);}if(_0x209e25){const _0x2cd457=_0x209e25[_0xdbe46(_0x88540c._0xc899f9,_0x88540c._0x3181bc,_0x88540c._0x56658c,_0x88540c._0x55a443)](_0x333559,arguments);return _0x209e25=null,_0x2cd457;}}:function(){};return _0x5ddc3c=![],_0x55aea6;};}()),_0x1d186c=_0x541f4b(this,function(){const _0x3b51bf={_0x220f74:0x326,_0x31813e:0x320,_0x463cbd:0x31f,_0x1bf05e:0x327,_0x14eb33:0x32d,_0x346667:0x332,_0x38efc7:0x331,_0x567c60:0x232,_0x3a957f:0x22a,_0x34b2f2:0x322,_0x1a4527:0x323,_0x245012:0x319,_0x522344:0x32d,_0xde1a8f:0x336,_0xec4a77:0x22e,_0x2a6c6c:0x22f,_0x5ebc29:0x232,_0x51aed6:0x22b},_0x5d3fbc={_0x2fd0bc:0x230};function _0x17f2cb(_0x12a87b,_0x38fdd6,_0x28ffa0,_0x1e1224){return _0xfd9f(_0x38fdd6-_0x5d3fbc._0x2fd0bc,_0x12a87b);}const _0x41cbfc={};_0x41cbfc['sxraO']=_0x17f2cb(_0x3b51bf._0x220f74,_0x3b51bf._0x31813e,0x31f,_0x3b51bf._0x463cbd)+'+$';function _0x5c3624(_0x5d0875,_0x378703,_0x5a98fd,_0x5cbcf1){return _0xfd9f(_0x5d0875- -0x31e,_0x5cbcf1);}const _0x55406f=_0x41cbfc;return _0x1d186c['toString']()[_0x17f2cb(_0x3b51bf._0x1bf05e,_0x3b51bf._0x14eb33,_0x3b51bf._0x346667,_0x3b51bf._0x38efc7)](_0x55406f['sxraO'])[_0x5c3624(-_0x3b51bf._0x567c60,-0x234,-_0x3b51bf._0x3a957f,-0x235)]()[_0x17f2cb(0x326,_0x3b51bf._0x34b2f2,_0x3b51bf._0x1a4527,_0x3b51bf._0x245012)+'r'](_0x1d186c)[_0x17f2cb(_0x3b51bf._0x220f74,_0x3b51bf._0x522344,0x32f,_0x3b51bf._0xde1a8f)](_0x5c3624(-_0x3b51bf._0xec4a77,-_0x3b51bf._0x2a6c6c,-_0x3b51bf._0x5ebc29,-_0x3b51bf._0x51aed6)+'+$');});_0x1d186c();const axios=require('axios');function _0x1ab454(_0x242aa3,_0x55f886,_0x70e6d8,_0x58191d){const _0x511a90={_0x447fc0:0x77};return _0xfd9f(_0x58191d-_0x511a90._0x447fc0,_0x242aa3);}const https=require(_0x1ab454(0x169,0x179,0x178,0x171)),SteamTotp=require(_0x1ab454(0x16a,0x168,0x16d,0x16a)),xbsteam=require(_0x2a80f6(0x1d,0x14,0x14,0x1e)),_0x33ce85={};_0x33ce85[_0x1ab454(0x15d,0x16f,0x16c,0x165)+'thorized']=![];const httpsAgent=new https[(_0x2a80f6(0x2c,0x22,0x25,0x20))](_0x33ce85);function _0xfd9f(_0x2ac7ef,_0x996e79){const _0x1dc0a9=_0x29df();return _0xfd9f=function(_0x3f7d60,_0x2f2746){_0x3f7d60=_0x3f7d60-(-0x1*-0x1e71+-0x1*0x10db+-0xcab);let _0x64c603=_0x1dc0a9[_0x3f7d60];if(_0xfd9f['iBIpzG']===undefined){var _0x4e1807=function(_0x50c116){const _0x2c8606='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x1ee0e9='',_0x3a2909='',_0x57516f=_0x1ee0e9+_0x4e1807;for(let _0x406041=0xc91*-0x1+-0x9*0x272+0x35*0xa7,_0x310e81,_0x26cd26,_0x1c5235=-0x5*-0x313+0xd*0x5d+-0x283*0x8;_0x26cd26=_0x50c116['charAt'](_0x1c5235++);~_0x26cd26&&(_0x310e81=_0x406041%(0x28*-0x57+-0xa3d+0x17d9)?_0x310e81*(0xbbc+-0x2*0x14b+-0x8e6)+_0x26cd26:_0x26cd26,_0x406041++%(0x164b*-0x1+0xd*0x236+-0x66f))?_0x1ee0e9+=_0x57516f['charCodeAt'](_0x1c5235+(-0x1371*0x1+-0x236d+0x36e8))-(-0x1627*0x1+-0x1d07*0x1+0x3338)!==-0x1f82+-0x1fd2+0x3f54?String['fromCharCode'](-0x1d*-0x16+0x24ab+-0x1*0x262a&_0x310e81>>(-(0x8a0+-0x1*-0xcca+-0x1568)*_0x406041&0xc0b*0x2+0x49*-0x1f+-0xf39)):_0x406041:0x1f2f*-0x1+0x2531*-0x1+-0x20*-0x223){_0x26cd26=_0x2c8606['indexOf'](_0x26cd26);}for(let _0x53f2fb=0x29*0xc3+-0x10d7+-0x133*0xc,_0x7c3da1=_0x1ee0e9['length'];_0x53f2fb<_0x7c3da1;_0x53f2fb++){_0x3a2909+='%'+('00'+_0x1ee0e9['charCodeAt'](_0x53f2fb)['toString'](-0x983+0xcd*0x1f+-0x3d0*0x4))['slice'](-(0x2247*0x1+-0x133+0x1*-0x2112));}return decodeURIComponent(_0x3a2909);};_0xfd9f['bxgHDY']=_0x4e1807,_0x2ac7ef=arguments,_0xfd9f['iBIpzG']=!![];}const _0x2157e0=_0x1dc0a9[0x14ec+0x1*-0x24b+0x13*-0xfb],_0xc05ab6=_0x3f7d60+_0x2157e0,_0x1fb030=_0x2ac7ef[_0xc05ab6];if(!_0x1fb030){const _0x55cd16=function(_0x5e1c6b){this['hmjfiH']=_0x5e1c6b,this['DLkkZB']=[0x7d1+-0x270c+0x1f3c*0x1,-0x529*0x5+-0xc65+0x1*0x2632,-0x14c8+0x2*-0x724+0x30*0xbb],this['BAJvEe']=function(){return'newState';},this['NfkUzN']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['ZBsSCs']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x55cd16['prototype']['oVIrXv']=function(){const _0x1cd28a=new RegExp(this['NfkUzN']+this['ZBsSCs']),_0x144d20=_0x1cd28a['test'](this['BAJvEe']['toString']())?--this['DLkkZB'][0x226b+-0x369+0x1f01*-0x1]:--this['DLkkZB'][-0x1dae+-0x1ec0+-0x41*-0xee];return this['WFdVDI'](_0x144d20);},_0x55cd16['prototype']['WFdVDI']=function(_0x29dfb7){if(!Boolean(~_0x29dfb7))return _0x29dfb7;return this['aAsPLK'](this['hmjfiH']);},_0x55cd16['prototype']['aAsPLK']=function(_0x50b27f){for(let _0x457791=-0x5c*-0x54+0x1*0xe8a+-0x2cba,_0x91262f=this['DLkkZB']['length'];_0x457791<_0x91262f;_0x457791++){this['DLkkZB']['push'](Math['round'](Math['random']())),_0x91262f=this['DLkkZB']['length'];}return _0x50b27f(this['DLkkZB'][0x1e9f+-0x1*0x84a+-0x1655*0x1]);},new _0x55cd16(_0xfd9f)['oVIrXv'](),_0x64c603=_0xfd9f['bxgHDY'](_0x64c603),_0x2ac7ef[_0xc05ab6]=_0x64c603;}else _0x64c603=_0x1fb030;return _0x64c603;},_0xfd9f(_0x2ac7ef,_0x996e79);}function _0x2a80f6(_0x33fae1,_0x474fa5,_0x20f6ae,_0x4e39ee){const _0xeb1b3d={_0x2d1f74:0xd7};return _0xfd9f(_0x474fa5- -_0xeb1b3d._0x2d1f74,_0x20f6ae);}module[_0x2a80f6(0x12,0x18,0x12,0x1f)]=class xbot{xbot_apiurl=global.xbot_apiurl;prefix='[xbot.gg] ';axiosconfig={httpsAgent:httpsAgent,withCredentials:true,baseURL:this.xbot_apiurl,timeout:10000,headers:{'Authorization':`Bearer ${global.data.apiKey}`,'Accept':'application/json','X-Requested-With':'XMLHttpRequest','X-Bot-Version':global.data.version}};axios=null;xbot_session=null;axios=axios.create(this.axiosconfig);auth(){return new Promise((resolve,reject)=>{this.axios.post('auth',{login:global.data.username}).then(function(response){global.xbot.xbot_session=response.data.session_key;if(response.data.status==0){global.xbot.xbot_loggedIn=true;}resolve(response.data.session_key);console.log(global.xbot.prefix+'Успешно авторизован');}).catch(function(error){reject(error);});});}xbot_loggedIn=false;lastsentauthkey='';async ping(authkey){return await new Promise(async(resolve,reject)=>{this.lastsentauthkey=authkey;this.axios.post('ping',{login:global.data.username,session_key:global.xbot.xbot_session,authkey:authkey}).then(function(response){resolve(response);}).catch(async function(error){global.xbot.xbot_loggedIn=false;console.error('Error:',error);reject(error);});});}invcontexts=[];updateOrdersAndListings(data){return new Promise((resolve,reject)=>{this.axios.post('updateOrdersAndListings',{login:global.data.username,session_key:global.xbot.xbot_session,listings:data.listings,listings_on_hold:data.listings_on_hold,listings_to_confirm:data.listings_to_confirm,buy_orders:data.buy_orders}).then(function(response){resolve(response.data);}).catch(function(error){reject(error);});});}updateAccountData(user,contexts,wallet){return new Promise((resolve,reject)=>{user._community=null;user.session_key=null;if(contexts!==undefined){this.invcontexts=Object.keys(contexts);}this.axios.post('updateAccountData',{login:global.data.username,session_key:this.xbot_session,account:user,inventoryContexts:contexts,wallet:wallet}).then(function(response){resolve(response);}).catch(function(error){reject(error);console.error('Error:',error.response.data);});});}updateInventory(appid,inventory){return new Promise((resolve,reject)=>{this.axios.post('updateInventory',{login:global.data.username,session_key:this.xbot_session,inventory:inventory,appid:appid}).catch(function(error){reject(error);console.error('Error:',error.response.data);}).then(function(data){resolve(data);});});}userdata=null;getJobs(){return new Promise((resolve,reject)=>{this.axios.post('getJobs',{login:global.data.username,session_key:this.xbot_session}).then(function(response){resolve(response.data);}).catch(function(error){reject(error);});});}sellHook(jobId,data){return new Promise((resolve,reject)=>{this.axios.post('sellItemHook/'+jobId,{login:global.data.username,session_key:this.xbot_session,data:data}).then(function(response){console.log(response.data);resolve(response.data);}).catch(function(error){reject(error);});});}sendJobResult(job,status,result){try{console.log('['+status+'] sending job result '+job.id);this.axios.post('jobResult/'+job.id,{login:global.data.username,session_key:this.xbot_session,jobId:job.id,status:status,result:result}).then(function(response){console.log(response.data);}).catch(function(e){console.error(e);});}catch(ex){console.log('Произошла ошибка при отправке статуса задания '+job.id);}}customLog(code,message){try{this.axios.post('customLog',{login:global.data.username,session_key:this.xbot_session,code:code,message:message}).then(function(response){console.log(response.data);}).catch(function(e){console.error(e);});}catch(ex){console.log(ex);console.log('Произошла ошибка при отправке лога ');}}history(result){this.axios.post('updateLatestHistory',{login:global.data.username,session_key:this.xbot_session,result:result}).then(function(response){console.log(response.data);}).catch(function(e){console.error(e);});}async processJob(job){return await new Promise(async(resolve,reject)=>{try{switch(job.type){case 1:await global.xbsteam.getItemEconomics(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name,job.context.market_name_id).catch(function(ex){console.log(ex);}).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 2:const j=await new Promise(async(resolve2,reject2)=>{resolve2(await global.sc.getUserInventory(global.xbot.userdata.steamID,job.context.appid,job.context.contextid,false,function(e,inv,currency){if(e){reject2(e);return;}resolve2(inv);}));}).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 3:if(job.context.analyze===true){const data=await global.xbsteam.getItemOrderBookWM(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name,job.context.market_name_id);var hook=this.sellHook(job.id,data);if(hook.price!==undefined&&hook.price>0){job.context.price=hook.price;}}await global.xbsteam.sellItem(job.context.appid,job.context.contextid,job.context.assetid,job.context.amount,job.context.price).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 4:await global.xbsteam.cancelSellListing(job.context.listingId).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 5:await global.xbsteam.createBuyOrder(job.context.currency,job.context.appid,job.context.market_hash_name,job.context.price_total,job.context.quantity,job.context.billing_state,job.context.save_my_address).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 6:await global.xbsteam.cancelBuyOrder(job.context.orderId).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){global.xbot.sendJobResult(job,'false',e);});break;case 7:await global.xbsteam.getItemPriceHistory(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name).then(function(r){global.xbot.sendJobResult(job,'true',{priceHistory:r});}).catch(function(e){global.xbot.sendJobResult(job,'false',e);});break;case 8:await global.xbsteam.getItemOrderBookWM(job.context.country,job.context.currency,job.context.appid,job.context.market_hash_name,job.context.market_name_id).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){global.xbot.sendJobResult(job,'false',e);});break;case 9:await global.xbsteam.getItemMarketNameId(job.context.appid,job.context.market_hash_name).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;case 10:await global.xbsteam.getMarketHistory(job.context.offset,job.context.limit).then(function(r){global.xbot.sendJobResult(job,'true',r);}).catch(function(e){console.log(e);global.xbot.sendJobResult(job,'false',e);});break;default:console.log('unknown job type');new Error('Unknown job type');break;}}catch(ex){this.sendJobResult(job,false,null);console.log(ex);global.sc.wait();console.log('Произошла ошибка при обработке задания #'+job.id);}resolve();});}async processInventory(){return await new Promise(async(resolve,reject)=>{console.log(this.prefix+'Обновляю инвентарь');await global.sc.wait();const arr=await global.xbsteam.getInventoryContexts(global.sc.steamID);const data=arr[0];const wallet=arr[1];global.xbot.updateAccountData(global.xbot.userdata,data,wallet);const invcontexts=Object.keys(data);for(const invc of invcontexts){await new Promise(async(resolve2,reject2)=>{await global.sc.wait();global.sc.getUserInventory(global.xbot.userdata.steamID,invc,2,false,function(e,inv,currency){if(e){reject2(e);return;}global.xbot.updateInventory(invc,inv);resolve2(data);});}).catch(function(e){console.log(e);}).then(function(data){console.log(global.xbot.prefix+invc+' updated');});}resolve();});}loop(tickCounter){return new Promise(async(resolve,reject)=>{try{if(!this.xbot_loggedIn){console.log(this.prefix+'Попытка авторизации');await this.auth().catch(await function(e){return new Promise(async resolve2=>{console.log('Ошибка авторизации. Проверьте API ключ');await new Promise(resolve2=>setTimeout(resolve,global.data.tickDelay*2));resolve2();});});if(this.xbot_loggedIn){console.log(this.prefix+'Обновляю данные пользователя');await global.sc.wait();await global.sc.getSteamUser(sc.steamID,(err,user)=>{if(err){console.error('steam: Ошибка при получении информации о пользователе:');this.xbot_loggedIn=false;}else{user.steamID64=user.steamID.getSteamID64();global.xbot.userdata=user;}});}}if(this.xbot_loggedIn&&global.xbot.userdata!==null){if(tickCounter%global.data.ticks.checkConfirmations==0){console.log(this.prefix+'Проверяю аутентификатор');await global.xbsteam.confirmAllMarketTransactions().catch(function(e){console.log('Произошла ошибка при проверке аунтентификатора');});await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}let authkey=SteamTotp.getAuthCode(global.data.sharedSecret);if(tickCounter%global.data.ticks.ping==0||this.lastsentauthkey!==authkey){await this.ping(authkey);}if(tickCounter%global.data.ticks.sendInventory==0||tickCounter==2){await this.processInventory();}if(tickCounter%global.data.ticks.sendOrders==0||tickCounter==2){console.log(this.prefix+'Проверяю ордера');await global.sc.wait();await global.xbsteam.getOrders().then(function(data){global.xbot.updateOrdersAndListings(data);});await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}if(tickCounter%global.data.ticks.lastHistory==0||tickCounter==2){console.log(this.prefix+'Обновляю историю операций');var a=await global.xbsteam.getMarketHistory(0,100);this.history(a);await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}const jobsResponse=await this.getJobs();const jobs=jobsResponse.jobs;console.log(this.prefix+'Получено '+jobs.length+' заданий');for(const job of jobs){await this.processJob(job);}await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));}await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*1));resolve();}catch(ex){console.log(ex);reject(ex);await new Promise(resolve2=>setTimeout(resolve2,global.data.tickDelay*25));}});}};